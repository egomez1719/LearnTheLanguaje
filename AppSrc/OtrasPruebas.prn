Compiling Program: C:\DataFlex Projects\LearnTheLanguage\AppSrc\OtrasPruebas.src
Memory Available: 2147483646
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 19.1\Pkg\dfallent.pkd)
67438>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJStandardCommandBarSystem.pkg)
67438>>>// these are all the packages used in a standard MDI menubar/toolbar system
67438>>>
67438>>>Use cCJCommandBarSystem.pkg
67438>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJStandardMenuItemClasses.pkg)
67438>>>>>Use Dfpanel.pkg
67438>>>>>Use cCJCommandBarSystem.pkg
67438>>>>>Use LanguageText.pkg
67438>>>>>
67438>>>>>
67438>>>>>Class cCJUndoMenuItem is a cCJMenuItem
67439>>>>>    
67439>>>>>    Procedure Construct_Object
67441>>>>>        Forward Send Construct_Object
67443>>>>>        Set psCaption   to C_$CaptionUndo
67444>>>>>        Set psToolTip to C_$ToolTipUndo
67445>>>>>        Set psDescription to C_$DescUndo
67446>>>>>        Set psImage to "ActionUndo.ico"
67447>>>>>        Set pbActiveUpdate to True
67448>>>>>        Set psCategory to C_$CategoryEdit
67449>>>>>        Set psShortcut to C_$Key_Ctrl_Z
67450>>>>>    End_Procedure
67451>>>>>    
67451>>>>>    Procedure OnExecute Variant vCommandBarControl
67453>>>>>        Send Undo of (focus(Self))
67454>>>>>    End_Procedure
67455>>>>>    
67455>>>>>    Function IsEnabled Returns Boolean
67457>>>>>        Boolean bEnabled
67457>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
67458>>>>>        Function_Return bEnabled
67459>>>>>    End_Function
67460>>>>>    
67460>>>>>End_Class
67461>>>>>
67461>>>>>
67461>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
67462>>>>>    
67462>>>>>    Procedure Construct_Object
67464>>>>>        Forward Send Construct_Object
67466>>>>>        Set psCaption   to C_$CaptionDelete
67467>>>>>        Set psToolTip to C_$ToolTipDelete
67468>>>>>        Set psDescription to C_$DescDelete
67469>>>>>        Set psImage to "actionDelete.ico"
67470>>>>>        Set psShortcut to C_$Key_Delete
67471>>>>>        Set pbActiveUpdate to True
67472>>>>>        Set psCategory to C_$CategoryEdit
67473>>>>>    End_Procedure
67474>>>>>    
67474>>>>>    
67474>>>>>    Procedure OnExecute Variant vCommandBarControl
67476>>>>>        Send Delete of (focus(Self))
67477>>>>>    End_Procedure
67478>>>>>    
67478>>>>>    Function IsEnabled Returns Boolean
67480>>>>>        Boolean bEnabled
67480>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
67481>>>>>        Function_Return bEnabled
67482>>>>>    End_Function
67483>>>>>    
67483>>>>>End_Class
67484>>>>>
67484>>>>>
67484>>>>>Class cCJCutMenuItem is a cCJMenuItem
67485>>>>>    
67485>>>>>    Procedure Construct_Object
67487>>>>>        Forward Send Construct_Object
67489>>>>>        Set psCaption   to C_$CaptionCut
67490>>>>>        Set psToolTip to C_$TooltipCut
67491>>>>>        Set psDescription to C_$DescCut
67492>>>>>        Set psImage to "actionCut.ico"
67493>>>>>        Set psShortcut to C_$Key_Ctrl_X
67494>>>>>        Set pbActiveUpdate to True
67495>>>>>        Set psCategory to C_$CategoryEdit
67496>>>>>    End_Procedure
67497>>>>>    
67497>>>>>    
67497>>>>>    Procedure OnExecute Variant vCommandBarControl
67499>>>>>        Send Cut of (focus(Self))
67500>>>>>    End_Procedure
67501>>>>>    
67501>>>>>    Function IsEnabled Returns Boolean
67503>>>>>        Boolean bEnabled
67503>>>>>        Get CanCut of (Focus(Self)) to bEnabled
67504>>>>>        Function_Return bEnabled
67505>>>>>    End_Function
67506>>>>>    
67506>>>>>End_Class
67507>>>>>
67507>>>>>
67507>>>>>Class cCJCopyMenuItem is a cCJMenuItem
67508>>>>>    
67508>>>>>    Procedure Construct_Object
67510>>>>>        Forward Send Construct_Object
67512>>>>>        Set psCaption   to C_$CaptionCopy
67513>>>>>        Set psToolTip to C_$ToolTipCopy
67514>>>>>        Set psDescription to C_$DescCopy
67515>>>>>        Set psImage to "actionCopy.ico"
67516>>>>>        Set psShortcut to C_$Key_Ctrl_C
67517>>>>>        Set pbActiveUpdate to True
67518>>>>>        Set psCategory to C_$CategoryEdit
67519>>>>>    End_Procedure
67520>>>>>    
67520>>>>>    
67520>>>>>    Procedure OnExecute Variant vCommandBarControl
67522>>>>>        Send Copy of (focus(Self))
67523>>>>>    End_Procedure
67524>>>>>    
67524>>>>>    Function IsEnabled Returns Boolean
67526>>>>>        Boolean bEnabled
67526>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
67527>>>>>        Function_Return bEnabled
67528>>>>>    End_Function
67529>>>>>    
67529>>>>>End_Class
67530>>>>>
67530>>>>>
67530>>>>>Class cCJPasteMenuItem is a cCJMenuItem
67531>>>>>    
67531>>>>>    Procedure Construct_Object
67533>>>>>        Forward Send Construct_Object
67535>>>>>        Set psCaption   to C_$CaptionPaste
67536>>>>>        Set psToolTip to C_$ToolTipPaste
67537>>>>>        Set psDescription to C_$DescPaste
67538>>>>>        Set psImage to "actionPaste.ico"
67539>>>>>        Set pbActiveUpdate to True
67540>>>>>        Set psShortcut to C_$Key_Ctrl_V
67541>>>>>        Set psCategory to C_$CategoryEdit
67542>>>>>    End_Procedure
67543>>>>>    
67543>>>>>    
67543>>>>>    Procedure OnExecute Variant vCommandBarControl
67545>>>>>        Send Paste of (focus(Self))
67546>>>>>    End_Procedure
67547>>>>>    
67547>>>>>    Function IsEnabled Returns Boolean
67549>>>>>        Boolean bEnabled
67549>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
67550>>>>>        Function_Return bEnabled
67551>>>>>    End_Function
67552>>>>>    
67552>>>>>End_Class
67553>>>>>
67553>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
67554>>>>>    
67554>>>>>    Procedure Construct_Object
67556>>>>>        Forward Send Construct_Object
67558>>>>>        Set psCaption   to C_$CaptionSelectAll
67559>>>>>        Set psToolTip to C_$ToolTipSelectAll
67560>>>>>        Set psDescription to C_$DescSelectAll
67561>>>>>        Set pbActiveUpdate to True
67562>>>>>        Set psShortcut to C_$Key_Ctrl_A
67563>>>>>        Set psCategory to C_$CategoryEdit
67564>>>>>    End_Procedure
67565>>>>>    
67565>>>>>    
67565>>>>>    Procedure OnExecute Variant vCommandBarControl
67567>>>>>        Send Select_All of (focus(Self))
67568>>>>>    End_Procedure
67569>>>>>    
67569>>>>>    Function IsEnabled Returns Boolean
67571>>>>>        Boolean bEnabled
67571>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
67572>>>>>        Function_Return bEnabled
67573>>>>>    End_Function
67574>>>>>    
67574>>>>>End_Class
67575>>>>>
67575>>>>>
67575>>>>>Class cCJExitMenuItem is a cCJMenuItem
67576>>>>>    
67576>>>>>    Procedure Construct_Object
67578>>>>>        Forward Send Construct_Object
67580>>>>>        Set psCaption to C_$CaptionExit
67581>>>>>        Set psToolTip to C_$ToolTipExit
67582>>>>>        Set psDescription to C_$ToolTipExit
67583>>>>>        Set psShortcut to C_$Key_Alt_F4
67584>>>>>        Set psCategory to C_$CategoryFile
67585>>>>>    End_Procedure
67586>>>>>    
67586>>>>>    Procedure OnExecute Variant vCommandBarControl
67588>>>>>        Send Exit_Application of Desktop
67589>>>>>    End_Procedure
67590>>>>>    
67590>>>>>End_Class
67591>>>>>
67591>>>>>Class cCJHelpMenuItem is a cCJMenuItem
67592>>>>>    
67592>>>>>    Procedure Construct_Object
67594>>>>>        Forward Send Construct_Object
67596>>>>>        Set psCaption to C_$CaptionHelp
67597>>>>>        Set psDescription to C_$ToolTipHelp
67598>>>>>        Set psToolTip to C_$DescHelp
67599>>>>>        Set psImage to "ActionHelp.ico"
67600>>>>>        Set psShortcut to "F1"
67601>>>>>        Set psCategory to C_$CategoryHelp
67602>>>>>    End_Procedure
67603>>>>>    
67603>>>>>    Procedure OnExecute Variant vCommandBarControl
67605>>>>>        Send Help of (Focus(Self))
67606>>>>>    End_Procedure
67607>>>>>    
67607>>>>>End_Class
67608>>>>>
67608>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
67609>>>>>    
67609>>>>>    Procedure Construct_Object
67611>>>>>        Forward Send Construct_Object
67613>>>>>        Set psCaption to C_$CaptionAddStatusbar
67614>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
67615>>>>>        Set psDescription to  C_$DescAddStatusbar
67616>>>>>        Set psCategory to C_$CategoryWindow
67617>>>>>    End_Procedure
67618>>>>>    
67618>>>>>    Procedure OnExecute Variant vCommandBarControl
67620>>>>>        Handle hoCommandBars hoClientArea
67620>>>>>        Get CommandBarSystemObject to hoCommandBars
67621>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67622>>>>>        If hoClientArea Begin
67624>>>>>            // the clientarea's parent panel has message
67624>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
67625>>>>>        End
67625>>>>>>
67625>>>>>    End_Procedure
67626>>>>>    
67626>>>>>    Function IsChecked Returns Boolean
67628>>>>>        Boolean bOn
67628>>>>>        Handle hoCommandBars hoClientArea
67628>>>>>        Get CommandBarSystemObject to hoCommandBars
67629>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67630>>>>>        If hoClientArea Begin
67632>>>>>            // the clientarea's parent panel has message
67632>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
67633>>>>>        End
67633>>>>>>
67633>>>>>        Function_Return bOn
67634>>>>>    End_Function
67635>>>>>End_Class
67636>>>>>
67636>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
67637>>>>>    
67637>>>>>    Procedure Construct_Object
67639>>>>>        Forward Send Construct_Object
67641>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
67642>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
67643>>>>>        Set psDescription to C_$DescAutoArrangeIcons
67644>>>>>        Set psCategory to C_$CategoryWindow
67645>>>>>    End_Procedure
67646>>>>>    
67646>>>>>    Procedure OnExecute Variant vCommandBarControl
67648>>>>>        Handle hoCommandBars hoClientArea
67648>>>>>        Get CommandBarSystemObject to hoCommandBars
67649>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67650>>>>>        If hoClientArea Begin
67652>>>>>            // the clientarea's parent panel has message
67652>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
67653>>>>>        End
67653>>>>>>
67653>>>>>    End_Procedure
67654>>>>>    
67654>>>>>    Function IsChecked Returns Boolean
67656>>>>>        Boolean bOn
67656>>>>>        Handle hoCommandBars hoClientArea
67656>>>>>        Get CommandBarSystemObject to hoCommandBars
67657>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67658>>>>>        If hoClientArea Begin
67660>>>>>            // the clientarea's parent panel has message
67660>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
67661>>>>>        End
67661>>>>>>
67661>>>>>        Function_Return bOn
67662>>>>>    End_Function
67663>>>>>End_Class
67664>>>>>
67664>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
67665>>>>>    
67665>>>>>    Procedure Construct_Object
67667>>>>>        Forward Send Construct_Object
67669>>>>>        Set psCaption to C_$CaptionRestoreMenus
67670>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
67671>>>>>        Set psDescription to C_$DescRestoreMenus
67672>>>>>        Set psCategory to C_$CategoryWindow
67673>>>>>    End_Procedure
67674>>>>>    
67674>>>>>    Procedure OnExecute Variant vCommandBarControl
67676>>>>>        Handle hoCommandBars
67676>>>>>        Get CommandBarSystemObject to hoCommandBars
67677>>>>>        Send RestoreLayout of hoCommandBars
67678>>>>>    End_Procedure
67679>>>>>    
67679>>>>>End_Class
67680>>>>>
67680>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
67681>>>>>    
67681>>>>>    Procedure Construct_Object
67683>>>>>        Forward Send Construct_Object
67685>>>>>        Set psCaption to C_$CaptionCascade
67686>>>>>        Set psToolTip to C_$ToolTipCascade
67687>>>>>        Set psDescription to  C_$DescCascade
67688>>>>>        Set psImage to "ActionCascade.ico"
67689>>>>>        Set psCategory to C_$CategoryWindow
67690>>>>>    End_Procedure
67691>>>>>    
67691>>>>>    Procedure OnExecute Variant vCommandBarControl
67693>>>>>        Handle hoCommandBars hoClientArea
67693>>>>>        Get CommandBarSystemObject to hoCommandBars
67694>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67695>>>>>        If hoClientArea Begin
67697>>>>>            Send Cascade_Windows of hoClientArea
67698>>>>>        End
67698>>>>>>
67698>>>>>    End_Procedure
67699>>>>>End_Class
67700>>>>>
67700>>>>>Class cCJTileHorizontally is a cCJMenuItem
67701>>>>>    
67701>>>>>    Procedure Construct_Object
67703>>>>>        Forward Send Construct_Object
67705>>>>>        Set psCaption to C_$CaptionTileHorizontally
67706>>>>>        Set psToolTip to C_$ToolTipTileHorizontally
67707>>>>>        Set psDescription to  C_$DescTileHorizontally
67708>>>>>        Set psImage to "ActionTileHorizontally.ico"
67709>>>>>        Set psCategory to C_$CategoryWindow
67710>>>>>    End_Procedure
67711>>>>>    
67711>>>>>    Procedure OnExecute Variant vCommandBarControl
67713>>>>>        Handle hoCommandBars hoClientArea
67713>>>>>        Get CommandBarSystemObject to hoCommandBars
67714>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67715>>>>>        If hoClientArea Begin
67717>>>>>            Send Tile_Windows_Horizontal of hoClientArea
67718>>>>>        End
67718>>>>>>
67718>>>>>    End_Procedure
67719>>>>>End_Class
67720>>>>>
67720>>>>>Class cCJTileVertically is a cCJMenuItem
67721>>>>>    
67721>>>>>    Procedure Construct_Object
67723>>>>>        Forward Send Construct_Object
67725>>>>>        Set psCaption to C_$CaptionTileVertically
67726>>>>>        Set psToolTip to C_$ToolTipTileVertically
67727>>>>>        Set psDescription to  C_$DescTileVertically
67728>>>>>        Set psImage to "ActionTileVertically.ico"
67729>>>>>        Set psCategory to C_$CategoryWindow
67730>>>>>    End_Procedure
67731>>>>>    
67731>>>>>    Procedure OnExecute Variant vCommandBarControl
67733>>>>>        Handle hoCommandBars hoClientArea
67733>>>>>        Get CommandBarSystemObject to hoCommandBars
67734>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67735>>>>>        If hoClientArea Begin
67737>>>>>            Send Tile_Windows_Vertical of hoClientArea
67738>>>>>        End
67738>>>>>>
67738>>>>>    End_Procedure
67739>>>>>End_Class
67740>>>>>
67740>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
67741>>>>>    
67741>>>>>    Procedure Construct_Object
67743>>>>>        Forward Send Construct_Object
67745>>>>>        Set psCaption to C_$CaptionMinimizeWindows
67746>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
67747>>>>>        Set psDescription to  C_$DescMinimizeWindows
67748>>>>>        Set psCategory to C_$CategoryWindow
67749>>>>>    End_Procedure
67750>>>>>    
67750>>>>>    Procedure OnExecute Variant vCommandBarControl
67752>>>>>        Handle hoCommandBars hoClientArea
67752>>>>>        Get CommandBarSystemObject to hoCommandBars
67753>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67754>>>>>        If hoClientArea Begin
67756>>>>>            // the clientarea's parent panel has message
67756>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
67757>>>>>        End
67757>>>>>>
67757>>>>>    End_Procedure
67758>>>>>End_Class
67759>>>>>
67759>>>>>
67759>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
67760>>>>>    
67760>>>>>    Procedure Construct_Object
67762>>>>>        Forward Send Construct_Object
67764>>>>>        Set psCaption to C_$CaptionRestoreWindows
67765>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
67766>>>>>        Set psDescription to  C_$DescRestoreWindows
67767>>>>>        Set psCategory to C_$CategoryWindow
67768>>>>>    End_Procedure
67769>>>>>    
67769>>>>>    Procedure OnExecute Variant vCommandBarControl
67771>>>>>        Handle hoCommandBars hoClientArea
67771>>>>>        Get CommandBarSystemObject to hoCommandBars
67772>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67773>>>>>        If hoClientArea Begin
67775>>>>>            // the clientarea's parent panel has message
67775>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
67776>>>>>        End
67776>>>>>>
67776>>>>>    End_Procedure
67777>>>>>End_Class
67778>>>>>
67778>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
67779>>>>>    
67779>>>>>    Procedure Construct_Object
67781>>>>>        Forward Send Construct_Object
67783>>>>>        Set psCaption to C_$CaptionArrangeIcons
67784>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
67785>>>>>        Set psDescription to  C_$DescArrangeIcons
67786>>>>>        Set psCategory to C_$CategoryWindow
67787>>>>>    End_Procedure
67788>>>>>    
67788>>>>>    Procedure OnExecute Variant vCommandBarControl
67790>>>>>        Handle hoCommandBars hoClientArea
67790>>>>>        Get CommandBarSystemObject to hoCommandBars
67791>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67792>>>>>        If hoClientArea Begin
67794>>>>>            Send Arrange_Icons of hoClientArea
67795>>>>>        End
67795>>>>>>
67795>>>>>    End_Procedure
67796>>>>>    
67796>>>>>End_Class
67797>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJAboutMenuItem.pkg)
67797>>>>>Use cCJCommandBarSystem.pkg
67797>>>>>Use LanguageText.pkg
67797>>>>>
67797>>>>>// It is expected that if you use this class that you provide an about object that is
67797>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
67797>>>>>// because you may wish to create your own custom about package.
67797>>>>>
67797>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
67798>>>>>
67798>>>>>    Procedure Construct_Object
67800>>>>>        Forward Send Construct_Object
67802>>>>>        Set psCaption to C_$CaptionAbout
67803>>>>>        Set psDescription to C_$ToolTipAbout
67804>>>>>        Set psToolTip to C_$DescAbout
67805>>>>>        Set psImage to "ActionAbout.ico"
67806>>>>>        Set psCategory to C_$CategoryHelp
67807>>>>>    End_Procedure
67808>>>>>    
67808>>>>>    Procedure OnExecute Variant vCommandBarControl
67810>>>>>        Handle hoCommandBars hoClientArea
67810>>>>>        Get CommandBarSystemObject to hoCommandBars
67811>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
67812>>>>>        If hoClientArea Begin
67814>>>>>            Send Activate_About of hoClientArea
67815>>>>>        End
67815>>>>>>
67815>>>>>    End_Procedure
67816>>>>>
67816>>>>>End_Class
67817>>>>>
67817>>>>>
67817>>>Use cCJDeoMenuItemClasses.pkg
67817>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCJMDIWindowsMenuItem.pkg)
67817>>>>>Use cCJCommandBarSystem.pkg
67817>>>>>
67817>>>>>Register_Function Client_ID Returns Integer
67817>>>>>
67817>>>>>// only used by cCJMDIWIndowsMenuItem
67817>>>>>Class cCJMDIWindowItem is a cCJMenuItem
67818>>>>>    
67818>>>>>    Procedure Construct_Object
67820>>>>>        Forward Send Construct_Object
67822>>>>>        Property Handle phWindow 0 // object id of view
67823>>>>>        Set pbControlFlagNoMovable to True
67824>>>>>        Set pbActiveUpdate to True
67825>>>>>    End_Procedure
67826>>>>>    
67826>>>>>    Procedure OnExecute Variant vCommandBarControl
67828>>>>>        Handle hWindow
67828>>>>>        Get phWindow to hWindow
67829>>>>>        Send Activate_View of hWindow
67830>>>>>    End_Procedure
67831>>>>>    
67831>>>>>End_Class
67832>>>>>
67832>>>>>
67832>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
67833>>>>>    
67833>>>>>    Procedure Construct_Object
67835>>>>>        Forward Send Construct_Object
67837>>>>>        Property Handle[] phArrayOfWindows
67838>>>>>        Set peControlType to xtpControlPopup
67839>>>>>        Set psCategory to C_$CategoryWindow
67840>>>>>    End_Procedure
67841>>>>>    
67841>>>>>    // This adds MDI windows to the existing menu items.
67841>>>>>    // This removes any existing windows menus and always adds a new set to the end
67841>>>>>    
67841>>>>>    Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
67843>>>>>        Handle  hClientArea hView
67843>>>>>        String  sLabel
67843>>>>>        Integer i iWindows
67843>>>>>        Handle[] hArrayOfWindows
67844>>>>>        Variant vItem
67844>>>>>        
67844>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
67844>>>>>        // also assume that destroying an action removes all menu instances of that action
67844>>>>>        Get phArrayOfWindows to hArrayOfWindows
67845>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
67846>>>>>        For i from 0 to (iWindows-1)
67852>>>>>>
67852>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
67853>>>>>        Loop
67854>>>>>>
67854>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
67855>>>>>        
67855>>>>>        // Add all views to this menu. Create the action and add the item
67855>>>>>        Move 0 to i
67856>>>>>        Get Client_Id to hClientArea // object id of client area
67857>>>>>        If (hClientArea > 0) Begin
67859>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
67860>>>>>            While (hView <> 0)
67864>>>>>                If (Active_State(hView)) Begin
67866>>>>>                    // create the action
67866>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
67867>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
67868>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
67869>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
67870>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
67872>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
67873>>>>>                    End
67873>>>>>>
67873>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
67874>>>>>                    If (i=0) Begin
67876>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
67877>>>>>                    End
67877>>>>>>
67877>>>>>                    // Create a menu item for this action
67877>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
67878>>>>>                    Increment i
67879>>>>>                End
67879>>>>>>
67879>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
67880>>>>>            Loop
67881>>>>>>
67881>>>>>        End
67881>>>>>>
67881>>>>>        
67881>>>>>        Set phArrayOfWindows to hArrayOfWindows
67882>>>>>        
67882>>>>>    End_Procedure
67883>>>>>    
67883>>>>>End_Class
67884>
67884>Object oHtmlHelp is a cHtmlHelp
67886>End_Object
67887>
67887>Object oApplication is a cApplication
67889>    Set peHelpType to htHtmlHelp
67890>
67890>    Object oConnection is a cConnection
67892>        Use LoginEncryption.pkg
Including file: LoginEncryption.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\LoginEncryption.pkg)
67892>>>Use cLoginEncryption.pkg
Including file: cLoginEncryption.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cLoginEncryption.pkg)
67892>>>>>Use cCryptographer.pkg
Including file: cCryptographer.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cCryptographer.pkg)
67892>>>>>>>Use VdfBase.pkg
67892>>>>>>>
67892>>>>>>>Use CryptographerConstants.pkg
Including file: CryptographerConstants.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\CryptographerConstants.pkg)
67892>>>>>>>>>//   Author  : Ulbe Stellema
67892>>>>>>>>>// Algorithm classes
67892>>>>>>>>>Define ALG_CLASS_ANY                    for |CI$00000000 // (0)
67892>>>>>>>>>Define ALG_CLASS_SIGNATURE              for |CI$00002000 // (1 << 13)
67892>>>>>>>>>Define ALG_CLASS_MSG_ENCRYPT            for |CI$00004000 // (2 << 13)
67892>>>>>>>>>Define ALG_CLASS_DATA_ENCRYPT           for |CI$00006000 // (3 << 13)
67892>>>>>>>>>Define ALG_CLASS_HASH                   for |CI$00008000 // (4 << 13)
67892>>>>>>>>>Define ALG_CLASS_KEY_EXCHANGE           for |CI$0000A000 // (5 << 13)
67892>>>>>>>>>Define ALG_CLASS_ALL                    for |CI$0000E000 // (7 << 13)
67892>>>>>>>>>
67892>>>>>>>>>// Algorithm types
67892>>>>>>>>>Define ALG_TYPE_ANY                     for |CI$00000000 // (0)
67892>>>>>>>>>Define ALG_TYPE_DSS                     for |CI$00000200 // (1 << 9)
67892>>>>>>>>>Define ALG_TYPE_RSA                     for |CI$00000400 // (2 << 9)
67892>>>>>>>>>Define ALG_TYPE_BLOCK                   for |CI$00000600 // (3 << 9)
67892>>>>>>>>>Define ALG_TYPE_STREAM                  for |CI$00000800 // (4 << 9)
67892>>>>>>>>>Define ALG_TYPE_DH                      for |CI$00000A00 // (5 << 9)
67892>>>>>>>>>Define ALG_TYPE_SECURECHANNEL           for |CI$00000C00 // (6 << 9)
67892>>>>>>>>>
67892>>>>>>>>>// Generic sub-ids
67892>>>>>>>>>Define ALG_SID_ANY                      for |CI$00000000 // (0)
67892>>>>>>>>>
67892>>>>>>>>>// RSA sub-ids
67892>>>>>>>>>Define ALG_SID_RSA_ANY                  for 0
67892>>>>>>>>>Define ALG_SID_RSA_PKCS                 for 1
67892>>>>>>>>>Define ALG_SID_RSA_MSATWORK             for 2
67892>>>>>>>>>Define ALG_SID_RSA_ENTRUST              for 3
67892>>>>>>>>>Define ALG_SID_RSA_PGP                  for 4
67892>>>>>>>>>
67892>>>>>>>>>// DSS sub-ids
67892>>>>>>>>>Define ALG_SID_DSS_ANY                  for 0
67892>>>>>>>>>Define ALG_SID_DSS_PKCS                 for 1
67892>>>>>>>>>Define ALG_SID_DSS_DMS                  for 2
67892>>>>>>>>>
67892>>>>>>>>>// DES sub_ids
67892>>>>>>>>>Define ALG_SID_DES                      for 1
67892>>>>>>>>>Define ALG_SID_3DES                     for 3
67892>>>>>>>>>Define ALG_SID_DESX                     for 4
67892>>>>>>>>>Define ALG_SID_IDEA                     for 5
67892>>>>>>>>>Define ALG_SID_CAST                     for 6
67892>>>>>>>>>Define ALG_SID_SAFERSK64                for 7
67892>>>>>>>>>Define ALG_SID_SAFERSK128               for 8
67892>>>>>>>>>Define ALG_SID_3DES_112                 for 9
67892>>>>>>>>>Define ALG_SID_CYLINK_MEK               for 12
67892>>>>>>>>>Define ALG_SID_RC5                      for 13
67892>>>>>>>>>Define ALG_SID_AES_128                  for 14
67892>>>>>>>>>Define ALG_SID_AES_192                  for 15
67892>>>>>>>>>Define ALG_SID_AES_256                  for 16
67892>>>>>>>>>Define ALG_SID_AES                      for 17
67892>>>>>>>>>
67892>>>>>>>>>// Fortezza sub-ids
67892>>>>>>>>>Define ALG_SID_SKIPJACK                 for 10
67892>>>>>>>>>Define ALG_SID_TEK                      for 11
67892>>>>>>>>>
67892>>>>>>>>>// RC2 sub-ids
67892>>>>>>>>>Define ALG_SID_RC2                      for 2
67892>>>>>>>>>
67892>>>>>>>>>// Stream cipher sub-ids
67892>>>>>>>>>Define ALG_SID_RC4                      for 1
67892>>>>>>>>>Define ALG_SID_SEAL                     for 2
67892>>>>>>>>>
67892>>>>>>>>>// Diffie-Hellman sub-ids
67892>>>>>>>>>Define ALG_SID_DH_SANDF                 for 1
67892>>>>>>>>>Define ALG_SID_DH_EPHEM                 for 2
67892>>>>>>>>>Define ALG_SID_AGREED_KEY_ANY           for 3
67892>>>>>>>>>Define ALG_SID_KEA                      for 4
67892>>>>>>>>>
67892>>>>>>>>>// Hash sub ids
67892>>>>>>>>>Define ALG_SID_MD2                      for 1
67892>>>>>>>>>Define ALG_SID_MD4                      for 2
67892>>>>>>>>>Define ALG_SID_MD5                      for 3
67892>>>>>>>>>Define ALG_SID_SHA                      for 4
67892>>>>>>>>>Define ALG_SID_SHA1                     for 4
67892>>>>>>>>>Define ALG_SID_MAC                      for 5
67892>>>>>>>>>Define ALG_SID_RIPEMD                   for 6
67892>>>>>>>>>Define ALG_SID_RIPEMD160                for 7
67892>>>>>>>>>Define ALG_SID_SSL3SHAMD5               for 8
67892>>>>>>>>>Define ALG_SID_HMAC                     for 9
67892>>>>>>>>>Define ALG_SID_TLS1PRF                  for 10
67892>>>>>>>>>Define ALG_SID_HASH_REPLACE_OWF         for 11
67892>>>>>>>>>Define ALG_SID_SHA_256                  for 12
67892>>>>>>>>>Define ALG_SID_SHA_384                  for 13
67892>>>>>>>>>Define ALG_SID_SHA_512                  for 14
67892>>>>>>>>>
67892>>>>>>>>>// secure channel sub ids
67892>>>>>>>>>Define ALG_SID_SSL3_MASTER              for 1
67892>>>>>>>>>Define ALG_SID_SCHANNEL_MASTER_HASH     for 2
67892>>>>>>>>>Define ALG_SID_SCHANNEL_MAC_KEY         for 3
67892>>>>>>>>>Define ALG_SID_PCT1_MASTER              for 4
67892>>>>>>>>>Define ALG_SID_SSL2_MASTER              for 5
67892>>>>>>>>>Define ALG_SID_TLS1_MASTER              for 6
67892>>>>>>>>>Define ALG_SID_SCHANNEL_ENC_KEY         for 7
67892>>>>>>>>>
67892>>>>>>>>>// algorithm identifier definitions
67892>>>>>>>>>Define CALG_MD2                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD2)
67892>>>>>>>>>Define CALG_MD4                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD4)
67892>>>>>>>>>Define CALG_MD5                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MD5)
67892>>>>>>>>>Define CALG_SHA                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA)
67892>>>>>>>>>Define CALG_SHA1                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA1)
67892>>>>>>>>>Define CALG_MAC                         for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_MAC)
67892>>>>>>>>>Define CALG_RSA_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
67892>>>>>>>>>Define CALG_DSS_SIGN                    for (ALG_CLASS_SIGNATURE ior ALG_TYPE_DSS ior ALG_SID_DSS_ANY)
67892>>>>>>>>>Define CALG_NO_SIGN                     for (ALG_CLASS_SIGNATURE ior ALG_TYPE_ANY ior ALG_SID_ANY)
67892>>>>>>>>>Define CALG_RSA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_RSA ior ALG_SID_RSA_ANY)
67892>>>>>>>>>Define CALG_DES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DES)
67892>>>>>>>>>Define CALG_3DES_112                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES_112)
67892>>>>>>>>>Define CALG_3DES                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_3DES)
67892>>>>>>>>>Define CALG_DESX                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_DESX)
67892>>>>>>>>>Define CALG_RC2                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC2)
67892>>>>>>>>>Define CALG_RC4                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_RC4)
67892>>>>>>>>>Define CALG_SEAL                        for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_STREAM ior ALG_SID_SEAL)
67892>>>>>>>>>Define CALG_DH_SF                       for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_SANDF)
67892>>>>>>>>>Define CALG_DH_EPHEM                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_DH_EPHEM)
67892>>>>>>>>>Define CALG_AGREEDKEY_ANY               for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_AGREED_KEY_ANY)
67892>>>>>>>>>Define CALG_KEA_KEYX                    for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_DH ior ALG_SID_KEA)
67892>>>>>>>>>Define CALG_HUGHES_MD5                  for (ALG_CLASS_KEY_EXCHANGE ior ALG_TYPE_ANY ior ALG_SID_MD5)
67892>>>>>>>>>Define CALG_SKIPJACK                    for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_SKIPJACK)
67892>>>>>>>>>Define CALG_TEK                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_TEK)
67892>>>>>>>>>Define CALG_CYLINK_MEK                  for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_CYLINK_MEK)
67892>>>>>>>>>Define CALG_SSL3_SHAMD5                 for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SSL3SHAMD5)
67892>>>>>>>>>Define CALG_SSL3_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL3_MASTER)
67892>>>>>>>>>Define CALG_SCHANNEL_MASTER_HASH        for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MASTER_HASH)
67892>>>>>>>>>Define CALG_SCHANNEL_MAC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_MAC_KEY)
67892>>>>>>>>>Define CALG_SCHANNEL_ENC_KEY            for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SCHANNEL_ENC_KEY)
67892>>>>>>>>>Define CALG_PCT1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_PCT1_MASTER)
67892>>>>>>>>>Define CALG_SSL2_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_SSL2_MASTER)
67892>>>>>>>>>Define CALG_TLS1_MASTER                 for (ALG_CLASS_MSG_ENCRYPT ior ALG_TYPE_SECURECHANNEL ior ALG_SID_TLS1_MASTER)
67892>>>>>>>>>Define CALG_RC5                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_RC5)
67892>>>>>>>>>Define CALG_HMAC                        for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HMAC)
67892>>>>>>>>>Define CALG_TLS1PRF                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_TLS1PRF)
67892>>>>>>>>>Define CALG_HASH_REPLACE_OWF            for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_HASH_REPLACE_OWF)
67892>>>>>>>>>Define CALG_AES_128                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_128)
67892>>>>>>>>>Define CALG_AES_192                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_192)
67892>>>>>>>>>Define CALG_AES_256                     for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES_256)
67892>>>>>>>>>Define CALG_AES                         for (ALG_CLASS_DATA_ENCRYPT ior ALG_TYPE_BLOCK ior ALG_SID_AES)
67892>>>>>>>>>Define CALG_SHA_256                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_256)
67892>>>>>>>>>Define CALG_SHA_384                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_384)
67892>>>>>>>>>Define CALG_SHA_512                     for (ALG_CLASS_HASH ior ALG_TYPE_ANY ior ALG_SID_SHA_512)
67892>>>>>>>>>
67892>>>>>>>>>// Providers
67892>>>>>>>>>Define MS_DEF_PROV                      for "Microsoft Base Cryptographic Provider v1.0"
67892>>>>>>>>>Define MS_ENHANCED_PROV                 for "Microsoft Enhanced Cryptographic Provider v1.0"
67892>>>>>>>>>Define MS_STRONG_PROV                   for "Microsoft Strong Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_RSA_SIG_PROV              for "Microsoft RSA Signature Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_RSA_SCHANNEL_PROV         for "Microsoft RSA SChannel Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_DSS_PROV                  for "Microsoft Base DSS Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_DSS_DH_PROV               for "Microsoft Base DSS and Diffie-Hellman Cryptographic Provider"
67892>>>>>>>>>Define MS_ENH_DSS_DH_PROV               for "Microsoft Enhanced DSS and Diffie-Hellman Cryptographic Provider"
67892>>>>>>>>>Define MS_DEF_DH_SCHANNEL_PROV          for "Microsoft DH SChannel Cryptographic Provider"
67892>>>>>>>>>Define MS_SCARD_PROV                    for "Microsoft Base Smart Card Crypto Provider"
67892>>>>>>>>>Define MS_ENH_RSA_AES_PROV              for "Microsoft Enhanced RSA and AES Cryptographic Provider"
67892>>>>>>>>>
67892>>>>>>>>>// dwFlags definitions for CryptAcquireContext
67892>>>>>>>>>Define CRYPT_VERIFYCONTEXT              for |CI$F0000000
67892>>>>>>>>>Define CRYPT_NEWKEYSET                  for |CI$00000008
67892>>>>>>>>>Define CRYPT_DELETEKEYSET               for |CI$00000010
67892>>>>>>>>>Define CRYPT_MACHINE_KEYSET             for |CI$00000020
67892>>>>>>>>>Define CRYPT_SILENT                     for |CI$00000040
67892>>>>>>>>>
67892>>>>>>>>>// dwFlag definitions for CryptGenKey
67892>>>>>>>>>Define CRYPT_EXPORTABLE                 for |CI$00000001
67892>>>>>>>>>Define CRYPT_USER_PROTECTED             for |CI$00000002
67892>>>>>>>>>Define CRYPT_CREATE_SALT                for |CI$00000004
67892>>>>>>>>>Define CRYPT_UPDATE_KEY                 for |CI$00000008
67892>>>>>>>>>Define CRYPT_NO_SALT                    for |CI$00000010
67892>>>>>>>>>Define CRYPT_PREGEN                     for |CI$00000040
67892>>>>>>>>>Define CRYPT_RECIPIENT                  for |CI$00000010
67892>>>>>>>>>Define CRYPT_INITIATOR                  for |CI$00000040
67892>>>>>>>>>Define CRYPT_ONLINE                     for |CI$00000080
67892>>>>>>>>>Define CRYPT_SF                         for |CI$00000100
67892>>>>>>>>>Define CRYPT_CREATE_IV                  for |CI$00000200
67892>>>>>>>>>Define CRYPT_KEK                        for |CI$00000400
67892>>>>>>>>>Define CRYPT_DATA_KEY                   for |CI$00000800
67892>>>>>>>>>Define CRYPT_VOLATILE                   for |CI$00001000
67892>>>>>>>>>Define CRYPT_SGCKEY                     for |CI$00002000
67892>>>>>>>>>Define CRYPT_ARCHIVABLE                 for |CI$00004000
67892>>>>>>>>>
67892>>>>>>>>>// Provider types
67892>>>>>>>>>Define PROV_RSA_FULL                    for 1
67892>>>>>>>>>Define PROV_RSA_SIG                     for 2
67892>>>>>>>>>Define PROV_DSS                         for 3
67892>>>>>>>>>Define PROV_FORTEZZA                    for 4
67892>>>>>>>>>Define PROV_MS_EXCHANGE                 for 5
67892>>>>>>>>>Define PROV_SSL                         for 6
67892>>>>>>>>>Define PROV_RSA_SCHANNEL                for 12
67892>>>>>>>>>Define PROV_DSS_DH                      for 13
67892>>>>>>>>>Define PROV_EC_ECDSA_SIG                for 14
67892>>>>>>>>>Define PROV_EC_ECNRA_SIG                for 15
67892>>>>>>>>>Define PROV_EC_ECDSA_FULL               for 16
67892>>>>>>>>>Define PROV_EC_ECNRA_FULL               for 17
67892>>>>>>>>>Define PROV_DH_SCHANNEL                 for 18
67892>>>>>>>>>Define PROV_SPYRUS_LYNKS                for 20
67892>>>>>>>>>Define PROV_RNG                         for 21
67892>>>>>>>>>Define PROV_INTEL_SEC                   for 22
67892>>>>>>>>>Define PROV_REPLACE_OWF                 for 23
67892>>>>>>>>>Define PROV_RSA_AES                     for 24
67892>>>>>>>>>
67892>>>>>>>>>// KP_MODE
67892>>>>>>>>>// KP_MODE
67892>>>>>>>>>Define CRYPT_MODE_CBC                   for 1       // Cipher block chaining
67892>>>>>>>>>Define CRYPT_MODE_ECB                   for 2       // Electronic code book
67892>>>>>>>>>Define CRYPT_MODE_OFB                   for 3       // Output feedback mode
67892>>>>>>>>>Define CRYPT_MODE_CFB                   for 4       // Cipher feedback mode
67892>>>>>>>>>Define CRYPT_MODE_CTS                   for 5       // Ciphertext stealing mode
67892>>>>>>>>>Define CRYPT_MODE_CBCI                  for 6       // ANSI CBC Interleaved
67892>>>>>>>>>Define CRYPT_MODE_CFBP                  for 7       // ANSI CFB Pipelined
67892>>>>>>>>>Define CRYPT_MODE_OFBP                  for 8       // ANSI OFB Pipelined
67892>>>>>>>>>Define CRYPT_MODE_CBCOFM                for 9       // ANSI CBC + OF Masking
67892>>>>>>>>>Define CRYPT_MODE_CBCOFMI               for 10      // ANSI CBC + OFM Interleaved
67892>>>>>>>>>
67892>>>>>>>>>// dwParam definitions for CryptGetKeyParam
67892>>>>>>>>>Define KP_IV                            for 1       // Initialization vector
67892>>>>>>>>>Define KP_SALT                          for 2       // Salt value
67892>>>>>>>>>Define KP_PADDING                       for 3       // Padding values
67892>>>>>>>>>Define KP_MODE                          for 4       // Mode of the cipher
67892>>>>>>>>>Define KP_MODE_BITS                     for 5       // Number of bits to feedback
67892>>>>>>>>>Define KP_PERMISSIONS                   for 6       // Key permissions DWORD
67892>>>>>>>>>Define KP_ALGID                         for 7       // Key algorithm
67892>>>>>>>>>Define KP_BLOCKLEN                      for 8       // Block size of the cipher
67892>>>>>>>>>Define KP_KEYLEN                        for 9       // Length of key in bits
67892>>>>>>>>>Define KP_SALT_EX                       for 10      // Length of salt in bytes
67892>>>>>>>>>Define KP_P                             for 11      // DSS/Diffie-Hellman P value
67892>>>>>>>>>Define KP_G                             for 12      // DSS/Diffie-Hellman G value
67892>>>>>>>>>Define KP_Q                             for 13      // DSS Q value
67892>>>>>>>>>Define KP_X                             for 14      // Diffie-Hellman X value
67892>>>>>>>>>Define KP_Y                             for 15      // Y value
67892>>>>>>>>>Define KP_RA                            for 16      // Fortezza RA value
67892>>>>>>>>>Define KP_RB                            for 17      // Fortezza RB value
67892>>>>>>>>>Define KP_INFO                          for 18      // for putting information into an RSA envelope
67892>>>>>>>>>Define KP_EFFECTIVE_KEYLEN              for 19      // setting and getting RC2 effective key length
67892>>>>>>>>>Define KP_SCHANNEL_ALG                  for 20      // for setting the Secure Channel algorithms
67892>>>>>>>>>Define KP_CLIENT_RANDOM                 for 21      // for setting the Secure Channel client random data
67892>>>>>>>>>Define KP_SERVER_RANDOM                 for 22      // for setting the Secure Channel server random data
67892>>>>>>>>>Define KP_RP                            for 23
67892>>>>>>>>>Define KP_PRECOMP_MD5                   for 24
67892>>>>>>>>>Define KP_PRECOMP_SHA                   for 25
67892>>>>>>>>>Define KP_CERTIFICATE                   for 26      // for setting Secure Channel certificate data (PCT1)
67892>>>>>>>>>Define KP_CLEAR_KEY                     for 27      // for setting Secure Channel clear key data (PCT1)
67892>>>>>>>>>Define KP_PUB_EX_LEN                    for 28
67892>>>>>>>>>Define KP_PUB_EX_VAL                    for 29
67892>>>>>>>>>Define KP_KEYVAL                        for 30
67892>>>>>>>>>Define KP_ADMIN_PIN                     for 31
67892>>>>>>>>>Define KP_KEYEXCHANGE_PIN               for 32
67892>>>>>>>>>Define KP_SIGNATURE_PIN                 for 33
67892>>>>>>>>>Define KP_PREHASH                       for 34
67892>>>>>>>>>Define KP_ROUNDS                        for 35
67892>>>>>>>>>Define KP_OAEP_PARAMS                   for 36      // for setting OAEP params on RSA keys
67892>>>>>>>>>Define KP_CMS_KEY_INFO                  for 37
67892>>>>>>>>>Define KP_CMS_DH_KEY_INFO               for 38
67892>>>>>>>>>Define KP_PUB_PARAMS                    for 39      // for setting public parameters
67892>>>>>>>>>Define KP_VERIFY_PARAMS                 for 40      // for verifying DSA and DH parameters
67892>>>>>>>>>Define KP_HIGHEST_VERSION               for 41      // for TLS protocol version setting
67892>>>>>>>>>Define KP_GET_USE_COUNT                 for 42      // for use with PP_CRYPT_COUNT_KEY_USE contexts
67892>>>>>>>>>
67892>>>>>>>>>// dwParam definitions for CryptGetHashParam
67892>>>>>>>>>Define HP_ALGID                         for |CI$0001  // Hash algorithm
67892>>>>>>>>>Define HP_HASHVAL                       for |CI$0002  // Hash value
67892>>>>>>>>>Define HP_HASHSIZE                      for |CI$0004  // Hash value size
67892>>>>>>>>>Define HP_HMAC_INFO                     for |CI$0005  // information for creating an HMA
67892>>>>>>>>>
67892>>>>>>>>>// key BLOB types
67892>>>>>>>>>Define KEYSTATEBLOB                     for |CI$0C
67892>>>>>>>>>Define OPAQUEKEYBLOB                    for |CI$09
67892>>>>>>>>>Define PLAINTEXTKEYBLOB                 for |CI$08
67892>>>>>>>>>Define PRIVATEKEYBLOB                   for |CI$07
67892>>>>>>>>>Define PUBLICKEYBLOB                    for |CI$06
67892>>>>>>>>>Define PUBLICKEYBLOBEX                  for |CI$0A
67892>>>>>>>>>Define SIMPLEBLOB                       for |CI$01
67892>>>>>>>>>Define SYMMETRICWRAPKEYBLOB             for |CI$0B
67892>>>>>>>>>
67892>>>>>>>>>Define CUR_BLOB_VERSION                 for 2
67892>>>>>>>>>
67892>>>>>>>>>//  Structure cryptimportkey
67892>>>>>>>>>Struct PUBLICKEYSTRUC
67892>>>>>>>>>    UChar    bType
67892>>>>>>>>>    UChar    bVersion
67892>>>>>>>>>    UShort   reserved
67892>>>>>>>>>    UInteger aiKeyAlg
67892>>>>>>>>>End_Struct
67892>>>>>>>>>
67892>>>>>>>>>Struct tPLAINTEXTKEYBLOB
67892>>>>>>>>>    PUBLICKEYSTRUC hdr
67892>>>>>>>>>    PUBLICKEYSTRUC hdr
67892>>>>>>>>>    UInteger       dwKeySize
67892>>>>>>>>>//    UChar[]        rgbKeyData
67892>>>>>>>>>End_Struct
67892>>>>>>>>>
67892>>>>>>>>>
67892>>>>>>>>>
67892>>>>>>>>>//  Structure for specifying the inner and outer strings when calculating HMAC hash (use with CryptSetHashParam)
67892>>>>>>>>>Struct HMAC_INFO
67892>>>>>>>>>    UInteger HashAlgid
67892>>>>>>>>>    Pointer pbInnerString
67892>>>>>>>>>    DWord cbInnerString
67892>>>>>>>>>    Pointer pbOuterString
67892>>>>>>>>>    DWord cbOuterString
67892>>>>>>>>>End_Struct
67892>>>>>>>>>
67892>>>>>>>>>
67892>>>>>>>>>External_Function CryptAcquireContext "CryptAcquireContextA" advapi32.dll ;    Pointer phProv ;    Pointer szContainer ;    Pointer szProvider ;    Integer dwProvType ;    Integer dwFlags ;    Returns Boolean
67893>>>>>>>>>
67893>>>>>>>>>External_Function CryptReleaseContext "CryptReleaseContext" advapi32.dll ;    Handle hProv ;    Integer dwFlags ;    Returns Boolean
67894>>>>>>>>>
67894>>>>>>>>>External_Function CryptCreateHash "CryptCreateHash" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hKey ;    Integer dwFlags ;    Pointer phHash ;    Returns Boolean
67895>>>>>>>>>
67895>>>>>>>>>External_Function CryptDestroyHash "CryptDestroyHash" advapi32.dll ;    Handle hHash ;    Returns Boolean
67896>>>>>>>>>
67896>>>>>>>>>External_Function CryptHashData "CryptHashData" advapi32.dll ;    Handle hHash ;    Pointer pbData ;    Integer dwDataLen ;    Integer dwFlags ;    Returns Boolean
67897>>>>>>>>>
67897>>>>>>>>>External_Function CryptDeriveKey "CryptDeriveKey" advapi32.dll ;    Handle hProv ;    Integer Algid ;    Handle hBaseData ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
67898>>>>>>>>>
67898>>>>>>>>>External_Function CryptGetHashParam "CryptGetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    DWord dwFlags ;    Returns Integer
67899>>>>>>>>>
67899>>>>>>>>>External_Function CryptDestroyKey "CryptDestroyKey" advapi32.dll ;    Handle hKey ;    Returns Boolean
67900>>>>>>>>>
67900>>>>>>>>>External_Function CryptImportKey "CryptImportKey" advapi32.dll ;    Handle hProv ;    Pointer pbData ;    Integer dwDataLen ;    Handle hPubKey ;    Integer dwFlags ;    Pointer phKey ;    Returns Boolean
67901>>>>>>>>>
67901>>>>>>>>>External_Function CryptGetKeyParam "CryptGetKeyParam" advapi32.dll ;    Handle hKey ;    Integer dwParam ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwFlags ;    Returns Boolean
67902>>>>>>>>>    
67902>>>>>>>>>External_Function CryptSetKeyParam "CryptSetKeyParam" advapi32.dll ;    Handle   hKey ;    UInteger dwParam ;    Pointer  pbdata ;    UInteger dwFlags ;    Returns  Boolean
67903>>>>>>>>>
67903>>>>>>>>>External_Function CryptEncrypt "CryptEncrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Integer dwBufLen ;    Returns Boolean
67904>>>>>>>>>
67904>>>>>>>>>External_Function CryptDecrypt "CryptDecrypt" advapi32.dll ;    Handle hKey ;    Handle hHash ;    Boolean bFinal ;    Integer dwFlags ;    Pointer pbData ;    Pointer pdwDataLen ;    Returns Boolean
67905>>>>>>>>>
67905>>>>>>>>>External_Function CryptGenRandom "CryptGenRandom" advapi32.dll ;    Handle hProv ;    DWord dwLen ;    Pointer pbBuffer ;    Returns Boolean
67906>>>>>>>>>    
67906>>>>>>>>>External_Function CryptSetHashParam "CryptSetHashParam" advapi32.dll ;    Handle hHash ;    DWord dwParam ;    Pointer pbData ;    Integer dwFlags ;    Returns Boolean
67907>>>>>>>>>    
67907>>>>>>>
67907>>>>>>>Class cCryptographer is a cObject
67908>>>>>>>    
67908>>>>>>>    Procedure Construct_Object
67910>>>>>>>        Forward Send Construct_Object
67912>>>>>>>        
67912>>>>>>>        Property String     psProvider  MS_ENHANCED_PROV
67913>>>>>>>        Property Integer    piProvider  PROV_RSA_FULL
67914>>>>>>>        Property Integer    piCipher    CALG_RC4
67915>>>>>>>        Property Integer    piHash      CALG_MD5
67916>>>>>>>        
67916>>>>>>>        // Private properties
67916>>>>>>>        Property Handle     Private_phProv
67917>>>>>>>    End_Procedure
67918>>>>>>>    
67918>>>>>>>    
67918>>>>>>>    // Acquire key container handle
67918>>>>>>>    Function AcquireContext Returns Handle
67920>>>>>>>        Integer iProvider
67920>>>>>>>        String sProvider
67920>>>>>>>        Handle hProv
67920>>>>>>>        Boolean bOk
67920>>>>>>>        Address addrProv
67920>>>>>>>        
67920>>>>>>>        Move 0 to hProv
67921>>>>>>>        Get piProvider to iProvider
67922>>>>>>>        Get psProvider to sProvider
67923>>>>>>>        
67923>>>>>>>        //  Determine address to be passed as provider
67923>>>>>>>        If (Trim(sProvider) <> "") Begin
67925>>>>>>>            Move (AddressOf(sProvider)) to addrProv
67926>>>>>>>        End
67926>>>>>>>>
67926>>>>>>>        Else Begin
67927>>>>>>>            Move 0 to addrProv
67928>>>>>>>        End
67928>>>>>>>>
67928>>>>>>>        
67928>>>>>>>        //  Acquire Crypto Context
67928>>>>>>>        Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_VERIFYCONTEXT)) to bOk
67929>>>>>>>        If (not(bOk) or hProv = 0) Begin
67931>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET ior CRYPT_VERIFYCONTEXT)) to bOk
67932>>>>>>>        End
67932>>>>>>>>
67932>>>>>>>        
67932>>>>>>>        If (not(bOk) or hProv = 0) Begin
67934>>>>>>>            // Fallback to original
67934>>>>>>>            Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,0)) to bOk
67935>>>>>>>            
67935>>>>>>>            If (not(bOk) or hProv = 0) Begin
67937>>>>>>>                Move (CryptAcquireContext(AddressOf(hProv),0,addrProv,iProvider,CRYPT_NEWKEYSET)) to bOk
67938>>>>>>>            End
67938>>>>>>>>
67938>>>>>>>        End
67938>>>>>>>>
67938>>>>>>>        Set Private_phProv to hProv
67939>>>>>>>        
67939>>>>>>>        Function_Return hProv
67940>>>>>>>    End_Function
67941>>>>>>>    
67941>>>>>>>    // Releases key container handle
67941>>>>>>>    Function ReleaseContext Handle hProv Returns Boolean
67943>>>>>>>        Function_Return (CryptReleaseContext(hProv,0))
67944>>>>>>>    End_Function
67945>>>>>>>    
67945>>>>>>>    // Creates hash object
67945>>>>>>>    Function CreateHash Handle hProv Returns Handle
67947>>>>>>>        Integer iAlgorithm
67947>>>>>>>        Handle hHash
67947>>>>>>>        Boolean bOk
67947>>>>>>>        
67947>>>>>>>        Move 0 to hHash
67948>>>>>>>        Get piHash to iAlgorithm
67949>>>>>>>        Move (CryptCreateHash(hProv,iAlgorithm,0,0,AddressOf(hHash))) to bOk
67950>>>>>>>        
67950>>>>>>>        Function_Return hHash
67951>>>>>>>    End_Function
67952>>>>>>>    
67952>>>>>>>    // Destroys the hash object
67952>>>>>>>    Function DestroyHash Handle hHash Returns Boolean
67954>>>>>>>        Function_Return (CryptDestroyHash(hHash))
67955>>>>>>>    End_Function
67956>>>>>>>    
67956>>>>>>>    // Adds data to hash object
67956>>>>>>>    Function HashData Handle hHash String sData Returns Boolean
67958>>>>>>>        Function_Return (CryptHashData(hHash,AddressOf(sData),Length(sData),0))
67959>>>>>>>    End_Function
67960>>>>>>>    
67960>>>>>>>    // Generates session key
67960>>>>>>>    Function DeriveKey Handle hProv Handle hHash Returns Handle
67962>>>>>>>        Integer iAlgorithm
67962>>>>>>>        Handle hKey
67962>>>>>>>        Boolean bOk
67962>>>>>>>        
67962>>>>>>>        Move 0 to hKey
67963>>>>>>>        Get piCipher to iAlgorithm
67964>>>>>>>        Move (CryptDeriveKey(hProv,iAlgorithm,hHash,CRYPT_EXPORTABLE,AddressOf(hKey))) to bOk
67965>>>>>>>        
67965>>>>>>>        Function_Return hKey
67966>>>>>>>    End_Function
67967>>>>>>>    
67967>>>>>>>    // Imports a plain text key
67967>>>>>>>    Function ImportPlainTextKey Handle hProv UChar[] ucaKey Returns Handle
67969>>>>>>>        tPLAINTEXTKEYBLOB blobhead
67969>>>>>>>        tPLAINTEXTKEYBLOB blobhead
67969>>>>>>>        Boolean   bSuccess
67969>>>>>>>        Handle    hKey
67969>>>>>>>        Integer   iHeadSize iKeySize
67969>>>>>>>        UChar[]   ucaKeyblob
67970>>>>>>>        Integer iVoid
67970>>>>>>>        
67970>>>>>>>        Move (SizeOfType(tPLAINTEXTKEYBLOB)) to iHeadSize
67971>>>>>>>        Move (SizeOfArray(ucaKey)) to iKeySize
67972>>>>>>>        
67972>>>>>>>        Move PLAINTEXTKEYBLOB to blobhead.hdr.bType
67973>>>>>>>        Move CUR_BLOB_VERSION   to blobhead.hdr.bVersion
67974>>>>>>>        Get piCipher            to blobhead.hdr.aiKeyAlg
67975>>>>>>>        Move iKeySize           to blobhead.dwKeySize
67976>>>>>>>        
67976>>>>>>>        Move (ResizeArray(ucaKeyblob, iHeadSize)) to ucaKeyblob
67977>>>>>>>        Move (CopyMemory(AddressOf(ucaKeyblob), AddressOf(blobhead), iHeadSize)) to iVoid
67978>>>>>>>        Move (AppendArray(ucaKeyblob, ucaKey)) to ucaKeyblob
67979>>>>>>>        
67979>>>>>>>        Move 0 to hKey
67980>>>>>>>        Move (CryptImportKey(hProv, AddressOf(ucaKeyblob), SizeOfArray(ucaKeyblob), 0, 0, AddressOf(hKey))) to bSuccess
67981>>>>>>>        If (not(bSuccess)) Begin
67983>>>>>>>            Move (ShowLastError()) to iVoid
67984>>>>>>>        End
67984>>>>>>>>
67984>>>>>>>        
67984>>>>>>>        Function_Return hKey
67985>>>>>>>    End_Function
67986>>>>>>>    
67986>>>>>>>    // Destroys the key
67986>>>>>>>    Function DestroyKey Handle hKey Returns Boolean
67988>>>>>>>        Function_Return (CryptDestroyKey(hKey))
67989>>>>>>>    End_Function
67990>>>>>>>    
67990>>>>>>>    // Retrieves key data
67990>>>>>>>    Function KeyParameter Handle hKey Integer iQuery Returns Integer
67992>>>>>>>        Integer iBuffer iLen
67992>>>>>>>        Boolean bOk
67992>>>>>>>        
67992>>>>>>>        Move (SizeOfType(Integer)) to iLen
67993>>>>>>>        Move (CryptGetKeyParam(hKey,iQuery,AddressOf(iBuffer),AddressOf(iLen),0)) to bOk
67994>>>>>>>        Function_Return iBuffer
67995>>>>>>>    End_Function
67996>>>>>>>    
67996>>>>>>>    // Retrieves a hash value
67996>>>>>>>    Function HashValue Handle lhHash Returns String
67998>>>>>>>        String  lsHash
67998>>>>>>>        Integer liResult
67998>>>>>>>        DWord   dwDataLen
67998>>>>>>>        
67998>>>>>>>        Move 0 to dwDataLen
67999>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,0,AddressOf(dwDataLen),0)) to liResult
68000>>>>>>>        If (liResult = 0) ;            Function_Return ""
68003>>>>>>>        
68003>>>>>>>        Move (Repeat(Character(0),dwDataLen)) to lsHash
68004>>>>>>>        Move (CryptGetHashParam(lhHash,HP_HASHVAL,AddressOf(lsHash),AddressOf(dwDataLen),0)) to liResult
68005>>>>>>>        If (liResult = 0) ;            Function_Return ""
68008>>>>>>>        
68008>>>>>>>        Function_Return lsHash
68009>>>>>>>    End_Function
68010>>>>>>>
68010>>>>>>>    // Encrypts data
68010>>>>>>>    Function Encrypt String sPassword String sData Returns String
68012>>>>>>>        Handle hProv hHash hKey
68012>>>>>>>        Integer iAlgorithm iDataLen iCipherLen iErr
68012>>>>>>>        Boolean bOk
68012>>>>>>>        
68012>>>>>>>        Get AcquireContext to hProv
68013>>>>>>>        If (hProv) Begin
68015>>>>>>>            Get CreateHash hProv to hHash
68016>>>>>>>            If (hHash) Begin
68018>>>>>>>                Get HashData hHash sPassword to bOk
68019>>>>>>>                If (bOk) Begin
68021>>>>>>>                    Get piCipher to iAlgorithm
68022>>>>>>>                    Get DeriveKey hProv hHash to hKey
68023>>>>>>>                End
68023>>>>>>>>
68023>>>>>>>                Get DestroyHash hHash to bOk
68024>>>>>>>            End
68024>>>>>>>>
68024>>>>>>>            
68024>>>>>>>            If (hKey) Begin
68026>>>>>>>                //  First call to determine resulting data size
68026>>>>>>>                Move (Length(sData)) to iDataLen
68027>>>>>>>                Move (Length(sData)) to iCipherLen
68028>>>>>>>                Move (CryptEncrypt(hKey, 0, True, 0, 0, AddressOf(iCipherLen), iDataLen)) to bOk
68029>>>>>>>                
68029>>>>>>>                //  Reserve space in string
68029>>>>>>>                If (iDataLen < iCipherLen) Begin
68031>>>>>>>                    Move (sData + Repeat(" ", iCipherLen - iDataLen)) to sData
68032>>>>>>>                End
68032>>>>>>>>
68032>>>>>>>                
68032>>>>>>>                //  Call to really decrypt
68032>>>>>>>                Move (CryptEncrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen),Length(sData))) to bOk
68033>>>>>>>                //If (not(bOk)) Begin
68033>>>>>>>                //Move "" to sData
68033>>>>>>>                //Move (GetLastError()) to iErr
68033>>>>>>>                //End
68033>>>>>>>                
68033>>>>>>>                Get DestroyKey hKey to bOk
68034>>>>>>>            End 
68034>>>>>>>>
68034>>>>>>>            Get ReleaseContext hProv to bOk
68035>>>>>>>        End 
68035>>>>>>>>
68035>>>>>>>        Function_Return sData
68036>>>>>>>    End_Function
68037>>>>>>>    
68037>>>>>>>    // Decrypts data
68037>>>>>>>    Function Decrypt String sPassword String sData Returns String
68039>>>>>>>        Handle hProv hHash hKey
68039>>>>>>>        Integer iAlgorithm iDataLen
68039>>>>>>>        Boolean bOk
68039>>>>>>>        
68039>>>>>>>        Get AcquireContext to hProv
68040>>>>>>>        If (hProv) Begin
68042>>>>>>>            Get CreateHash hProv to hHash
68043>>>>>>>            If (hHash) Begin
68045>>>>>>>                Get HashData hHash sPassword to bOk
68046>>>>>>>                If (bOk) Begin
68048>>>>>>>                    Get piCipher to iAlgorithm
68049>>>>>>>                    Get DeriveKey hProv hHash to hKey
68050>>>>>>>                End
68050>>>>>>>>
68050>>>>>>>                Get DestroyHash hHash to bOk
68051>>>>>>>            End
68051>>>>>>>>
68051>>>>>>>            
68051>>>>>>>            If (hKey) Begin
68053>>>>>>>                Move (Length(sData)) to iDataLen
68054>>>>>>>                Move (CryptDecrypt(hKey,0,True,0,AddressOf(sData),AddressOf(iDataLen))) to bOk
68055>>>>>>>                //  Resulting dat can be shorter as the input string, in that case we shorten the result string
68055>>>>>>>                If (Length(sData) > iDataLen) Begin
68057>>>>>>>                    Move (Left(sData, iDataLen)) to sData
68058>>>>>>>                End
68058>>>>>>>>
68058>>>>>>>                
68058>>>>>>>                Get DestroyKey hKey to bOk
68059>>>>>>>            End
68059>>>>>>>>
68059>>>>>>>            Get ReleaseContext hProv to bOk
68060>>>>>>>        End
68060>>>>>>>>
68060>>>>>>>        Function_Return sData
68061>>>>>>>    End_Function
68062>>>>>>>    
68062>>>>>>>    //  Generates random data.
68062>>>>>>>    Function GenerateRandom Integer iBytes Returns UChar[]
68064>>>>>>>        Handle hProv
68064>>>>>>>        UChar[] uaResult
68065>>>>>>>        Boolean bRes
68065>>>>>>>        
68065>>>>>>>        Get AcquireContext to hProv
68066>>>>>>>        
68066>>>>>>>        Move (ResizeArray(uaResult, iBytes)) to uaResult
68067>>>>>>>        Move (CryptGenRandom(hProv, iBytes, AddressOf(uaResult))) to bRes
68068>>>>>>>        
68068>>>>>>>        Get ReleaseContext hProv to bRes
68069>>>>>>>        
68069>>>>>>>        Function_Return uaResult
68070>>>>>>>    End_Function
68071>>>>>>>    
68071>>>>>>>    //  Generates random data and does a base64 encoding to properly present it as a string.
68071>>>>>>>    Function GenerateRandomString Integer iLenght Returns String
68073>>>>>>>        String sResult
68073>>>>>>>        UChar[] aData
68074>>>>>>>        Address pBase64
68074>>>>>>>        Integer iVoid
68074>>>>>>>        
68074>>>>>>>        Get GenerateRandom iLenght to aData
68075>>>>>>>        
68075>>>>>>>        Move (Base64Encode(AddressOf(aData), iLenght)) to pBase64
68076>>>>>>>        Move pBase64 to sResult
68077>>>>>>>        Move (Free(pBase64)) to iVoid
68078>>>>>>>        
68078>>>>>>>        Function_Return (Left(sResult, iLenght))
68079>>>>>>>    End_Function
68080>>>>>>>    
68080>>>>>>>End_Class
68081>>>>>
68081>>>>>Class cLoginEncryption is a cObject
68082>>>>>    
68082>>>>>    Procedure Construct_Object
68084>>>>>        Forward Send Construct_Object
68086>>>>>        // this must be set to a multi (40ish) character random key
68086>>>>>        Property String psEncryptPassword ""
68087>>>>>        
68087>>>>>        Object oDataCrypter is a cCryptographer
68089>>>>>            Set piHash to CALG_SHA_256
68090>>>>>            Set piCipher to CALG_AES_256
68091>>>>>            Set psProvider to "" //  Not providing a specific provider gives the default provider for the provider type
68092>>>>>            Set piProvider to PROV_RSA_AES
68093>>>>>        End_Object
68094>>>>>    End_Procedure
68095>>>>>    
68095>>>>>    // This can be augmented to return a password encryption key using any
68095>>>>>    // hidden mechanism desired.
68095>>>>>    Function GetEncryptionPassword Returns String
68097>>>>>        String sPassword
68097>>>>>        Get psEncryptPassword to sPassword
68098>>>>>        Function_Return sPassword
68099>>>>>    End_Function
68100>>>>>    
68100>>>>>    // Encrypts a string into an unreadable hash that can later be decrypted using DecryptKey.
68100>>>>>    //
68100>>>>>    // Params:
68100>>>>>    //   sPlainText     String to encrypt.
68100>>>>>    // Returns:
68100>>>>>    //   Base64 encoded hash.
68100>>>>>    Function EncryptPassword String sPlainText Returns String
68102>>>>>        String sEncryptPassword sBinary sBase64
68102>>>>>        Address pBase64
68102>>>>>        Integer iVoid
68102>>>>>        
68102>>>>>        //  Encrypt Key
68102>>>>>        Get GetEncryptionPassword to sEncryptPassword
68103>>>>>        If (sEncryptPassword = "") Begin
68105>>>>>            Error DFERR_PROGRAM "No encryption password set"
68106>>>>>>
68106>>>>>        End
68106>>>>>>
68106>>>>>        
68106>>>>>        Get Encrypt of oDataCrypter sEncryptPassword sPlainText to sBinary
68107>>>>>        
68107>>>>>        If (sPlainText = sBinary or sBinary = "") Begin
68109>>>>>            Error DFERR_PROGRAM "Unable to encrypt database login password"
68110>>>>>>
68110>>>>>            Function_Return ""
68111>>>>>        End
68111>>>>>>
68111>>>>>        
68111>>>>>        //  Encode binary hash to Base64
68111>>>>>        Move (Base64Encode(AddressOf(sBinary), Length(sBinary))) to pBase64
68112>>>>>        Move pBase64 to sBase64
68113>>>>>        Move (Free(pBase64)) to iVoid
68114>>>>>        
68114>>>>>        Function_Return sBase64
68115>>>>>    End_Function
68116>>>>>    
68116>>>>>    
68116>>>>>    // Decrypts the unreadable hash generated by EncryptKey into a readable string.
68116>>>>>    //
68116>>>>>    // Params:
68116>>>>>    //   sBase64EncryptedPassword       Base64 Encrypted password
68116>>>>>    // Returns:
68116>>>>>    //   Readable plain text password
68116>>>>>    Function DecryptPassword String sBase64EncryptedPassword Returns String
68118>>>>>        String sEncryptPassword sPlainText sBinary
68118>>>>>        Boolean bIsHex
68118>>>>>        Integer iLen iVoid
68118>>>>>        Address pBinary
68118>>>>>        
68118>>>>>        If (sBase64EncryptedPassword <> "") Begin
68120>>>>>            //  Decode from Base64
68120>>>>>            Move (Base64Decode(AddressOf(sBase64EncryptedPassword), &iLen)) to pBinary
68121>>>>>            
68121>>>>>            Move (Repeat(Character(0), iLen)) to sBinary
68122>>>>>            Move (CopyMemory(AddressOf(sBinary), pBinary, iLen)) to iVoid
68123>>>>>            
68123>>>>>            Move (Free(pBinary)) to iVoid
68124>>>>>            
68124>>>>>            //  Encrypted binary hash to string
68124>>>>>            Get GetEncryptionPassword to sEncryptPassword
68125>>>>>            Get Decrypt of oDataCrypter sEncryptPassword sBinary to sPlainText
68126>>>>>        End
68126>>>>>>
68126>>>>>        
68126>>>>>        Function_Return sPlainText
68127>>>>>    End_Function
68128>>>>>End_Class
68129>>>
68129>>>Object oLoginEncryption is a cLoginEncryption
68131>>>
68131>>>    // this must be created in your appsrc directory and must contain an encryption
68131>>>    // key that is set to psEncryptPassword. It will look something like this
68131>>>    //
68131>>>    // Set psEncryptPassword to "JchUAo7W@r.b{<Yk~OONi0nq=sMi[*Rn[A-`Vo)q"
68131>>>    //  
Including file: LoginEncryptionKey.inc    (C:\DataFlex Projects\LearnTheLanguage\AppSrc\LoginEncryptionKey.inc)
68131>>>>// Studio generated login encryption key
68131>>>>Set psEncryptPassword to "#38#>1Q#fF:`[e*w38.u7bM%phQAUZMi-J[MbQI)"
68132>>>>
68132>>>    
68132>>>    // use this to register this object to your cConnection Object. This object
68132>>>    // must be created after the cConnection object
68132>>>    Move Self to ghoLoginEncryption
68133>>>End_Object
68134>        Use DatabaseLoginDialog.dg
Including file: DatabaseLoginDialog.dg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\DatabaseLoginDialog.dg)
68134>>>
68134>>>Use Windows.pkg
68134>>>Use cConnection.pkg
68134>>>Use dfLine.pkg
68134>>>
68134>>>Object oDatabaseLoginDialog is a ModalPanel
68136>>>    Set Label to "Database Login"
68137>>>    Set Location to 2 2
68138>>>    Set Size to 110 211
68139>>>    
68139>>>    Property String psId
68141>>>    Property Boolean pbOk False
68143>>>    Property Boolean pbChanged False
68145>>>    Property Boolean pbAllowRemember True
68147>>>    
68147>>>    // this registers this object with the cConnection object.
68147>>>    Move Self to ghoLoginConnectDialog
68148>>>    
68148>>>    Object oUserIDForm is a Form
68150>>>        Set Label to "User Name"
68151>>>        Set Size to 12 85
68152>>>        Set Location to 34 79
68153>>>        Set Label_Col_Offset to 64
68154>>>        Set peAnchors to anTopLeftRight
68155>>>    End_Object
68156>>>    
68156>>>    Object oPwdForm is a Form
68158>>>        Set Size to 12 85
68159>>>        Set Location to 49 79
68160>>>        Set Label_Col_Offset to 64
68161>>>        Set Password_State to True
68162>>>        Set peAnchors to anTopLeftRight
68163>>>        Set Label to "Password"
68164>>>    End_Object
68165>>>    
68165>>>    Object oTrustedConnection is a CheckBox
68167>>>        Set Size to 10 50
68168>>>        Set Location to 65 79
68169>>>        Set Label to "Trusted Connection"
68170>>>    End_Object
68171>>>    
68171>>>    Object oRemember is a CheckBox
68173>>>        Set Size to 10 50
68174>>>        Set Location to 79 14
68175>>>        Set Label to "Remember and don't ask again"
68176>>>        Set Checked_State to True
68177>>>    End_Object
68178>>>    
68178>>>    Object oLogin_btn is a Button
68180>>>        Set Label to "&Login"
68181>>>        Set Location to 92 102
68182>>>        Set peAnchors to anBottomRight
68183>>>        Set Default_State to True
68184>>>        
68184>>>        Procedure OnClick
68187>>>            Boolean bTrust
68187>>>            String sUser sPwd sConn sErr sId
68187>>>            Integer iError
68187>>>            Get psId to sId
68188>>>            Get Value of oUserIDForm to sUser
68189>>>            Get Value of oPwdForm to sPwd
68190>>>            Get Checked_State of oTrustedConnection to bTrust
68191>>>            
68191>>>            Get LoginConnectIdNewCredentials of ghoConnection sId sUser sPwd bTrust to iError
68192>>>            If (iError=0) Begin
68194>>>                Set pbOk to True
68195>>>                Set pbChanged to True
68196>>>                Send Close_Panel
68197>>>            End
68197>>>>
68197>>>            Else Begin
68198>>>                Get psErrorText of ghoConnection to sErr
68199>>>                Send UserError sErr "Login Error"
68200>>>            End
68200>>>>
68200>>>        End_Procedure
68201>>>    End_Object
68202>>>    
68202>>>    Object oCancel_btn is a Button
68204>>>        Set Label to "&Cancel"
68205>>>        Set Location to 92 157
68206>>>        Set peAnchors to anBottomRight
68207>>>        
68207>>>        Procedure OnClick
68210>>>            Send Close_Panel
68211>>>        End_Procedure
68212>>>    End_Object
68213>>>    
68213>>>    Object oConnectionIdInfo is a TextBox
68215>>>        Set Size to 10 50
68216>>>        Set Location to 4 14
68217>>>        Set Label to 'Connection Id='
68218>>>    End_Object
68219>>>    
68219>>>    Object oConnectionServerInfo is a TextBox
68221>>>        Set Size to 10 50
68222>>>        Set Location to 16 14
68223>>>        Set Label to 'Server'
68224>>>    End_Object
68225>>>    
68225>>>    Object oLineControl1 is a LineControl
68227>>>        Set Size to 2 202
68228>>>        Set Location to 29 5
68229>>>    End_Object
68230>>>    
68230>>>    Function LoginConnectIdDialog String sId Returns Boolean
68233>>>        Boolean bOk bChanged bTrusted bAllowRemember bRemember
68233>>>        String sUser sPwd sDescription
68233>>>        tConnection Connect
68233>>>        tConnection Connect
68233>>>        
68233>>>        Get pbAllowRemember to bAllowRemember
68234>>>        
68234>>>        
68234>>>        If not bAllowRemember Begin
68236>>>            Set Enabled_State of oRemember to bRemember
68237>>>            Set Visible_State of oRemember to bRemember
68238>>>        End
68238>>>>
68238>>>        
68238>>>        Get ConnectionIdInfo of ghoConnection sId to Connect
68239>>>        Set Value of oConnectionIdInfo to ("Connection ID="+Connect.sId)
68240>>>        Set Value of oConnectionServerInfo to Connect.sString
68241>>>        
68241>>>        Set psId to sId
68242>>>        Set pbOk to False
68243>>>        Set pbChanged to False
68244>>>        Set Value of oUserIDForm to Connect.sUID
68245>>>        Set Value of oPwdForm to ""
68246>>>        
68246>>>        Send Popup
68247>>>        
68247>>>        Get pbOk to bOk
68248>>>        Get pbChanged to bChanged
68249>>>        If (bChanged and bOk) Begin
68251>>>            If bAllowRemember Begin
68253>>>                Get Checked_State of oRemember to bRemember
68254>>>                If bRemember Begin
68256>>>                    Get Checked_State of oTrustedConnection to bTrusted
68257>>>                    If not (bTrusted) Begin
68259>>>                        Get Value of oUserIDForm to sUser
68260>>>                        Get Value of oPwdForm to sPwd
68261>>>                    End
68261>>>>
68261>>>                    Get StoreConnectionIdCredentials of ghoConnection sId sUser sPwd bTrusted to bOk
68262>>>                End
68262>>>>
68262>>>            End
68262>>>>
68262>>>        End
68262>>>>
68262>>>        Function_Return bOk
68263>>>    End_Function
68264>>>    
68264>>>    
68264>>>    On_Key Key_Alt+Key_O Send KeyAction of oLogin_btn
68265>>>    On_Key Key_Alt+Key_L Send KeyAction of oCancel_btn
68266>>>End_Object
68267>>>
68267>    End_Object
68268>
68268>End_Object
68269>
68269>Object oToolTipController is a cToolTipController
68271>    Move Self to ghoToolTipController
68272>End_Object
68273>
68273>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\oEditContextMenu.pkg)
68273>>>Use cCJStandardMenuItemClasses.pkg
68273>>>
68273>>>Object oEditContextMenu is a cCJContextMenu
68275>>>    
68275>>>    Move Self to Default_Form_Floating_Menu_ID
68276>>>    
68276>>>    Object oUndoMenuItem is a cCJUndoMenuItem
68278>>>    End_Object
68279>>>    
68279>>>    Object oCutMenuItem is a cCJCutMenuItem
68281>>>        Set pbControlBeginGroup to True
68282>>>    End_Object
68283>>>    
68283>>>    Object oCopyMenuItem is a cCJCopyMenuItem
68285>>>    End_Object
68286>>>
68286>>>    Object oPasteMenuItem is a cCJPasteMenuItem
68288>>>    End_Object
68289>>>
68289>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
68291>>>    End_Object
68292>>>
68292>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
68294>>>        Set pbControlBeginGroup to True
68295>>>    End_Object
68296>>>
68296>>>End_Object
68297>>>
68297>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\oDEOEditContextMenu17.pkg)
68297>>>Use Windows.pkg
68297>>>Use cCJStandardMenuItemClasses.pkg
68297>>>Use cCJDeoMenuItemClasses.pkg
68297>>>
68297>>>
68297>>>Object oDEOEditContextMenu17 is a cCJContextMenu
68299>>>    
68299>>>    Move Self to Default_dbFloating_Menu_ID
68300>>>    
68300>>>    Object oUndoMenuItem is a cCJUndoMenuItem
68302>>>    End_Object
68303>>>    
68303>>>    Object oCutMenuItem is a cCJCutMenuItem
68305>>>        Set pbControlBeginGroup to True
68306>>>    End_Object
68307>>>    
68307>>>    Object oCopyMenuItem is a cCJCopyMenuItem
68309>>>    End_Object
68310>>>
68310>>>    Object oPasteMenuItem is a cCJPasteMenuItem
68312>>>    End_Object
68313>>>
68313>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
68315>>>    End_Object
68316>>>
68316>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
68318>>>        Set pbControlBeginGroup to True
68319>>>    End_Object
68320>>>
68320>>>    Object oPromptMenuItem is a cCJPromptMenuItem
68322>>>        Set pbControlBeginGroup to True
68323>>>    End_Object
68324>>>
68324>>>    Object oFindNextMenu is a cCJFindNextMenuItem
68326>>>        Set pbControlBeginGroup to True
68327>>>    End_Object
68328>>>
68328>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
68330>>>    End_Object
68331>>>
68331>>>    Object oClearMenuItem is a cCJClearMenuItem
68333>>>        Set pbControlBeginGroup to True
68334>>>    End_Object
68335>>>
68335>>>    Object oClearAllMenu is a cCJClearAllMenuItem
68337>>>    End_Object
68338>>>
68338>>>    Object oSaveMenu is a cCJSaveMenuItem
68340>>>    End_Object
68341>>>    
68341>>>    Object oDeleteMenu is a cCJDeleteMenuItem
68343>>>    End_Object
68344>>>
68344>>>    Object oRememberitem is a cCJRememberFieldMenuItem
68346>>>        Set pbControlBeginGroup to True
68347>>>    End_Object
68348>>>
68348>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
68350>>>    End_Object
68351>>>
68351>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
68353>>>    End_Object
68354>>>
68354>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
68356>>>    End_Object
68357>>>
68357>>>End_Object
68358>
68358>Object oMain is a Panel
68360>    Set Label To "My Project"
68361>    Set Location to 4 3
68362>    Set Size to 300 450
68363>
68363>    Object oCommandBarSystem is a cCJCommandBarSystem
68365>        Set pbTimerUpdate to True
68366>        Set peVisualTheme to xtpThemeOffice2013Outlook
68367>        Set pbAutoResizeIcons to True
68368>
68368>        Procedure OnCreateCommandBars
68371>            Handle hoOptions
68371>            Get OptionsObject to hoOptions
68372>            Forward Send OnCreateCommandBars
68374>        End_Procedure
68375>
68375>        Object oMenuBar is a cCJMenuBar
68377>
68377>            Object oFileMenu is a cCJMenuItem
68379>                Set peControlType to xtpControlPopup          
68380>                Set psCaption   to "&File"
68381>                Set psDescription to "Find, Save, Delete, Clear information or quit this application."
68382>                Set psCategory to "Menus"
68383>
68383>                Object oClearMenuItem is a cCJClearMenuItem
68385>                    Set pbAddToDesignerMenu to True
68386>                End_Object
68387>
68387>                Object oClearAllMenu is a cCJClearAllMenuItem
68389>                    Set pbAddToDesignerMenu to True
68390>                End_Object
68391>
68391>                Object oPromptMenuItem is a cCJPromptMenuItem
68393>                    Set pbAddToDesignerMenu to True
68394>                    Set pbControlBeginGroup to True
68395>                End_Object
68396>
68396>                Object oFindMenuItem is a cCJFindMenuItem
68398>                    Set pbAddToDesignerMenu to True
68399>                    Set pbControlBeginGroup to True
68400>                End_Object
68401>
68401>                Object oFindNextMenu is a cCJFindNextMenuItem
68403>                    Set pbAddToDesignerMenu to True
68404>                End_Object
68405>
68405>                Object oFindPreviousMenu is a cCJFindPreviousMenuItem
68407>                    Set pbAddToDesignerMenu to True
68408>                End_Object
68409>
68409>                Object oFindFirstMenu is a cCJFindFirstMenuItem
68411>                    Set pbAddToDesignerMenu to True
68412>                End_Object
68413>
68413>                Object oFindLastMenu is a cCJFindLastMenuItem
68415>                    Set pbAddToDesignerMenu to True
68416>                End_Object
68417>
68417>                Object oSaveMenuItem is a cCJSaveMenuItem
68419>                    Set pbAddToDesignerMenu to True
68420>                    Set pbControlBeginGroup to True
68421>                End_Object
68422>
68422>                Object oDeleteMenuItem is a cCJDeleteMenuItem
68424>                    Set pbAddToDesignerMenu to True
68425>                End_Object
68426>
68426>                Object oExitMenu is a cCJExitMenuItem
68428>                    Set pbControlBeginGroup to True
68429>                End_Object
68430>
68430>            End_Object
68431>
68431>            Object oViewMenu is a cCJMenuItem
68433>                Set peControlType to xtpControlPopup
68434>                Set psCaption to "&View"
68435>                Set psToolTip to "View"
68436>                Set psDescription to "Available Views"
68437>
68437>                Object oPERSONASMenuItem is a cCJMenuItem
68439>                    Set psCaption to "PERSONAS"
68440>                    Set psTooltip to "PERSONAS"
68441>                
68441>                    Procedure OnExecute Variant vCommandBarControl
68444>                        Handle hoClient
68444>                        Get Client_Id to hoClient
68445>                        Send Activate_oPERSONAS of hoClient
68446>                    End_Procedure
68447>                End_Object
68448>            End_Object
68449>            
68449>            Object oReportMenu is a cCJMenuItem
68451>                Set peControlType to xtpControlPopup          
68452>                Set psCaption to "&Report"
68453>                Set psToolTip to "Report"
68454>                Set psDescription to "Available Reports"
68455>            End_Object
68456>
68456>            Object oNavigateMenu is a cCJMenuItem
68458>                Set peControlType to xtpControlPopup      
68459>                Set psCaption to "&Navigate"    
68460>                Set psTooltip to "Navigate"    
68461>                Set psDescription to "Move to different areas of the application"
68462>
68462>                Object oNextAreaMenu is a cCJNextAreaMenu
68464>                End_Object
68465>
68465>                Object oPriorAreaMenu is a cCJPriorAreaMenu
68467>                End_Object
68468>
68468>                Object oNextViewMenu is a cCJNextViewMenu
68470>                End_Object
68471>
68471>                Object oPriorViewMenu is a cCJPriorViewMenu
68473>                End_Object
68474>
68474>                Object oPromptMenu is a cCJPromptMenuItem
68476>                    Set pbControlBeginGroup to True
68477>                End_Object
68478>
68478>                Object oZoomMenu is a cCJZoomMenuItem
68480>                End_Object
68481>
68481>            End_Object
68482>
68482>            Object oWindowMenu is a cCJMDIWindowsMenuItem
68484>                Set peControlType to xtpControlPopup
68485>                Set psCaption to "&Window"
68486>                Set psToolTip to "Window"
68487>                Set psDescription to "Display Current Views and set other display options."    
68488>
68488>                // These are the static windows items. More will be created in onInitPopup 
68488>                Object oDisplayOptionsMenu is a cCJMenuItem
68490>                    Set peControlType to xtpControlPopup          
68491>                    Set psCaption to "&Display Options"
68492>                    Set psToolTip to "Display Options"
68493>                    Set psDescription to "Set display options"
68494>
68494>                    Object oStatusbarMenu is a cCJStatusbarMenuItem
68496>                    End_Object
68497>
68497>                    Object oAutoArrangeIconsMenu is a cCJAutoArrangeIconsMenuItem
68499>                    End_Object
68500>
68500>                    Object oRestoreMenusMenu is a cCJRestoreMenusMenuItem
68502>                        Set pbControlBeginGroup to True
68503>                    End_Object
68504>
68504>                End_Object
68505>
68505>                Object oCascadeMenu is a cCJCascadeMenuItem
68507>                    Set pbControlBeginGroup to True
68508>                End_Object
68509>
68509>                Object oHorizTile is a cCJTileHorizontally
68511>                End_Object
68512>
68512>                Object oVertTile is a cCJTileVertically
68514>                End_Object
68515>
68515>                Object oMinimizeMenuItem is a cCJMinimizeWindowsMenuItem
68517>                    Set pbControlBeginGroup to True
68518>                End_Object
68519>
68519>                Object oRestoreMenuItem is a cCJRestoreWindowsMenuItem
68521>                End_Object
68522>
68522>                Object oArrangeIconsMenuItem is a cCJAutoArrangeIconsMenuItem
68524>                    Set pbControlBeginGroup to True
68525>                End_Object
68526>
68526>            End_Object
68527>
68527>            Object oHelpMenu is a cCJMenuItem
68529>                Set peControlType to xtpControlPopup    
68530>                Set psCaption to "&Help"
68531>                Set psDescription to "Access Information for learning and using this DataFlex application."
68532>                Set psToolTip to "Help"
68533>
68533>                Object oHelpMenuItem is a cCJHelpMenuItem 
68535>                End_Object
68536>
68536>                Object oAboutMenuItem is a cCJAboutMenuItem
68538>                End_Object
68539>
68539>            End_Object
68540>
68540>        End_Object
68541>
68541>        Object oFindToolBar is a cCJToolbar
68543>            Set psTitle to "Finding Toolbar"
68544>
68544>            Object oFindFirstTool is a cCJFindFirstMenuItem
68546>            End_Object
68547>
68547>            Object oFindPreviousTool is a cCJFindPreviousMenuItem
68549>            End_Object
68550>
68550>            Object oFindMenuTool is a cCJFindMenuItem
68552>            End_Object
68553>
68553>            Object oFindNextTool is a cCJFindNextMenuItem
68555>            End_Object
68556>
68556>            Object oFindLastTool is a cCJFindLastMenuItem
68558>            End_Object
68559>
68559>            Object oPromptToolItem is a cCJPromptMenuItem
68561>                Set pbControlBeginGroup to True
68562>            End_Object
68563>
68563>        End_Object
68564>
68564>        Object oFileToolBar is a cCJToolbar
68566>            Set psTitle to "Data Entry Toolbar"
68567>
68567>            Object oClearToolItem is a cCJClearMenuItem
68569>                Set peControlStyle to xtpButtonIconAndCaption
68570>            End_Object
68571>
68571>            Object oClearAllToolItem2 is a cCJClearAllMenuItem
68573>                Set peControlStyle to xtpButtonIconAndCaption
68574>            End_Object
68575>
68575>            Object oSaveToolItem is a cCJSaveMenuItem
68577>                Set peControlStyle to xtpButtonIconAndCaption
68578>                Set pbControlBeginGroup to True
68579>            End_Object
68580>
68580>            Object oDeleteToolItem is a cCJDeleteMenuItem
68582>                Set peControlStyle to xtpButtonIconAndCaption
68583>            End_Object
68584>
68584>        End_Object
68585>
68585>        Object oEditToolBar is a cCJToolbar
68587>            Set psTitle to "Edit Toolbar"
68588>
68588>            Object oCutToolbarItem is a cCJCutMenuItem
68590>            End_Object
68591>
68591>            Object oCopyToolbarItem is a cCJCopyMenuItem
68593>            End_Object
68594>
68594>            Object oPasteToolbarItem is a cCJPasteMenuItem
68596>            End_Object
68597>
68597>            Object oDeleteEditToolbarItem is a cCJDeleteEditMenuItem
68599>                Set pbControlBeginGroup to True
68600>            End_Object
68601>
68601>        End_Object
68602>
68602>        Object oRememberToolbar is a cCJToolbar
68604>            Set psTitle to C_$Remember
68605>
68605>            Object oRememberItems is a cCJMenuItem
68607>
68607>                Set peControlType to xtpControlPopup
68608>                Set peControlStyle to xtpButtonCaption
68609>                Set psCaption to C_$Remember
68610>                
68610>                Object oMenuItem is a cCJRememberFieldMenuItem
68612>                    Set peControlStyle to xtpButtonIconAndCaption
68613>                End_Object
68614>                
68614>                Object oMenuItem is a cCJRememberLastFieldMenuItem
68616>                    Set peControlStyle to xtpButtonIconAndCaption
68617>                End_Object
68618>                
68618>                Object oMenuItem is a cCJUnRememberFieldMenuItem
68620>                    Set peControlStyle to xtpButtonIconAndCaption
68621>                End_Object
68622>                
68622>                Object oMenuItem is a cCJUnRememberFieldAllMenuItem
68624>                    Set peControlStyle to xtpButtonIconAndCaption
68625>                End_Object
68626>
68626>            End_Object
68627>            
68627>        End_Object
68628>        
68628>        Object oStatusBar is a cCJStatusBar
68630>
68630>            Object oStatusPane1 is a cCJStatusBarPane
68632>                Set piID to sbpIDIdlePane
68633>                Set pbStyleStretch to True
68634>            End_Object
68635>
68635>            Object oStatusPane2 is a cCJStatusBarPane
68637>                Set phoViewPane to Self
68638>                Set pbStyleStretch to True
68639>            End_Object
68640>
68640>        End_Object
68641>
68641>    End_Object
68642>
68642>    Object oClientArea is a ClientArea
68644>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\StdAbout.pkg)
68644>>>// This provides a quick and simple way to create an about package for a program.
68644>>>// You need to create a message inside you client area called Activate_About.
68644>>>// Within this message you should send the message DoAbout passing needed
68644>>>// string information.
68644>>>//
68644>>>//       Procedure Activate_About
68644>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
68644>>>//       End_Procedure
68644>>>//    where: sTitle =     Name of application. If none provided, uses caption
68644>>>//                        bar title
68644>>>//           sVersion   = Version Line. If none provided, will be blank
68644>>>//           sCopyRight = Copyright Line. If none provided, will be blank
68644>>>//           sAuthor    = Author name, blank if none provided
68644>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
68644>>>//                        is used.
68644>>>// It is expected that you will place this in your own object package. For
68644>>>// example an order about package may look like this:
68644>>>//
68644>>>//   // OrderAbout.pkg
68644>>>//   Use StdAbout.pkg
68644>>>//   Procedure Activate_About
68644>>>//      String sTitle sCopyright sVersion sAuthor
68644>>>//      Move "My Order Entry System" to sTitle
68644>>>//      Move "Version 2.1" to sVersion
68644>>>//      Move "Copyright xxxx, Super Software Inc." to sCopyright
68644>>>//      Move "John Smith"  to sAuthor
68644>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
68644>>>//   end_procedure
68644>>>//   // end of file.
68644>>>
68644>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\Dfabout.pkg)
68644>>>>>Use LanguageText.pkg
68644>>>>>Use Windows.pkg
68644>>>>>Use DFbitmap.pkg
68644>>>>>Use GlobalFunctionsProcedures.pkg
68644>>>>>Use cTextEdit.pkg
68644>>>>>Use tWinStructs.pkg
68644>>>>>
68644>>>>>Use cli.pkg
68644>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 19.1\Pkg\DFBTRDRV.PKG)
68644>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
68644>>>>>>>// Notice      : This package contains constants and commands, used to call
68644>>>>>>>//               specific functions in the DFBTRDRV.
68644>>>>>>>Use Ui
68644>>>>>>>//
68644>>>>>>>// Driver Indentification
68644>>>>>>>//
68644>>>>>>>
68644>>>>>>>// Driver attributes
68644>>>>>>>//
68644>>>>>>>// Call_Driver functions ID's
68644>>>>>>>//
68644>>>>>>>//
68644>>>>>>>// DFBTRFN_CONVERT_FILE options
68644>>>>>>>//
68644>>>>>>>
68644>>>>>>>//
68644>>>>>>>// DFBTRFN_SET_OWNER options
68644>>>>>>>//
68644>>>>>>>
68644>>>>>>>//
68644>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
68644>>>>>>>//
68644>>>>>>>
68644>>>>>>>
68644>>>>>>>//
68644>>>>>>>// Command to create all vars which may be needed
68644>>>>>>>// in other commands.
68644>>>>>>>//
68644>>>>>>>
68644>>>>>>>
68644>>>>>>>
68644>>>>>>>//
68644>>>>>>>// Command to set the owner of a Btrieve file.
68644>>>>>>>// File must have been opened.
68644>>>>>>>// Filenumber needs to be passed.
68644>>>>>>>// To clear set the owner to "".
68644>>>>>>>// Examples:
68644>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
68644>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
68644>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
68644>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
68644>>>>>>>// To clear:
68644>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
68644>>>>>>>//
68644>>>>>>>
68644>>>>>>>
68644>>>>>>>
68644>>>>>>>//
68644>>>>>>>// Command to parse DFBTR_SET_OWNVER
68644>>>>>>>// options.
68644>>>>>>>//
68644>>>>>>>
68644>>>>>>>
68644>>>>>>>
68644>>>>>>>//
68644>>>>>>>// Command to parse for Callback
68644>>>>>>>//
68644>>>>>>>
68644>>>>>>>
68644>>>>>>>
68644>>>>>>>//
68644>>>>>>>// Command to clear the owner of a Btrieve file.
68644>>>>>>>// File must have been opened.
68644>>>>>>>// Filenumber needs to be passed.
68644>>>>>>>// Examples:
68644>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
68644>>>>>>>//
68644>>>>>>>
68644>>>>>>>
68644>>>>>>>
68644>>>>>>>//
68644>>>>>>>// Command to add a owner name to the internal list of ownernames
68644>>>>>>>// which will be tries when opening files.
68644>>>>>>>//
68644>>>>>>>
68644>>>>>>>
68644>>>>>>>
68644>>>>>>>//
68644>>>>>>>// Command to remove all owners from the internal list of ownernames
68644>>>>>>>//
68644>>>>>>>
68644>>>>>>>
68644>>>>>>>//
68644>>>>>>>// Command to set the owner name to be used when opening the DDF files.
68644>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
68644>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
68644>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
68644>>>>>>>//
68644>>>>>>>
68644>>>>>>>//
68644>>>>>>>// Command to change the transaction type.
68644>>>>>>>// Valid types are:
68644>>>>>>>//     DFBTRTT_NONE
68644>>>>>>>//     DFBTRTT_EXCLUSIVE
68644>>>>>>>//     DFBTRTT_CONCURRENT
68644>>>>>>>//
68644>>>>>>>//
68644>>>>>>>
68644>>>>>>>
68644>>>>>>>
68644>>>>>>>//
68644>>>>>>>// Command to get the current transaction type.
68644>>>>>>>//
68644>>>>>>>
68644>>>>>>>//
68644>>>>>>>// Command to set explicit_locking
68644>>>>>>>//
68644>>>>>>>
68644>>>>>>>//
68644>>>>>>>// Command to get explicit locking
68644>>>>>>>//
68644>>>>>>>
68644>>>>>>>//
68644>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
68644>>>>>>>//
68644>>>>>>>
68644>>>>>>>//
68644>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
68644>>>>>>>//
68644>>>>>>>
68644>>>>>>>// Purpose: An instance of this class can be used as a broker object to
68644>>>>>>>//          call several Dfbtrdrv releated methods.
68644>>>>>>>
68644>>>>>>>Class cDFBtrDrvHandler is an Array
68645>>>>>>>    
68645>>>>>>>    Procedure Construct_Object Integer iImage
68647>>>>>>>        Forward Send Construct_object iImage
68649>>>>>>>        
68649>>>>>>>        Property String  psDriverID "DFBTRDRV"
68650>>>>>>>    End_Procedure
68651>>>>>>>    
68651>>>>>>>    //  The revsion of a Dfbtrdrv Connectivity Kit
68651>>>>>>>    //
68651>>>>>>>    
68651>>>>>>>    Function CKRevision Returns String
68653>>>>>>>        String  sDriverID
68653>>>>>>>        String  sRevision
68653>>>>>>>        String  sVoid
68653>>>>>>>        Integer iRetval
68653>>>>>>>        
68653>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68653>>>>>>>        // This error would otherwise be raised when we have an older
68653>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68653>>>>>>>        Send Ignore_error to Error_object_Id 20491
68654>>>>>>>        Get psDriverID to sDriverID
68655>>>>>>>        Move (Repeat(" ", 255)) to sRevision
68656>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
68661>>>>>>>        Send Trap_Error to Error_object_Id 20491
68662>>>>>>>        If (Trim(sRevision) = "") Begin
68664>>>>>>>            // Unable to get the revision. return all zeroes.
68664>>>>>>>            Move "0.0.0.0" to sRevision
68665>>>>>>>        End
68665>>>>>>>>
68665>>>>>>>        Function_Return sRevision
68666>>>>>>>    End_Function
68667>>>>>>>    
68667>>>>>>>    Function CkUsesUri Returns Integer
68669>>>>>>>        String  sDriverID
68669>>>>>>>        String  sVoid1
68669>>>>>>>        String  sVoid2
68669>>>>>>>        Integer iRetval
68669>>>>>>>        
68669>>>>>>>        Get psDriverID to sDriverID
68670>>>>>>>        
68670>>>>>>>        Move 0 to iRetval
68671>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68671>>>>>>>        // This error would otherwise be raised when we have an older
68671>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
68671>>>>>>>        Send Ignore_error to Error_object_Id 20491
68672>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
68677>>>>>>>        Send Trap_Error to Error_object_Id 20491
68678>>>>>>>        
68678>>>>>>>        Function_Return iRetval
68679>>>>>>>    End_Function
68680>>>>>>>    
68680>>>>>>>    
68680>>>>>>>    
68680>>>>>>>    // Extract the Nth part of a a.b.c.d revsion string.
68680>>>>>>>    //
68680>>>>>>>    // Returns : The part version number or -1 if there is no such part number.
68680>>>>>>>    //
68680>>>>>>>    
68680>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
68682>>>>>>>        Integer iPartRev
68682>>>>>>>        Integer iCurrentPart
68682>>>>>>>        Integer iSeparatorPos
68682>>>>>>>        
68682>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
68685>>>>>>>        
68685>>>>>>>        Move 0 to iCurrentPart
68686>>>>>>>        Repeat
68686>>>>>>>>
68686>>>>>>>            Move (Pos(".", sRevision)) to iSeparatorPos
68687>>>>>>>            If (iSeparatorPos > 0) Begin
68689>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) to iPartRev
68690>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) to sRevision
68691>>>>>>>                Increment iCurrentPart
68692>>>>>>>            End
68692>>>>>>>>
68692>>>>>>>            Else If (sRevision <> "") Begin
68695>>>>>>>                Move sRevision to iPartRev
68696>>>>>>>                Move "" to sRevision
68697>>>>>>>                Increment iCurrentPart
68698>>>>>>>            End
68698>>>>>>>>
68698>>>>>>>            Else ;                Move -1 to iPartRev
68700>>>>>>>        Until (iCurrentPart >= iPartNum or iPartRev = -1)
68702>>>>>>>        
68702>>>>>>>        Function_Return iPartRev
68703>>>>>>>    End_Function
68704>>>>>>>    
68704>>>>>>>    
68704>>>>>>>    
68704>>>>>>>    //
68704>>>>>>>    //  Returns the major revision of the CK
68704>>>>>>>    //
68704>>>>>>>    
68704>>>>>>>    Function CKMajorRevision Returns Integer
68706>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
68707>>>>>>>    End_Function
68708>>>>>>>    
68708>>>>>>>    
68708>>>>>>>    
68708>>>>>>>    //  Returns the minor revision of the CK
68708>>>>>>>    //
68708>>>>>>>    
68708>>>>>>>    Function CKMinorRevision Returns Integer
68710>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
68711>>>>>>>    End_Function
68712>>>>>>>    
68712>>>>>>>    
68712>>>>>>>    //  Returns the release revision of the CK
68712>>>>>>>    //
68712>>>>>>>    
68712>>>>>>>    Function CKReleaseRevision Returns Integer
68714>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
68715>>>>>>>    End_Function
68716>>>>>>>    
68716>>>>>>>    
68716>>>>>>>    //  Returns the major revision of the CK
68716>>>>>>>    //
68716>>>>>>>    
68716>>>>>>>    Function CKBuildRevision Returns Integer
68718>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
68719>>>>>>>    End_Function
68720>>>>>>>    
68720>>>>>>>    
68720>>>>>>>    //  Determines if the CK conforms to a passed minimal revsion.
68720>>>>>>>    //
68720>>>>>>>    
68720>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
68722>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_Return (True)
68725>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
68728>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_Return (True)
68731>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
68734>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_Return (True)
68737>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) and iBuild <= CKBuildRevision(Current_object)) ;                    Function_Return (True)
68741>>>>>>>            End
68741>>>>>>>>
68741>>>>>>>        End
68741>>>>>>>>
68741>>>>>>>        
68741>>>>>>>        Function_Return (False)
68742>>>>>>>    End_Function
68743>>>>>>>    
68743>>>>>>>    //   Functions to query the Pervasive.SQL version:
68743>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
68743>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
68743>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
68743>>>>>>>    //
68743>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
68743>>>>>>>    //   in the following format:
68743>>>>>>>    //       <version>.<revision>.<type>
68743>>>>>>>    //   possible values for <type>:
68743>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
68743>>>>>>>    //         server using Workgroup authentication mode
68743>>>>>>>    //       C for client cache engine
68743>>>>>>>    //       D for DOS workstation
68743>>>>>>>    //       N for client Requester
68743>>>>>>>    //       S for NetWare server
68743>>>>>>>    //       T for 32-bit Windows server engine
68743>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
68743>>>>>>>    //
68743>>>>>>>    //   example:
68743>>>>>>>    //       8.50.T
68743>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
68743>>>>>>>    //   32-bits Windows server.
68743>>>>>>>    //
68743>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
68743>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
68743>>>>>>>    //
68743>>>>>>>    //   If the version information is not available or can not be obtained
68743>>>>>>>    //   the functions will return "0.0.0"
68743>>>>>>>    
68743>>>>>>>    //  Returns the version information of the
68743>>>>>>>    //           Pervasive.SQL Client requester.
68743>>>>>>>    
68743>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
68745>>>>>>>        
68745>>>>>>>        String  sDriverID
68745>>>>>>>        String  sVersion
68745>>>>>>>        String  sVoid
68745>>>>>>>        Integer iRetval
68745>>>>>>>        
68745>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68745>>>>>>>        // This error would otherwise be raised when we have an older
68745>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68745>>>>>>>        Send Ignore_error to Error_object_Id 20491
68746>>>>>>>        Get psDriverID to sDriverID
68747>>>>>>>        Move (Repeat(" ", 255)) to sVersion
68748>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
68753>>>>>>>        Send Trap_Error to Error_object_Id 20491
68754>>>>>>>        If (Trim(sVersion) = "") Begin
68756>>>>>>>            // Unable to get the revision. return all zeroes.
68756>>>>>>>            Move "0.0.0" to sVersion
68757>>>>>>>        End
68757>>>>>>>>
68757>>>>>>>        Function_Return sVersion
68758>>>>>>>    End_Function
68759>>>>>>>    
68759>>>>>>>    //           Pervasive.SQL Engine
68759>>>>>>>    
68759>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
68761>>>>>>>        
68761>>>>>>>        String  sDriverID
68761>>>>>>>        String  sVersion
68761>>>>>>>        String  sVoid
68761>>>>>>>        Integer iRetval
68761>>>>>>>        
68761>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68761>>>>>>>        // This error would otherwise be raised when we have an older
68761>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68761>>>>>>>        Send Ignore_error to Error_object_Id 20491
68762>>>>>>>        Get psDriverID to sDriverID
68763>>>>>>>        Move (Repeat(" ", 255)) to sVersion
68764>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
68769>>>>>>>        Send Trap_Error to Error_object_Id 20491
68770>>>>>>>        If (Trim(sVersion) = "") Begin
68772>>>>>>>            // Unable to get the revision. return all zeroes.
68772>>>>>>>            Move "0.0.0" to sVersion
68773>>>>>>>        End
68773>>>>>>>>
68773>>>>>>>        Function_Return sVersion
68774>>>>>>>    End_Function
68775>>>>>>>    
68775>>>>>>>    //  Returns the version information of the
68775>>>>>>>    //           Pervasive.SQL Server Engine
68775>>>>>>>    
68775>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
68777>>>>>>>        
68777>>>>>>>        String  sDriverID
68777>>>>>>>        String  sVersion
68777>>>>>>>        String  sVoid
68777>>>>>>>        Integer iRetval
68777>>>>>>>        
68777>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
68777>>>>>>>        // This error would otherwise be raised when we have an older
68777>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
68777>>>>>>>        Send Ignore_error to Error_object_Id 20491
68778>>>>>>>        Get psDriverID to sDriverID
68779>>>>>>>        Move (Repeat(" ", 255)) to sVersion
68780>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
68785>>>>>>>        Send Trap_Error to Error_object_Id 20491
68786>>>>>>>        If (Trim(sVersion) = "") Begin
68788>>>>>>>            // Unable to get the revision. return all zeroes.
68788>>>>>>>            Move "0.0.0" to sVersion
68789>>>>>>>        End
68789>>>>>>>>
68789>>>>>>>        Function_Return sVersion
68790>>>>>>>    End_Function
68791>>>>>>>    
68791>>>>>>>End_Class
68792>>>>>>>
68792>>>>>>>
68792>>>>>Use MSSqldrv.pkg
Including file: MSSqldrv.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\MSSqldrv.pkg)
68792>>>>>>>//     Package that declares MS SQL driver constants and functions.
68792>>>>>>>//     This package can be used by developers who want to add Data Access
68792>>>>>>>//     MS SQL Client specific code to a DataFlex application.
68792>>>>>>>
68792>>>>>>>Use Cli.pkg
68792>>>>>>>Use SQL.pkg
68792>>>>>>>
68792>>>>>>>//   Driver Indentification
68792>>>>>>>
68792>>>>>>>//   Error number constants
68792>>>>>>>
68792>>>>>>>
68792>>>>>>>//   Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
68792>>>>>>>
68792>>>>>>>
68792>>>>>>>
68792>>>>>>>
68792>>>>>>>
68792>>>>>>>
68792>>>>>>>// SQL Server spcific types.
68792>>>>>>>Define SQL_SS_TIMESTAMPOFFSET   for   (-155) //SQL server datetimeoffset type */
68792>>>>>>>Define SQL_SS_TIME2             for   (-154) //SQL server time type */
68792>>>>>>>Define SQL_SS_XML               for   (-152) //SQL server xml type */
68792>>>>>>>Define SQL_SS_VARIANT           for   (-150) //SQL server variant type */
68792>>>>>>>
68792>>>>>>>// SQL Server spcific types.
68792>>>>>>>Define SQL_TYPE_TIMESTAMP2      for   (-200) //SQL server datetime2 type */
68792>>>>>>>Define SQL_VARCHARMAX           for   (-201) //SQL server varchar(max) type */
68792>>>>>>>Define SQL_WVARCHARMAX          for   (-202) //SQL server wvarchar(max) type */
68792>>>>>>>Define SQL_VARBINARYMAX         for   (-203) //SQL server varbinary(max) type */
68792>>>>>>>Define SQL_TYPE_MONEY           for   (-204) //SQL server money type */
68792>>>>>>>Define SQL_TYPE_SMALLMONEY      for   (-205) //SQL server smallmoney type */
68792>>>>>>>Define SQL_TYPE_SMALLDATETIME   for   (-206) //SQL server smalldatetype type */
68792>>>>>>>
68792>>>>>>>
68792>>>>>>>//   MSSQL_SetConstraint <FileNum> <ConstraintText>
68792>>>>>>>//
68792>>>>>>>//     Setup a constraint for a file.
68792>>>>>>>
68792>>>>>>>
68792>>>>>>>Class cMSSQLHandler is a cCLIHandler
68793>>>>>>>    
68793>>>>>>>    Procedure Construct_Object
68795>>>>>>>        Forward Send Construct_Object
68797>>>>>>>        
68797>>>>>>>        Set psDriverID to MSSQLDRV_ID
68798>>>>>>>    End_Procedure
68799>>>>>>>    
68799>>>>>>>    
68799>>>>>>>    
68799>>>>>>>    //   Extract the list from the out connect string.
68799>>>>>>>    Function ExtractList String sOutConnStr Integer hoStore Returns Integer
68801>>>>>>>        String  sItem
68801>>>>>>>        Integer iStart
68801>>>>>>>        Integer iEnd
68801>>>>>>>        
68801>>>>>>>        If (hoStore = 0) ;            Move Current_object to hoStore
68804>>>>>>>        
68804>>>>>>>        Send Delete_Data to hoStore
68805>>>>>>>        Move (Pos("{", sOutConnStr)) to iStart
68806>>>>>>>        While (iStart > 0)
68810>>>>>>>            Move (Right(sOutConnStr, Length(sOutConnStr) - iStart)) to sOutConnStr
68811>>>>>>>            If (Left(sOutConnStr, 1) = "}") ;                Move 0 to iStart
68814>>>>>>>            Else Begin
68815>>>>>>>                Move (Pos(",", sOutConnStr)) to iStart
68816>>>>>>>                Move (Pos("}", sOutConnStr)) to iEnd
68817>>>>>>>                If ((iStart = 0) or (iEnd < iStart)) ;                    Move iEnd to iStart
68820>>>>>>>                
68820>>>>>>>                If (iStart > 0) ;                    Set Value of hoStore  (Item_Count(Current_Object)) to (Left(sOutConnStr, iStart - 1))
68823>>>>>>>                
68823>>>>>>>                If (iStart = iEnd) ;                    Move 0 to iStart
68826>>>>>>>            End
68826>>>>>>>>
68826>>>>>>>        Loop
68827>>>>>>>>
68827>>>>>>>        
68827>>>>>>>        Function_Return (Item_Count(hoStore))
68828>>>>>>>    End_Function
68829>>>>>>>    
68829>>>>>>>    
68829>>>>>>>    
68829>>>>>>>    //   Call the driver's browse connect function
68829>>>>>>>    Function BrowseConnect String sInConnStr Returns String
68831>>>>>>>        String  sDriver
68831>>>>>>>        String  sOutConnStr
68831>>>>>>>        Integer iArg
68831>>>>>>>        Integer iRetval
68831>>>>>>>        
68831>>>>>>>        Get psDriverID to sDriver
68832>>>>>>>        If (sDriver <> "") Begin
68834>>>>>>>            Move (Repeat(" ", 8192)) to sOutConnStr
68835>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
68840>>>>>>>        End
68840>>>>>>>>
68840>>>>>>>        
68840>>>>>>>        Function_Return sOutConnStr
68841>>>>>>>    End_Function// BrowseConnect
68842>>>>>>>    
68842>>>>>>>    
68842>>>>>>>    Function BrowseConnectLocal String sInConnStr Returns String
68844>>>>>>>        String  sDriver
68844>>>>>>>        String  sOutConnStr
68844>>>>>>>        Integer iArg
68844>>>>>>>        Integer iRetval
68844>>>>>>>        
68844>>>>>>>        Move 1 to iArg // Browses only local
68845>>>>>>>        
68845>>>>>>>        Get psDriverID to sDriver
68846>>>>>>>        If (sDriver <> "") Begin
68848>>>>>>>            Move (Repeat(" ", 8192)) to sOutConnStr
68849>>>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
68854>>>>>>>        End
68854>>>>>>>>
68854>>>>>>>        
68854>>>>>>>        Function_Return sOutConnStr
68855>>>>>>>    End_Function// BrowseConnect
68856>>>>>>>    
68856>>>>>>>    
68856>>>>>>>    Function EnumerateServersNetworkOrLocal Integer iNetworkLocal  Returns Integer
68858>>>>>>>        
68858>>>>>>>        String  sServerList
68858>>>>>>>        Integer iNumServers
68858>>>>>>>        Integer iDriver
68858>>>>>>>        Integer iClientVersion
68858>>>>>>>        String  sDriver
68858>>>>>>>        
68858>>>>>>>        Get DriverIndex MSSQLDRV_ID to iDriver
68859>>>>>>>        
68859>>>>>>>        If (iDriver) Begin
68861>>>>>>>            
68861>>>>>>>            Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iDriver to iClientVersion
68864>>>>>>>            
68864>>>>>>>            Get SqlServerClientDriverName iClientVersion to sDriver
68865>>>>>>>            
68865>>>>>>>            Move ("DRIVER={" + sDriver + "};") to sDriver
68866>>>>>>>            If (iNetworkLocal = 0) Begin
68868>>>>>>>                Get BrowseConnect sDriver to sServerList
68869>>>>>>>            End
68869>>>>>>>>
68869>>>>>>>            Else Begin
68870>>>>>>>                Get BrowseConnectLocal sDriver to sServerList
68871>>>>>>>            End
68871>>>>>>>>
68871>>>>>>>            Get ExtractList sServerList Current_object to iNumServers
68872>>>>>>>        End
68872>>>>>>>>
68872>>>>>>>        
68872>>>>>>>        Function_Return iNumServers
68873>>>>>>>        
68873>>>>>>>    End_Function
68874>>>>>>>    
68874>>>>>>>    //   Enumerate the available SQL Server database servers
68874>>>>>>>    //   This function will return all SQL Server instances on the network.
68874>>>>>>>    //   This may take a long time.
68874>>>>>>>    //   To enumerate only local SQL Server instances use EnumerateServersLocal
68874>>>>>>>    Function EnumerateServers Returns Integer
68876>>>>>>>        
68876>>>>>>>        Integer iNumServers
68876>>>>>>>        Integer iNetworkLocal
68876>>>>>>>        
68876>>>>>>>        Move 0 to iNetworkLocal // 0 = enumerate network servers
68877>>>>>>>        
68877>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
68878>>>>>>>        
68878>>>>>>>        Function_Return iNumServers
68879>>>>>>>        
68879>>>>>>>    End_Function
68880>>>>>>>    
68880>>>>>>>    
68880>>>>>>>    //   Enumerate the available SQL Server database servers
68880>>>>>>>    //   This function will return only return SQL Server instance on the local machine
68880>>>>>>>    //   To enumerate all SQL Server instances in a network use EnumerateServers
68880>>>>>>>    Function EnumerateServersLocal Returns Integer
68882>>>>>>>        
68882>>>>>>>        Integer iNumServers
68882>>>>>>>        Integer iNetworkLocal
68882>>>>>>>        
68882>>>>>>>        Move 1 to iNetworkLocal // 1 = enumerate local servers
68883>>>>>>>        
68883>>>>>>>        Get EnumerateServersNetworkOrLocal iNetworkLocal to iNumServers
68884>>>>>>>        
68884>>>>>>>        Function_Return iNumServers
68885>>>>>>>        
68885>>>>>>>    End_Function
68886>>>>>>>    
68886>>>>>>>    
68886>>>>>>>    
68886>>>>>>>    //   Enumerate database in a given server.
68886>>>>>>>    Function EnumerateDatabases String sServer String sUser String sPassWord Returns Integer
68888>>>>>>>        Integer hoSQL
68888>>>>>>>        String  sConnect
68888>>>>>>>        String  sDatabase
68888>>>>>>>        Integer hdbc
68888>>>>>>>        Integer hstmt
68888>>>>>>>        Integer iFetchResult
68888>>>>>>>        
68888>>>>>>>        If (Num_Arguments < 3) ;            Move "" to sPassWord
68891>>>>>>>        If (Num_Arguments < 2) ;            Move "" to sUser
68894>>>>>>>        
68894>>>>>>>        If (sUser <> "") ;            Move ("SERVER=" + Trim(sServer) + ";UID=" + Trim(sUser) + ";PWD=" + Trim(sPassword) + ";") to sConnect
68897>>>>>>>        Else ;            Move ("SERVER=" + Trim(sServer) + ";Trusted_Connection=yes") to sConnect
68899>>>>>>>        
68899>>>>>>>        Object oEnumDBSQLmanager is a cSQLHandleManager
68901>>>>>>>            Move Current_Object to hoSQL
68902>>>>>>>        End_Object
68903>>>>>>>        
68903>>>>>>>        If (hoSQL <> 0) Begin
68905>>>>>>>            Get SQLConnect of hoSQL "MSSQLDRV" sConnect to hdbc
68906>>>>>>>            If (hdbc <> 0) Begin
68908>>>>>>>                Get SQLOpen of hdbc to hstmt
68909>>>>>>>                If (hstmt <> 0) Begin
68911>>>>>>>                    //   We could do a direct select on the sysdatabases table but we use
68911>>>>>>>                    //   the stored procedure sp_database instead. SQL Server recommends this
68911>>>>>>>                    //   approach in case meta data might change, the stored procedure will
68911>>>>>>>                    //   stay the same.
68911>>>>>>>                    Send SQLSetProcedureName to hstmt "sp_databases"
68912>>>>>>>                    Send SQLCall to hstmt
68913>>>>>>>                    Repeat
68913>>>>>>>>
68913>>>>>>>                        Get SQLFetch of hstmt to iFetchResult
68914>>>>>>>                        If (iFetchResult <> 0) Begin
68916>>>>>>>                            Get SQLColumnValue of hstmt 1 to sDatabase
68917>>>>>>>                            Set Value  (Item_Count(Current_Object)) to sDatabase
68918>>>>>>>                        End
68918>>>>>>>>
68918>>>>>>>                    Until (iFetchResult = 0)
68920>>>>>>>                    
68920>>>>>>>                    Send SQLClose to hstmt
68921>>>>>>>                End
68921>>>>>>>>
68921>>>>>>>                Send SQLDisconnect to hdbc
68922>>>>>>>            End
68922>>>>>>>>
68922>>>>>>>        End
68922>>>>>>>>
68922>>>>>>>        Send Destroy_Object to hoSQL
68923>>>>>>>        
68923>>>>>>>        Function_Return (Item_Count(Current_Object))
68924>>>>>>>    End_Function
68925>>>>>>>    
68925>>>>>>>    
68925>>>>>>>    Function SqlServerClientVersionName Integer iClientVersion  Returns String
68927>>>>>>>        
68927>>>>>>>        String  sSqlServerClientVersionName
68927>>>>>>>        
68927>>>>>>>        
68927>>>>>>>        Case Begin
68927>>>>>>>            
68927>>>>>>>            Case (iClientVersion = SQLSERVER2017CLIENT)
68929>>>>>>>                Move SQLSERVER2017CLIENTNAME to sSqlServerClientVersionName
68930>>>>>>>                Case Break
68931>>>>>>>                
68931>>>>>>>            Case (iClientVersion = SQLSERVER2016CLIENT)
68934>>>>>>>                Move SQLSERVER2016CLIENTNAME to sSqlServerClientVersionName
68935>>>>>>>                Case Break
68936>>>>>>>            
68936>>>>>>>            Case (iClientVersion = SQLSERVER2014CLIENT)
68939>>>>>>>                Move SQLSERVER2014CLIENTNAME to sSqlServerClientVersionName
68940>>>>>>>                Case Break
68941>>>>>>>            
68941>>>>>>>            Case (iClientVersion = SQLSERVER2012CLIENT)
68944>>>>>>>                Move SQLSERVER2012CLIENTNAME to sSqlServerClientVersionName
68945>>>>>>>                Case Break
68946>>>>>>>            
68946>>>>>>>            Case (iClientVersion = SQLSERVER2008CLIENT)
68949>>>>>>>                Move SQLSERVER2008CLIENTNAME to sSqlServerClientVersionName
68950>>>>>>>                Case Break
68951>>>>>>>            
68951>>>>>>>            Case (iClientVersion = SQLSERVER2005CLIENT)
68954>>>>>>>                Move SQLSERVER2005CLIENTNAME to sSqlServerClientVersionName
68955>>>>>>>                Case Break
68956>>>>>>>            
68956>>>>>>>            Case (iClientVersion = SQLSERVER2000CLIENT)
68959>>>>>>>                Move SQLSERVER2000CLIENTNAME to sSqlServerClientVersionName
68960>>>>>>>                Case Break
68961>>>>>>>            
68961>>>>>>>            Case Else
68961>>>>>>>                Move SQLSERVERUNKNOWNCLIENTNAME to sSqlServerClientVersionName
68962>>>>>>>                
68962>>>>>>>        Case End
68962>>>>>>>        
68962>>>>>>>        
68962>>>>>>>        Function_Return sSqlServerClientVersionName
68963>>>>>>>        
68963>>>>>>>    End_Function
68964>>>>>>>
68964>>>>>>>
68964>>>>>>>    Function SqlServerClientDriverName Integer iClientVersion  Returns String
68966>>>>>>>        
68966>>>>>>>        String  sSqlServerClientDriverName
68966>>>>>>>        
68966>>>>>>>        Case Begin
68966>>>>>>>            
68966>>>>>>>            Case (iClientVersion = SQLSERVER2017CLIENT)
68968>>>>>>>                Move SQLSERVER2017DRVRSTR to sSqlServerClientDriverName
68969>>>>>>>                Case Break
68970>>>>>>>                
68970>>>>>>>            Case (iClientVersion = SQLSERVER2016CLIENT)
68973>>>>>>>                Move SQLSERVER2016DRVRSTR to sSqlServerClientDriverName
68974>>>>>>>                Case Break
68975>>>>>>>            
68975>>>>>>>            Case (iClientVersion = SQLSERVER2014CLIENT)
68978>>>>>>>                Move SQLSERVER2014DRVRSTR to sSqlServerClientDriverName
68979>>>>>>>                Case Break
68980>>>>>>>            
68980>>>>>>>            Case (iClientVersion = SQLSERVER2012CLIENT)
68983>>>>>>>                Move SQLSERVER2012DRVRSTR to sSqlServerClientDriverName
68984>>>>>>>                Case Break
68985>>>>>>>            
68985>>>>>>>            Case (iClientVersion = SQLSERVER2008CLIENT)
68988>>>>>>>                Move SQLSERVER2008DRVRSTR to sSqlServerClientDriverName
68989>>>>>>>                Case Break
68990>>>>>>>            
68990>>>>>>>            Case (iClientVersion = SQLSERVER2005CLIENT)
68993>>>>>>>                Move SQLSERVER2005DRVRSTR to sSqlServerClientDriverName
68994>>>>>>>                Case Break
68995>>>>>>>            
68995>>>>>>>            Case (iClientVersion = SQLSERVER2000CLIENT)
68998>>>>>>>                Move SQLSERVER2000DRVRSTR to sSqlServerClientDriverName
68999>>>>>>>                Case Break
69000>>>>>>>            
69000>>>>>>>            Case Else
69000>>>>>>>                Move SQLSERVER2000DRVRSTR to sSqlServerClientDriverName
69001>>>>>>>                
69001>>>>>>>        Case End
69001>>>>>>>        
69001>>>>>>>        
69001>>>>>>>        Function_Return sSqlServerClientDriverName
69002>>>>>>>        
69002>>>>>>>    End_Function
69003>>>>>>>    
69003>>>>>>>    
69003>>>>>>>End_Class
69004>>>>>>>
69004>>>>>>>
69004>>>>>
69004>>>>>
69004>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
69005>>>>>
69005>>>>>Register_Function phoWorkspace Returns Handle
69005>>>>>Register_Function Help_filename Returns String
69005>>>>>Register_Function GetHelpFile Returns String
69005>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
69005>>>>>
69005>>>>>//    This function reads the current username Of windows and returns that
69005>>>>>//    name or an text unknown user
69005>>>>>Function Network_User_Name for cDesktop Returns String
69007>>>>>    String sName
69007>>>>>    Integer iRetval iLength
69007>>>>>    
69007>>>>>    Move 0 to iLength
69008>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
69009>>>>>    Move (ZeroString(iLength)) to sName
69010>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
69011>>>>>    
69011>>>>>    If (iRetval = NO_ERROR) Begin
69013>>>>>        Function_Return (CString (sName))
69014>>>>>    End
69014>>>>>>
69014>>>>>    
69014>>>>>    Function_Return "User Unknown"
69015>>>>>End_Function
69016>>>>>
69016>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
69017>>>>>
69017>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
69018>>>>>
69018>>>>>Class SysinfoDisplay is a cTextEdit
69019>>>>>    Procedure Construct_Object
69021>>>>>        Forward Send Construct_Object
69023>>>>>        
69023>>>>>        Set Location to 6 6
69024>>>>>        Set Size to 110 255
69025>>>>>        Set Read_Only_State to True
69026>>>>>        Set pbWrap to False
69027>>>>>    End_Procedure
69028>>>>>    
69028>>>>>    //    This method will show the name Of the current directory in the system
69028>>>>>    //    information box
69028>>>>>    Procedure Show_Current_Directory
69030>>>>>        String sDir
69030>>>>>        
69030>>>>>        Get_Current_Directory to sDir
69031>>>>>        
69031>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
69032>>>>>    End_Procedure
69033>>>>>    
69033>>>>>    Procedure Show_Windows_Directory
69035>>>>>        String sWindir
69035>>>>>        
69035>>>>>        Get_Windows_Directory to sWindir
69036>>>>>        
69036>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
69037>>>>>    End_Procedure
69038>>>>>    
69038>>>>>    Procedure Show_Current_User
69040>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
69041>>>>>    End_Procedure
69042>>>>>    
69042>>>>>    Procedure Show_Number_Format
69044>>>>>        Integer iFormat
69044>>>>>        String sFormatText
69044>>>>>        
69044>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
69047>>>>>        Move (Character (iFormat)) to sFormatText
69048>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
69049>>>>>        
69049>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
69052>>>>>        Move (Character (iFormat)) to sFormatText
69053>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
69054>>>>>    End_Procedure
69055>>>>>    
69055>>>>>    Procedure Show_Filelist_Name
69057>>>>>        String sFilename
69057>>>>>        
69057>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
69060>>>>>        
69060>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
69061>>>>>        Send AppendTextLn ""
69062>>>>>    End_Procedure
69063>>>>>    
69063>>>>>    Procedure Show_Lock_Delay
69065>>>>>        Integer iLockdelay
69065>>>>>        
69065>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
69068>>>>>        
69068>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
69069>>>>>    End_Procedure
69070>>>>>    
69070>>>>>    Procedure Show_Lock_Timeout
69072>>>>>        Integer iLockTimeout
69072>>>>>        
69072>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
69075>>>>>        
69075>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
69076>>>>>    End_Procedure
69077>>>>>    
69077>>>>>    Procedure Show_Screen_Size
69079>>>>>        Integer iYscreensize iXscreensize
69079>>>>>        
69079>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) to iXscreensize
69080>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) to iYscreensize
69081>>>>>        
69081>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
69082>>>>>    End_Procedure
69083>>>>>    
69083>>>>>    Procedure Show_Page_Size
69085>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
69086>>>>>    End_Procedure
69087>>>>>    
69087>>>>>    Procedure Show_Date
69089>>>>>        Date dToday
69089>>>>>        
69089>>>>>        Move (CurrentDateTime()) to  dToday
69090>>>>>        
69090>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
69091>>>>>    End_Procedure
69092>>>>>    
69092>>>>>    Procedure Show_Date_Format
69094>>>>>        Integer iDateFormat
69094>>>>>        String sDateFormat
69094>>>>>        
69094>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
69097>>>>>        Case Begin
69097>>>>>            Case (iDateFormat = DF_DATE_USA)
69099>>>>>                Move C_$USA to sDateFormat
69100>>>>>                Case Break
69101>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
69104>>>>>                Move C_$European to sDateFormat
69105>>>>>                Case Break
69106>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
69109>>>>>                Move C_$Military to sDateFormat
69110>>>>>                Case Break
69111>>>>>            Case Else
69111>>>>>                Move C_$UnknownDateType to sDateFormat
69112>>>>>                Case Break
69113>>>>>        Case End
69113>>>>>        
69113>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
69114>>>>>    End_Procedure
69115>>>>>    
69115>>>>>    Procedure Show_Systemresources
69117>>>>>        tWinMemoryStatusEx MemoryStatusInfo
69117>>>>>        tWinMemoryStatusEx MemoryStatusInfo
69117>>>>>        Integer iRetval
69117>>>>>        
69117>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
69118>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
69119>>>>>        If (iRetval = 0) Begin
69121>>>>>            Move (ShowLastError ()) to iRetval
69122>>>>>        End
69122>>>>>>
69122>>>>>        
69122>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
69123>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
69124>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Integer ( Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0)))
69125>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Integer ( Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0)))
69126>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Integer ( Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0)))
69127>>>>>    End_Procedure
69128>>>>>    
69128>>>>>    Procedure Show_Registration
69130>>>>>        String sRegName
69130>>>>>        Integer iSN iMaxUsers
69130>>>>>        
69130>>>>>        Registration sRegName iSN
69131>>>>>>
69131>>>>>        
69131>>>>>        Get_Licensed_Max_Users to iMaxUsers
69132>>>>>        
69132>>>>>        Send AppendTextLn ""
69133>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
69134>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
69135>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
69136>>>>>    End_Procedure
69137>>>>>    
69137>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
69137>>>>>    // To the workspace object passing the an object and message To send back
69137>>>>>    // To this object. It is expected that the workspace object will send this
69137>>>>>    // message for every line Of information it wants displayed (passing the
69137>>>>>    // information To be displayed
69137>>>>>    Register_Procedure EnumerateWorkspaceData Handle hObjId Handle hmMessId
69137>>>>>    
69137>>>>>    Procedure Show_ServicePack
69139>>>>>        String sKey sVersionDescription sVersion
69139>>>>>        Handle hoRegistry
69139>>>>>        Boolean bExists bOpened
69139>>>>>        
69139>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
69140>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
69141>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
69142>>>>>        
69142>>>>>        Move C_DFVersionRegistryRoot to sKey
69143>>>>>        Get KeyExists of hoRegistry sKey to bExists
69144>>>>>        If (bExists) Begin
69146>>>>>            Get OpenKey of hoRegistry sKey to bOpened
69147>>>>>            If (bOpened) Begin
69149>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
69150>>>>>                If (bExists) Begin
69152>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
69153>>>>>                End
69153>>>>>>
69153>>>>>                
69153>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
69154>>>>>                If (bExists) Begin
69156>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
69157>>>>>                End
69157>>>>>>
69157>>>>>                Send CloseKey of hoRegistry
69158>>>>>            End
69158>>>>>>
69158>>>>>        End
69158>>>>>>
69158>>>>>        Send Destroy of hoRegistry
69159>>>>>        
69159>>>>>        If (sVersionDescription <> "") Begin
69161>>>>>            Send AppendTextLn (sVersionDescription * "-" * sVersion)
69162>>>>>            Send AppendTextLn ""
69163>>>>>        End
69163>>>>>>
69163>>>>>    End_Procedure
69164>>>>>    
69164>>>>>    
69164>>>>>    Procedure Show_WorkspaceInformation
69166>>>>>        Integer hoWorkspace
69166>>>>>        
69166>>>>>        If (ghoApplication <> 0) Begin
69168>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
69169>>>>>            If (hoWorkspace <> 0) Begin
69171>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
69172>>>>>                Send AppendTextLn ""
69173>>>>>            End
69173>>>>>>
69173>>>>>        End
69173>>>>>>
69173>>>>>    End_Procedure
69174>>>>>    
69174>>>>>    // If connection ids are used, we will send the message EnumerateConnections
69174>>>>>    // to the connection manager object passing the an object and message to send
69174>>>>>    // back to this object. It is expected that the connection manager object will
69174>>>>>    // send this message for every line Of information it wants displayed (passing
69174>>>>>    // the information To be displayed
69174>>>>>    Register_Procedure EnumerateConnections Integer hObjId Integer hmMessId
69174>>>>>    
69174>>>>>    Procedure Show_ConnectionIdInformation
69176>>>>>        If (ghoConnection > 0) Begin
69178>>>>>            Send AppendTextLn ""
69179>>>>>            Send EnumerateConnections of ghoConnection Self (RefProc(AppendTextLn))
69180>>>>>        End
69180>>>>>>
69180>>>>>    End_Procedure
69181>>>>>    
69181>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
69183>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
69184>>>>>    End_Function
69185>>>>>    
69185>>>>>    Procedure Show_Versions
69187>>>>>        Integer iVersion iRevision iBuild
69187>>>>>        
69187>>>>>        Version_Information iVersion iRevision iBuild
69189>>>>>        
69189>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
69190>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
69191>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
69192>>>>>    End_Procedure
69193>>>>>    
69193>>>>>    Function CKRevisionNumber String sDriverID Returns String
69195>>>>>        Handle hoCLIHandler
69195>>>>>        Handle hoDFBtrDrvHandler
69195>>>>>        String sCKRevision
69195>>>>>        
69195>>>>>        
69195>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
69197>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
69198>>>>>            Set psDriverID of hoCLIHandler to sDriverID
69199>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
69200>>>>>            Send Destroy of hoCLIHandler
69201>>>>>        End
69201>>>>>>
69201>>>>>        Else Begin
69202>>>>>            If (sDriverID = "DFBTRDRV") Begin
69204>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
69205>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
69206>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
69207>>>>>                Send Destroy of hoDFBtrDrvHandler
69208>>>>>            End
69208>>>>>>
69208>>>>>        End
69208>>>>>>
69208>>>>>        
69208>>>>>        Function_Return sCKRevision
69209>>>>>    End_Function
69210>>>>>    
69210>>>>>    
69210>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
69212>>>>>        
69212>>>>>        If (sDriverID = "DATAFLEX") Begin
69214>>>>>            Function_Return False
69215>>>>>        End
69215>>>>>>
69215>>>>>        
69215>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
69216>>>>>    End_Function
69217>>>>>    
69217>>>>>    
69217>>>>>    Procedure Show_Drivers
69219>>>>>        String sCurrentDriver sRevNumber
69219>>>>>        String sLoadedDrivers sClientDriver
69219>>>>>        Integer iNumberOfDrivers iCount iClientVersion iMSSQLIndex
69219>>>>>        Boolean bOK
69219>>>>>        Handle hoMsqlDrv
69219>>>>>        
69219>>>>>        Move "" to sLoadedDrivers
69220>>>>>        Get_Attribute DF_NUMBER_DRIVERS to iNumberOfDrivers
69223>>>>>        For iCount from 1 to iNumberOfDrivers
69229>>>>>>
69229>>>>>            Get_Attribute DF_DRIVER_NAME of iCount to sCurrentDriver
69232>>>>>            If (sLoadedDrivers <> "") Begin
69234>>>>>                Move (Append (sLoadedDrivers, ", ")) to sLoadedDrivers
69235>>>>>            End
69235>>>>>>
69235>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
69236>>>>>            If (bOK) Begin
69238>>>>>                If (sCurrentDriver = "MSSQLDRV") Begin
69240>>>>>                    Move iCount to iMSSQLIndex
69241>>>>>                End
69241>>>>>>
69241>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
69242>>>>>                // if mssqldrv, show the client number
69242>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
69243>>>>>            End
69243>>>>>>
69243>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) to sLoadedDrivers
69244>>>>>        Loop
69245>>>>>>
69245>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
69246>>>>>        If (iMSSQLIndex>0) Begin
69248>>>>>            Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iMSSQLIndex to iClientVersion
69251>>>>>            Get Create (RefClass(cMSSQLHandler)) to hoMsqlDrv
69252>>>>>            Get SqlServerClientVersionName of hoMsqlDrv iClientVersion to sClientDriver
69253>>>>>            Send Destroy of hoMsqlDrv
69254>>>>>            Send AppendTextLn (SFormat("MSSQLDRV Client Version: %1", sClientDriver))
69255>>>>>        End
69255>>>>>>
69255>>>>>    End_Procedure
69256>>>>>    
69256>>>>>    Procedure Show_HelpFile
69258>>>>>        String sHelpFile
69258>>>>>        Integer eHelpType
69258>>>>>        
69258>>>>>        If (ghoApplication <> 0) Begin
69260>>>>>            Get peHelpType of ghoApplication to eHelpType
69261>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
69263>>>>>                Get GetHelpFile of ghoHtmlHelp to sHelpFile
69264>>>>>            End
69264>>>>>>
69264>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
69267>>>>>                Get Help_filename of Help_object_id to sHelpFile
69268>>>>>            End
69268>>>>>>
69268>>>>>            Else Begin
69269>>>>>                Move C_$ThereIsNoHelpfileDefined to sHelpFile
69270>>>>>            End
69270>>>>>>
69270>>>>>            
69270>>>>>            Send AppendTextLn ""
69271>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
69272>>>>>        End
69272>>>>>>
69272>>>>>    End_Procedure
69273>>>>>    
69273>>>>>    Procedure Show_EnterAsTab
69275>>>>>        Boolean bEnterKeyAsTabKey
69275>>>>>        String sText
69275>>>>>        
69275>>>>>        If (ghoApplication <> 0) Begin
69277>>>>>            Get pbEnterKeyAsTabKey of ghoApplication to bEnterKeyAsTabKey
69278>>>>>            If (bEnterKeyAsTabKey) Begin
69280>>>>>                Move "True" to sText
69281>>>>>            End
69281>>>>>>
69281>>>>>            Else Begin
69282>>>>>                Move "False" to sText
69283>>>>>            End
69283>>>>>>
69283>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
69284>>>>>        End
69284>>>>>>
69284>>>>>    End_Procedure
69285>>>>>    
69285>>>>>    //    During activation we will remove the old information and add the newly
69285>>>>>    //    found systeminformation
69285>>>>>    Procedure Add_Focus Integer hoRoot
69287>>>>>        Forward Send Add_Focus hoRoot
69289>>>>>        
69289>>>>>        Send Delete_Data
69290>>>>>        
69290>>>>>        Set Changed_State to False
69291>>>>>        Set Read_Only_State to True
69292>>>>>        
69292>>>>>        Send Show_ServicePack
69293>>>>>        Send Show_Versions
69294>>>>>        Send Show_Drivers
69295>>>>>        If (ghoConnection <> 0) Begin
69297>>>>>            Send Show_ConnectionIdInformation
69298>>>>>        End
69298>>>>>>
69298>>>>>        Send Show_HelpFile
69299>>>>>        Send Show_Current_Directory
69300>>>>>        Send Show_Filelist_Name
69301>>>>>        If (ghoApplication <> 0) Begin
69303>>>>>            Send Show_WorkSpaceInformation // added To show WS info
69304>>>>>        End
69304>>>>>>
69304>>>>>        Send Show_Current_User
69305>>>>>        Send Show_Windows_Directory
69306>>>>>        Send Show_Screen_Size
69307>>>>>        Send Show_Page_Size
69308>>>>>        Send Show_EnterAsTab
69309>>>>>        Send Show_Number_Format
69310>>>>>        Send Show_Date_Format
69311>>>>>        Send Show_Lock_Delay
69312>>>>>        Send Show_Lock_Timeout
69313>>>>>        Send Show_Date
69314>>>>>        Send Show_Systemresources
69315>>>>>        Send Show_Registration
69316>>>>>        Send Beginning_of_Data
69317>>>>>        
69317>>>>>        Set Icon to 'default.ico'
69318>>>>>    End_Procedure
69319>>>>>End_Class
69320>>>>>
69320>>>>>Class SysInfoDialog is a ModalPanel
69321>>>>>    Procedure Construct_Object
69323>>>>>        Forward Send Construct_Object
69325>>>>>        
69325>>>>>        Set Label to C_$SystemInformation
69326>>>>>        Set Size to 140 267
69327>>>>>        Set piMinSize to 140 267
69328>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
69329>>>>>        Set Border_Style to Border_Thick
69330>>>>>        
69330>>>>>        Object oSysinfoDisplay is a SysInfoDisplay
69332>>>>>            Set peAnchors to anAll
69333>>>>>        End_Object
69334>>>>>        
69334>>>>>        Object oCloseButton is a Button
69336>>>>>            Set Label to C_$Close
69337>>>>>            Set Location to 120 210
69338>>>>>            Set Message 0 to (Refproc (Close_Panel))
69339>>>>>            Set Default_State to True
69340>>>>>            Set peAnchors to anBottomRight
69341>>>>>        End_Object
69342>>>>>        
69342>>>>>        On_Key kCancel Send Close_Panel
69343>>>>>    End_Procedure
69344>>>>>End_Class
69345>>>>>
69345>>>>>Class AboutDialog is a ModalPanel
69346>>>>>    Procedure Construct_Object
69348>>>>>        String sVdfRootDir
69348>>>>>        
69348>>>>>        Forward Send Construct_Object
69350>>>>>        
69350>>>>>        Set Label to C_$About
69351>>>>>        Set Size to 89 212
69352>>>>>        Set Locate_Mode to CENTER_ON_SCREEN
69353>>>>>        
69353>>>>>        Object oSysInfoDialog is a SysInfoDialog
69355>>>>>        End_Object
69356>>>>>        
69356>>>>>        Object oBox is a Container3d
69358>>>>>            Set Border_Style to Border_StaticEdge
69359>>>>>            Set Size to 63 202
69360>>>>>            Set Location to 4 5
69361>>>>>            
69361>>>>>            Object oAboutGraphic is a BitmapContainer
69363>>>>>                Set Border_Style to Border_None
69364>>>>>                Set Bitmap_Style to Bitmap_Center
69365>>>>>                Set Size to 48 48
69366>>>>>                Set Location to 7 2
69367>>>>>            End_Object
69368>>>>>            
69368>>>>>            Object oProductName is a TextBox
69370>>>>>                Set Label to C_$ProductName
69371>>>>>                Set Size to 10 45
69372>>>>>                Set Location to 8 53
69373>>>>>            End_Object
69374>>>>>            
69374>>>>>            Object oVersion is a TextBox
69376>>>>>                Set Label to C_$Version
69377>>>>>                Set Size to 10 25
69378>>>>>                Set Location to 21 53
69379>>>>>            End_Object
69380>>>>>            
69380>>>>>            Object oCopyright is a TextBox
69382>>>>>                Set Label to C_$Copyright
69383>>>>>                Set Size to 10 31
69384>>>>>                Set Location to 34 53
69385>>>>>            End_Object
69386>>>>>            
69386>>>>>            Object oAuthor is a TextBox
69388>>>>>                Set Label to C_$Author
69389>>>>>                Set Size to 10 22
69390>>>>>                Set Location to 46 53
69391>>>>>            End_Object
69392>>>>>        End_Object
69393>>>>>        
69393>>>>>        Object oOKButton is a Button
69395>>>>>            On_Item C_$OK Send Close_Panel
69396>>>>>            Set Size to 14 50
69397>>>>>            Set Location to 71 157
69398>>>>>        End_Object
69399>>>>>        
69399>>>>>        Object oSysInfoButton is a Button
69401>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
69402>>>>>            Set Size to 14 50
69403>>>>>            Set Location to 71 101
69404>>>>>        End_Object
69405>>>>>        
69405>>>>>        On_Key Kcancel Send KeyAction of oOKButton
69406>>>>>        
69406>>>>>        Set Logo to "DacAbout.bmp"  // square bitmaps Of 42x42 work best
69407>>>>>    End_Procedure
69408>>>>>    
69408>>>>>    Procedure Set ProductName String sProductName
69410>>>>>        Set Label of oProductName to sProductName
69411>>>>>    End_Procedure
69412>>>>>    
69412>>>>>    Procedure Set Version String sVersion
69414>>>>>        Set Label of oVersion to sVersion
69415>>>>>    End_Procedure
69416>>>>>    
69416>>>>>    Procedure Set Copyright String sCopyright
69418>>>>>        Set Label of oCopyright to sCopyright
69419>>>>>    End_Procedure
69420>>>>>    
69420>>>>>    Procedure Set Author String sAuthor
69422>>>>>        Set Label of oAuthor to sAuthor
69423>>>>>    End_Procedure
69424>>>>>    
69424>>>>>    Procedure Set Logo String sLogo
69426>>>>>        // square bitmaps Of 42x42 work best
69426>>>>>        Set Bitmap of oAboutGraphic to sLogo
69427>>>>>    End_Procedure
69428>>>>>    
69428>>>>>    Procedure Show_Sysinfo
69430>>>>>        Send Popup_Modal of oSysinfoDialog
69431>>>>>    End_Procedure
69432>>>>>    
69432>>>>>    Procedure End_Construct_Object
69434>>>>>        Handle hoVersionInfo
69434>>>>>        Boolean bIncluded
69434>>>>>        Integer iMajor iMinor iRelease iBuild
69434>>>>>        String sLabel
69434>>>>>        
69434>>>>>        Get Label of oVersion to sLabel
69435>>>>>        If (sLabel = C_$VERSION) Begin
69437>>>>>            // set it To the version info Of the program, if available
69437>>>>>            If (ghoApplication <> 0) Begin
69439>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
69440>>>>>                If (hoVersionInfo <> 0) Begin
69442>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
69443>>>>>                    If (bIncluded) Begin
69445>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
69446>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
69447>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
69448>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
69449>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
69450>>>>>                        Set Version to sLabel
69451>>>>>                    End
69451>>>>>>
69451>>>>>                End
69451>>>>>>
69451>>>>>            End
69451>>>>>>
69451>>>>>        End
69451>>>>>>
69451>>>>>        
69451>>>>>        Forward Send End_Construct_Object
69453>>>>>    End_Procedure
69454>>>>>End_Class
69455>>>
69455>>>//  This is the default message. It is expected that you will
69455>>>//  create your own message to override this
69455>>>Procedure Activate_About
69458>>>    Send DoAbout "" "" "" "" ""
69459>>>End_Procedure
69460>>>
69460>>>//  It is expected that you will send this message (most
69460>>>//  likely from Activate_About. This creates an about object, activates it
69460>>>//  and destroys it when done. It is not exepected that you will augment this.
69460>>>Procedure DoAbout String sTitle String sVersion String sCopyRight String sAuthor String sBitmap
69463>>>    Integer hoObj hoMain
69463>>>    
69463>>>    // create object
69463>>>    Object About is an AboutDialog
69465>>>        // if no title passed use the label of the main panel
69465>>>        // (if a main panel exists).
69465>>>        If (sTitle = "") Begin
69467>>>            Get Main_Window of desktop to hoMain
69468>>>            If hoMain ;                Get Label of hoMain to sTitle
69471>>>        End
69471>>>>
69471>>>        Set productname to sTitle
69472>>>        Set version     to sVersion
69473>>>        Set copyright   to sCopyRight
69474>>>        Set author      to sAuthor
69475>>>        If (sBitmap <> '') ;            Set logo to sBitMap // square bitmaps of 42x42 work best
69478>>>        Move Self to hoObj // object Id
69479>>>    End_Object
69480>>>    Send Popup   of hoObj    // popup the about object
69481>>>    Send Destroy of hoObj // when done, it will be destroyed
69482>>>End_Procedure
69483>>>
69483>        Use PERSONAS.vw
Including file: PERSONAS.vw    (C:\DataFlex Projects\LearnTheLanguage\AppSrc\PERSONAS.vw)
69483>>>Use Windows.pkg
69483>>>Use DFClient.pkg
69483>>>Use PERSONAS.dd
Including file: PERSONAS.dd    (C:\DataFlex Projects\LearnTheLanguage\DDSrc\PERSONAS.dd)
69483>>>>>Use Datadict.pkg
69483>>>>>
69483>>>>>Open PERSONAS
Including file: PERSONAS.fd    (C:\DataFlex Projects\LearnTheLanguage\DDSrc\PERSONAS.fd)
69485>>>>>
69485>>>>>Object SEXO is a DescriptionValidationTable
69487>>>>>    Procedure Fill_List
69490>>>>>        Forward Send Fill_List
69492>>>>>        Send Add_Table_Value "M" "Masculino"
69493>>>>>        Send Add_Table_Value "F" "Femenino"
69494>>>>>    End_Procedure
69495>>>>>End_Object
69496>>>>>
69496>>>>>Register_Object PERSONAS_sl
69496>>>>>
69496>>>>>Class cPERSONAS_DD is a DataDictionary
69497>>>>>        
69497>>>>>    Function fNombreCompleto Global String sClave Returns String 
69499>>>>>    
69499>>>>>        String sNCompleto
69499>>>>>    
69499>>>>>        Move '' to sNCompleto
69500>>>>>        
69500>>>>>        Clear PERSONAS
69501>>>>>        Move sClave to PERSONAS.CLAVE
69502>>>>>        Find eq PERSONAS by Index.1
69503>>>>>>
69503>>>>>        If (Found and sClave eq PERSONAS.CLAVE) Begin
69505>>>>>            Append sNCompleto (Trim(PERSONAS.PRIMER_NOMBRE)) ' ' (Trim(PERSONAS.SEGUNDO_NOMBRE)) ' ' (Trim(PERSONAS.PRIMER_APELLIDO)) ' ' (Trim(PERSONAS.SEGUNDO_APELLIDO))
69512>>>>>            If PERSONAS.APELLIDO_CASADA ne '' Begin
69514>>>>>                Append sNCompleto ' de ' (Trim(PERSONAS.APELLIDO_CASADA))
69516>>>>>            End
69516>>>>>>
69516>>>>>            
69516>>>>>        End
69516>>>>>>
69516>>>>>    
69516>>>>>        Function_Return sNCompleto
69517>>>>>    
69517>>>>>    End_Function    
69518>>>>>    
69518>>>>>    Procedure Construct_Object
69520>>>>>        Forward Send Construct_Object
69522>>>>>        Set Main_File to PERSONAS.File_Number
69523>>>>>
69523>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
69524>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
69525>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
69526>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
69527>>>>>
69527>>>>>        Set Field_Option Field PERSONAS.CLAVE DD_AUTOFIND to True
69528>>>>>        Set Field_Class_Name Field PERSONAS.CLAVE to "Combo"
69529>>>>>        Set Field_Prompt_Object Field PERSONAS.CLAVE to PERSONAS_sl
69530>>>>>
69530>>>>>        Set Field_Option Field PERSONAS.PRIMER_NOMBRE DD_CAPSLOCK to True
69531>>>>>
69531>>>>>        Set Field_Option Field PERSONAS.SEGUNDO_NOMBRE DD_CAPSLOCK to True
69532>>>>>
69532>>>>>        Set Field_Option Field PERSONAS.PRIMER_APELLIDO DD_CAPSLOCK to True
69533>>>>>
69533>>>>>        Set Field_Option Field PERSONAS.SEGUNDO_APELLIDO DD_CAPSLOCK to True
69534>>>>>
69534>>>>>        Set Field_Option Field PERSONAS.APELLIDO_CASADA DD_CAPSLOCK to True
69535>>>>>
69535>>>>>        Set Status_Help Field PERSONAS.FECHA_NACIMIENTO to "Ingrese fecha de Nacimiento (dd/mm/aa)"
69536>>>>>
69536>>>>>        Set Field_Value_Table Field PERSONAS.SEXO to SEXO
69537>>>>>        Set Field_Class_Name Field PERSONAS.SEXO to "Combo"
69538>>>>>
69538>>>>>    End_Procedure
69539>>>>>
69539>>>>>End_Class
69540>>>>>
69540>>>>>Use PERSONAS.sl
Including file: PERSONAS.sl    (C:\DataFlex Projects\LearnTheLanguage\AppSrc\PERSONAS.sl)
69540>>>>>>>// PERSONAS.sl
69540>>>>>>>// PERSONAS Lookup List
69540>>>>>>>
69540>>>>>>>Use DFClient.pkg
69540>>>>>>>Use cDbCJGridPromptList.pkg
69540>>>>>>>Use cDbCJGridColumn.pkg
69540>>>>>>>Use Windows.pkg
69540>>>>>>>
69540>>>>>>>Use PERSONAS.dd
69540>>>>>>>
69540>>>>>>>CD_Popup_Object PERSONAS_sl is a dbModalPanel
69558>>>>>>>>
69558>>>>>>>    Set Location to 5 5
69559>>>>>>>    Set Size to 134 392
69560>>>>>>>    Set Label To "PERSONAS Lookup List"
69561>>>>>>>    Set Border_Style to Border_Thick
69562>>>>>>>    Set Minimize_Icon to False
69563>>>>>>>
69563>>>>>>>
69563>>>>>>>    Object oPERSONAS_DD is a cPERSONAS_DD
69565>>>>>>>    End_Object 
69566>>>>>>>
69566>>>>>>>    Set Main_DD To oPERSONAS_DD
69567>>>>>>>    Set Server  To oPERSONAS_DD
69568>>>>>>>
69568>>>>>>>
69568>>>>>>>
69568>>>>>>>    Object oSelList is a cDbCJGridPromptList
69570>>>>>>>        Set Size to 105 600
69571>>>>>>>        Set Location to 5 5
69572>>>>>>>        Set peAnchors to anNone
69573>>>>>>>        Set psLayoutSection to "PERSONAS_sl_oSelList"
69574>>>>>>>        Set Ordering to 1
69575>>>>>>>        Set pbAutoServer to True
69576>>>>>>>
69576>>>>>>>        Object oPERSONAS_Recnum is a cDbCJGridColumn
69578>>>>>>>            Entry_Item PERSONAS.Recnum
69579>>>>>>>            Set piWidth to 50
69580>>>>>>>            Set psCaption to "Recnum"
69581>>>>>>>        End_Object
69582>>>>>>>
69582>>>>>>>        Object oPERSONAS_CLAVE is a cDbCJGridColumn
69584>>>>>>>            Entry_Item PERSONAS.CLAVE
69585>>>>>>>            Set piWidth to 70
69586>>>>>>>            Set psCaption to "Clave"
69587>>>>>>>        End_Object 
69588>>>>>>>
69588>>>>>>>        Object oPERSONAS_PRIMER_NOMBRE is a cDbCJGridColumn
69590>>>>>>>            Entry_Item PERSONAS.PRIMER_NOMBRE
69591>>>>>>>            Set piWidth to 99
69592>>>>>>>            Set psCaption to "Primer Nombre"
69593>>>>>>>        End_Object 
69594>>>>>>>
69594>>>>>>>        Object oPERSONAS_SEGUNDO_NOMBRE is a cDbCJGridColumn
69596>>>>>>>            Entry_Item PERSONAS.SEGUNDO_NOMBRE
69597>>>>>>>            Set piWidth to 112
69598>>>>>>>            Set psCaption to "Segundo Nombre"
69599>>>>>>>        End_Object 
69600>>>>>>>
69600>>>>>>>        Object oPERSONAS_PRIMER_APELLIDO is a cDbCJGridColumn
69602>>>>>>>            Entry_Item PERSONAS.PRIMER_APELLIDO
69603>>>>>>>            Set piWidth to 104
69604>>>>>>>            Set psCaption to "Primer Apellido"
69605>>>>>>>        End_Object 
69606>>>>>>>
69606>>>>>>>        Object oPERSONAS_SEGUNDO_APELLIDO is a cDbCJGridColumn
69608>>>>>>>            Entry_Item PERSONAS.SEGUNDO_APELLIDO
69609>>>>>>>            Set piWidth to 117
69610>>>>>>>            Set psCaption to "Segundo Apellido"
69611>>>>>>>        End_Object 
69612>>>>>>>
69612>>>>>>>        Object oPERSONAS_APELLIDO_CASADA is a cDbCJGridColumn
69614>>>>>>>            Entry_Item PERSONAS.APELLIDO_CASADA
69615>>>>>>>            Set piWidth to 448
69616>>>>>>>            Set psCaption to "Apellido Casada"
69617>>>>>>>        End_Object 
69618>>>>>>>
69618>>>>>>>
69618>>>>>>>    End_Object 
69619>>>>>>>
69619>>>>>>>    Object oOk_bn is a Button
69621>>>>>>>        Set Label to "&Ok"
69622>>>>>>>        Set Location to 115 229
69623>>>>>>>        Set peAnchors to anBottomRight
69624>>>>>>>
69624>>>>>>>        Procedure OnClick
69627>>>>>>>            Send OK of oSelList
69628>>>>>>>        End_Procedure
69629>>>>>>>
69629>>>>>>>    End_Object 
69630>>>>>>>
69630>>>>>>>    Object oCancel_bn is a Button
69632>>>>>>>        Set Label to "&Cancel"
69633>>>>>>>        Set Location to 115 283
69634>>>>>>>        Set peAnchors to anBottomRight
69635>>>>>>>
69635>>>>>>>        Procedure OnClick
69638>>>>>>>            Send Cancel of oSelList
69639>>>>>>>        End_Procedure
69640>>>>>>>
69640>>>>>>>    End_Object 
69641>>>>>>>
69641>>>>>>>    Object oSearch_bn is a Button
69643>>>>>>>        Set Label to "&Search..."
69644>>>>>>>        Set Location to 115 337
69645>>>>>>>        Set peAnchors to anBottomRight
69646>>>>>>>
69646>>>>>>>        Procedure OnClick
69649>>>>>>>            Send Search of oSelList
69650>>>>>>>        End_Procedure
69651>>>>>>>
69651>>>>>>>    End_Object 
69652>>>>>>>
69652>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
69653>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
69654>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
69655>>>>>>>
69655>>>>>>>
69655>>>>>>>CD_End_Object // PERSONAS_sl
69657>>>>>>>>
69657>>>Use DFEntry.pkg
69657>>>
69657>>>Use MonthCalendarPrompt.dg
Including file: MonthCalendarPrompt.dg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\MonthCalendarPrompt.dg)
69657>>>>>// Month Calendar Prompt dialog
69657>>>>>Use cMonthCalendarPrompt.pkg
Including file: cMonthCalendarPrompt.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cMonthCalendarPrompt.pkg)
69657>>>>>>>Use cMonthCalendar.pkg
Including file: cMonthCalendar.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cMonthCalendar.pkg)
69657>>>>>>>>>Use Windows.pkg
69657>>>>>>>>>Use Commctrl.pkg
69657>>>>>>>>>Use tWinStructs.pkg
69657>>>>>>>>>Use cWinControlEx.pkg
Including file: cWinControlEx.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cWinControlEx.pkg)
69657>>>>>>>>>>>Use cWinControl.pkg
Including file: cWinControl.pkg    (C:\Program Files (x86)\DataFlex 19.1\Pkg\cWinControl.pkg)
69657>>>>>>>>>>>>>Use Windows.pkg
69657>>>>>>>>>>>>>
69657>>>>>>>>>>>>>// Key State Masks for Mouse Messages
69657>>>>>>>>>>>>>
69657>>>>>>>>>>>>>Define MK_LBUTTON  for |CI$0001
69657>>>>>>>>>>>>>Define MK_RBUTTON  for |CI$0002
69657>>>>>>>>>>>>>Define MK_SHIFT    for |CI$0004
69657>>>>>>>>>>>>>Define MK_CONTROL  for |CI$0008
69657>>>>>>>>>>>>>Define MK_MBUTTON  for |CI$0010
69657>>>>>>>>>>>>>Define MK_XBUTTON1 for |CI$0020
69657>>>>>>>>>>>>>Define MK_XBUTTON2 for |CI$0040
69657>>>>>>>>>>>>>
69657>>>>>>>>>>>>>Enum_List // Mouse Key Flags
69657>>>>>>>>>>>>>    Define mkLeft    for MK_LBUTTON
69657>>>>>>>>>>>>>    Define mkMiddle  for MK_MBUTTON
69657>>>>>>>>>>>>>    Define mkRight   for MK_RBUTTON
69657>>>>>>>>>>>>>    Define mkX1      for MK_XBUTTON1
69657>>>>>>>>>>>>>    Define mkX2      for MK_XBUTTON2
69657>>>>>>>>>>>>>    Define mkShift   for MK_SHIFT
69657>>>>>>>>>>>>>    Define mkControl for MK_CONTROL
69657>>>>>>>>>>>>>End_Enum_List
69657>>>>>>>>>>>>>
69657>>>>>>>>>>>>>Enum_List // Mouse Buttons. Used in OnMouseXXX messages
69657>>>>>>>>>>>>>    Define mbLeft
69657>>>>>>>>>>>>>    Define mbMiddle
69657>>>>>>>>>>>>>    Define mbRight
69657>>>>>>>>>>>>>    Define mbX1
69657>>>>>>>>>>>>>    Define mbX2
69657>>>>>>>>>>>>>End_Enum_List
69657>>>>>>>>>>>>>
69657>>>>>>>>>>>>>Class cWinControl is a DfBaseControl
69658>>>>>>>>>>>>>    Procedure Construct_Object
69660>>>>>>>>>>>>>        Forward Send Construct_Object
69662>>>>>>>>>>>>>        Property Integer private_pbEnabled True
69663>>>>>>>>>>>>>        Property Integer private_pbVisible True
69664>>>>>>>>>>>>>    End_Procedure
69665>>>>>>>>>>>>>    
69665>>>>>>>>>>>>>    Procedure End_Construct_Object
69667>>>>>>>>>>>>>        Forward Send End_Construct_Object
69669>>>>>>>>>>>>>        
69669>>>>>>>>>>>>>        Set External_Message WM_LBUTTONDOWN   to msg_OnWmLButtonDown
69670>>>>>>>>>>>>>        Set External_Message WM_MBUTTONDOWN   to msg_OnWmMButtonDown
69671>>>>>>>>>>>>>        Set External_Message WM_RBUTTONDOWN   to msg_OnWmRButtonDown
69672>>>>>>>>>>>>>        Set External_Message WM_LBUTTONUP     to msg_OnWmLButtonUp
69673>>>>>>>>>>>>>        Set External_Message WM_MBUTTONUP     to msg_OnWmMButtonUp
69674>>>>>>>>>>>>>        Set External_Message WM_RBUTTONUP     to msg_OnWmRButtonUp
69675>>>>>>>>>>>>>        Set External_Message WM_LBUTTONDBLCLK to msg_OnWmLButtonDblClk
69676>>>>>>>>>>>>>        Set External_Message WM_MBUTTONDBLCLK to msg_OnWmMButtonDblClk
69677>>>>>>>>>>>>>        Set External_Message WM_RBUTTONDBLCLK to msg_OnWmRButtonDblClk
69678>>>>>>>>>>>>>        Set External_Message WM_MOUSEMOVE     to msg_OnWmMouseMove
69679>>>>>>>>>>>>>    End_Procedure
69680>>>>>>>>>>>>>    
69680>>>>>>>>>>>>>    Procedure Notify Longptr wParam Longptr lParam
69682>>>>>>>>>>>>>        //Intentionally cancelled
69682>>>>>>>>>>>>>    End_Procedure
69683>>>>>>>>>>>>>    
69683>>>>>>>>>>>>>    Procedure Command Integer wParam Integer lParam
69685>>>>>>>>>>>>>        //Intentionally cancelled
69685>>>>>>>>>>>>>    End_Procedure
69686>>>>>>>>>>>>>    
69686>>>>>>>>>>>>>    Procedure DoRecreateWindow
69688>>>>>>>>>>>>>        // Recreates the window
69688>>>>>>>>>>>>>        If (Window_Handle(Self)) Begin
69690>>>>>>>>>>>>>            // attempt to do this without disturbing the focus tree.
69690>>>>>>>>>>>>>            Send Page_delete // prior to 8.3 this was Send Page_Object 0
69691>>>>>>>>>>>>>            Send Page 1      //                       Send Page_Object 1
69692>>>>>>>>>>>>>        End
69692>>>>>>>>>>>>>>
69692>>>>>>>>>>>>>    End_Procedure
69693>>>>>>>>>>>>>    
69693>>>>>>>>>>>>>    Procedure DoUpdateWindow
69695>>>>>>>>>>>>>        // Forces windows to update the window by bypassing WM_PAINT
69695>>>>>>>>>>>>>        Handle hWnd
69695>>>>>>>>>>>>>        
69695>>>>>>>>>>>>>        Get Window_Handle to hWnd
69696>>>>>>>>>>>>>        If hWnd ;            Move (UpdateWindow(hWnd)) to hWnd
69699>>>>>>>>>>>>>    End_Procedure
69700>>>>>>>>>>>>>    
69700>>>>>>>>>>>>>    Procedure Page Integer iState
69702>>>>>>>>>>>>>        Set Window_Style to WS_DISABLED (private_pbEnabled(Self) =False)
69703>>>>>>>>>>>>>        Set Window_Style to WS_VISIBLE (private_pbVisible(Self))
69704>>>>>>>>>>>>>        Forward Send Page iState
69706>>>>>>>>>>>>>    End_Procedure
69707>>>>>>>>>>>>>    
69707>>>>>>>>>>>>>    Procedure OnWmLButtonUp Integer wParam Integer lParam
69709>>>>>>>>>>>>>        Integer x y eButton
69709>>>>>>>>>>>>>        
69709>>>>>>>>>>>>>        Move (Hi(lParam))  to y
69710>>>>>>>>>>>>>        Move (Low(lParam)) to x
69711>>>>>>>>>>>>>        
69711>>>>>>>>>>>>>        Send OnMouseUp mbLeft x y wParam
69712>>>>>>>>>>>>>    End_Procedure
69713>>>>>>>>>>>>>    
69713>>>>>>>>>>>>>    Procedure OnWmMButtonUp Integer wParam Integer lParam
69715>>>>>>>>>>>>>        Integer x y eButton
69715>>>>>>>>>>>>>        
69715>>>>>>>>>>>>>        Move (Hi(lParam))  to y
69716>>>>>>>>>>>>>        Move (Low(lParam)) to x
69717>>>>>>>>>>>>>        
69717>>>>>>>>>>>>>        Send OnMouseUp mbMiddle x y wParam
69718>>>>>>>>>>>>>    End_Procedure
69719>>>>>>>>>>>>>    
69719>>>>>>>>>>>>>    Procedure OnWmRButtonUp Integer wParam Integer lParam
69721>>>>>>>>>>>>>        Integer x y eButton
69721>>>>>>>>>>>>>        
69721>>>>>>>>>>>>>        Move (Hi(lParam))  to y
69722>>>>>>>>>>>>>        Move (Low(lParam)) to x
69723>>>>>>>>>>>>>        
69723>>>>>>>>>>>>>        Send OnMouseUp mbRight x y wParam
69724>>>>>>>>>>>>>    End_Procedure
69725>>>>>>>>>>>>>    
69725>>>>>>>>>>>>>    Procedure OnWmLButtonDown Integer wParam Integer lParam
69727>>>>>>>>>>>>>        Integer x y eButton fKeys
69727>>>>>>>>>>>>>        
69727>>>>>>>>>>>>>        Move (Hi(lParam))  to y
69728>>>>>>>>>>>>>        Move (Low(lParam)) to x
69729>>>>>>>>>>>>>        
69729>>>>>>>>>>>>>        Send OnMouseDown mbLeft x y wParam
69730>>>>>>>>>>>>>    End_Procedure
69731>>>>>>>>>>>>>    Procedure OnWmMButtonDown Integer wParam Integer lParam
69733>>>>>>>>>>>>>        Integer x y eButton
69733>>>>>>>>>>>>>        
69733>>>>>>>>>>>>>        Move (Hi(lParam))  to y
69734>>>>>>>>>>>>>        Move (Low(lParam)) to x
69735>>>>>>>>>>>>>        
69735>>>>>>>>>>>>>        Send OnMouseDown mbMiddle x y wParam
69736>>>>>>>>>>>>>    End_Procedure
69737>>>>>>>>>>>>>    Procedure OnWmRButtonDown Integer wParam Integer lParam
69739>>>>>>>>>>>>>        Integer x y eButton
69739>>>>>>>>>>>>>        
69739>>>>>>>>>>>>>        Move (Hi(lParam))  to y
69740>>>>>>>>>>>>>        Move (Low(lParam)) to x
69741>>>>>>>>>>>>>        
69741>>>>>>>>>>>>>        Send OnMouseDown mbRight x y wParam
69742>>>>>>>>>>>>>    End_Procedure
69743>>>>>>>>>>>>>    
69743>>>>>>>>>>>>>    Procedure OnWmLButtonDblClk Integer wParam Integer lParam
69745>>>>>>>>>>>>>        Integer x y eButton
69745>>>>>>>>>>>>>        
69745>>>>>>>>>>>>>        Move (Hi(lParam))  to y
69746>>>>>>>>>>>>>        Move (Low(lParam)) to x
69747>>>>>>>>>>>>>        
69747>>>>>>>>>>>>>        Send OnMouseDoubleClick mbLeft x y wParam
69748>>>>>>>>>>>>>    End_Procedure
69749>>>>>>>>>>>>>    Procedure OnWmMButtonDblClk Integer wParam Integer lParam
69751>>>>>>>>>>>>>        Integer x y eButton
69751>>>>>>>>>>>>>        
69751>>>>>>>>>>>>>        Move (Hi(lParam))  to y
69752>>>>>>>>>>>>>        Move (Low(lParam)) to x
69753>>>>>>>>>>>>>        
69753>>>>>>>>>>>>>        Send OnMouseDoubleClick mbMiddle x y wParam
69754>>>>>>>>>>>>>    End_Procedure
69755>>>>>>>>>>>>>    Procedure OnWmRButtonDblClk Integer wParam Integer lParam
69757>>>>>>>>>>>>>        Integer x y eButton
69757>>>>>>>>>>>>>        
69757>>>>>>>>>>>>>        Move (Hi(lParam))  to y
69758>>>>>>>>>>>>>        Move (Low(lParam)) to x
69759>>>>>>>>>>>>>        
69759>>>>>>>>>>>>>        Send OnMouseDoubleClick mbRight x y wParam
69760>>>>>>>>>>>>>    End_Procedure
69761>>>>>>>>>>>>>    
69761>>>>>>>>>>>>>    Procedure OnWmMouseMove Integer wParam Integer lParam
69763>>>>>>>>>>>>>        Integer x y eButton
69763>>>>>>>>>>>>>        
69763>>>>>>>>>>>>>        Move (Hi(lParam))  to y
69764>>>>>>>>>>>>>        Move (Low(lParam)) to x
69765>>>>>>>>>>>>>        
69765>>>>>>>>>>>>>        Send OnMouseMove x y wParam
69766>>>>>>>>>>>>>    End_Procedure
69767>>>>>>>>>>>>>    
69767>>>>>>>>>>>>>    Procedure OnMouseDown Integer eButton Integer x Integer y Integer fKeys
69769>>>>>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
69769>>>>>>>>>>>>>        //String sButton
69769>>>>>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
69769>>>>>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
69769>>>>>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
69769>>>>>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
69769>>>>>>>>>>>>>        
69769>>>>>>>>>>>>>        //If (eButton = mbLeft) Move 'Left Button' To sButton
69769>>>>>>>>>>>>>        //If (eButton = mbRight) Move 'Right Button' To sButton
69769>>>>>>>>>>>>>        //Showln 'OnMouseDown ' sButton ' ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
69769>>>>>>>>>>>>>    End_Procedure
69770>>>>>>>>>>>>>    
69770>>>>>>>>>>>>>    Procedure OnMouseUp Integer eButton Integer x Integer y Integer fKeys
69772>>>>>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
69772>>>>>>>>>>>>>        //String sButton
69772>>>>>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
69772>>>>>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
69772>>>>>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
69772>>>>>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
69772>>>>>>>>>>>>>        
69772>>>>>>>>>>>>>        //If (eButton = mbLeft) Move 'Left Button' To sButton
69772>>>>>>>>>>>>>        //If (eButton = mbRight) Move 'Right Button' To sButton
69772>>>>>>>>>>>>>        //Showln 'OnMouseUp ' sButton ' ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
69772>>>>>>>>>>>>>    End_Procedure
69773>>>>>>>>>>>>>    
69773>>>>>>>>>>>>>    Procedure OnMouseDoubleClick Integer eButton Integer x Integer y Integer fKeys
69775>>>>>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
69775>>>>>>>>>>>>>        //String sButton
69775>>>>>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
69775>>>>>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
69775>>>>>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
69775>>>>>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
69775>>>>>>>>>>>>>        
69775>>>>>>>>>>>>>        //If (eButton = mbLeft) Move 'Left Button' To sButton
69775>>>>>>>>>>>>>        //If (eButton = mbRight) Move 'Right Button' To sButton
69775>>>>>>>>>>>>>        //Showln 'OnMouseDblClk ' sButton ' ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
69775>>>>>>>>>>>>>    End_Procedure
69776>>>>>>>>>>>>>    
69776>>>>>>>>>>>>>    Procedure OnMouseMove Integer x Integer y Integer fKeys
69778>>>>>>>>>>>>>        //Boolean bShiftKey bControlKey bLeftButton bRightButton
69778>>>>>>>>>>>>>        //Move (IsFlagIn(mkShift, fKeys))   To bShiftKey
69778>>>>>>>>>>>>>        //Move (IsFlagIn(mkControl, fKeys)) To bControlKey
69778>>>>>>>>>>>>>        //Move (IsFlagIn(mkLeft, fKeys))    To bLeftButton
69778>>>>>>>>>>>>>        //Move (IsFlagIn(mkRight, fKeys))   To bRightButton
69778>>>>>>>>>>>>>        
69778>>>>>>>>>>>>>        //Showln 'OnMouseMove ' x ' ' y ' shift=' bShiftKey ' ctrl=' bControlKey  ' left=' bLeftButton ' right=' bRightButton
69778>>>>>>>>>>>>>    End_Procedure
69779>>>>>>>>>>>>>    
69779>>>>>>>>>>>>>    Procedure Set pbEnabled Boolean bEnabled
69781>>>>>>>>>>>>>        Handle hWnd
69781>>>>>>>>>>>>>        
69781>>>>>>>>>>>>>        If (bEnabled <> private_pbEnabled(Self)) Begin
69783>>>>>>>>>>>>>            Set private_pbEnabled to bEnabled
69784>>>>>>>>>>>>>            Get Window_Handle to hWnd
69785>>>>>>>>>>>>>            If hWnd ;                Move (EnableWindow(hWnd, bEnabled)) to hWnd
69788>>>>>>>>>>>>>        End
69788>>>>>>>>>>>>>>
69788>>>>>>>>>>>>>    End_Procedure
69789>>>>>>>>>>>>>    Function pbEnabled Returns Boolean
69791>>>>>>>>>>>>>        Function_Return (private_pbEnabled(Self))
69792>>>>>>>>>>>>>    End_Function
69793>>>>>>>>>>>>>    
69793>>>>>>>>>>>>>    Procedure Set pbVisible Boolean bVisible
69795>>>>>>>>>>>>>        Handle  hWnd
69795>>>>>>>>>>>>>        Integer iVoid
69795>>>>>>>>>>>>>        
69795>>>>>>>>>>>>>        If (bVisible <> private_pbVisible(Self)) Begin
69797>>>>>>>>>>>>>            Set private_pbVisible to bVisible
69798>>>>>>>>>>>>>            Get Window_Handle to hWnd
69799>>>>>>>>>>>>>            If hWnd ;                Move (ShowWindow(hWnd, If (bVisible, SW_SHOWNA, SW_HIDE))) to iVoid
69802>>>>>>>>>>>>>        End
69802>>>>>>>>>>>>>>
69802>>>>>>>>>>>>>    End_Procedure
69803>>>>>>>>>>>>>    Function pbVisible Returns Boolean
69805>>>>>>>>>>>>>        Function_Return (private_pbVisible(Self))
69806>>>>>>>>>>>>>    End_Function
69807>>>>>>>>>>>>>    
69807>>>>>>>>>>>>>End_Class
69808>>>>>>>>>>>// This adds proper navigation and default button support for
69808>>>>>>>>>>>// external classes
69808>>>>>>>>>>>
69808>>>>>>>>>>>Class cWinControlEx is a cWinControl
69809>>>>>>>>>>>    Import_Class_Protocol Standard_Form_Mixin
69810>>>>>>>>>>>    Procedure Construct_Object
69812>>>>>>>>>>>        Forward Send Construct_Object
69814>>>>>>>>>>>        Send define_standard_Form_Mixin
69815>>>>>>>>>>>    End_Procedure
69816>>>>>>>>>>>    
69816>>>>>>>>>>>    Function item_count Integer iItem Returns Integer
69818>>>>>>>>>>>        Function_Return 1
69819>>>>>>>>>>>    End_Function
69820>>>>>>>>>>>    
69820>>>>>>>>>>>    Procedure External_SetFocus
69822>>>>>>>>>>>        Send notify_focus_change 1
69823>>>>>>>>>>>    End_Procedure
69824>>>>>>>>>>>    
69824>>>>>>>>>>>    Procedure External_KillFocus
69826>>>>>>>>>>>        Send notify_focus_change 0
69827>>>>>>>>>>>    End_Procedure
69828>>>>>>>>>>>    
69828>>>>>>>>>>>    Procedure End_Construct_Object
69830>>>>>>>>>>>        Forward Send End_Construct_Object
69832>>>>>>>>>>>        Set External_Message WM_SETFOCUS  to External_SetFocus
69833>>>>>>>>>>>        Set External_Message WM_KILLFOCUS to External_KillFocus
69834>>>>>>>>>>>    End_Procedure
69835>>>>>>>>>>>    
69835>>>>>>>>>>>End_Class
69836>>>>>>>>>>>
69836>>>>>>>>>
69836>>>>>>>>>Class cMonthCalendar is a cWinControlEx
69837>>>>>>>>>    Procedure Construct_Object
69839>>>>>>>>>        Integer iResult
69839>>>>>>>>>        tWinInitCommonControlsEX InitCC
69839>>>>>>>>>        tWinInitCommonControlsEX InitCC
69839>>>>>>>>>        
69839>>>>>>>>>        Forward Send Construct_Object
69841>>>>>>>>>        
69841>>>>>>>>>        Move (SizeOfType (tWinInitCommonControlsEX)) to InitCC.dwSize
69842>>>>>>>>>        Move ICC_DATE_CLASSES to InitCC.dwICC
69843>>>>>>>>>        Move (InitCommonControlsEx(AddressOf(InitCC))) to iResult
69844>>>>>>>>>        
69844>>>>>>>>>        Set External_Class_Name 'cMonthCalendar' to 'SysMonthCal32'
69845>>>>>>>>>        Set External_Message WM_LBUTTONDBLCLK to msg_OnLButtonDblClick
69846>>>>>>>>>        
69846>>>>>>>>>        Set Border_Style to Border_Normal
69847>>>>>>>>>        
69847>>>>>>>>>        Property Boolean pbNoToday False
69848>>>>>>>>>        Property Boolean pbNoTodayCircle False
69849>>>>>>>>>        Property Boolean pbMultiSelect False
69850>>>>>>>>>        Property Boolean pbWeekNumbers False
69851>>>>>>>>>        Property Integer piMaxSelectedCount 90
69852>>>>>>>>>        
69852>>>>>>>>>        // this is minimum Dialog units required for a single picker rectangle
69852>>>>>>>>>        Property Integer piMinWidth 0
69853>>>>>>>>>        Property Integer piMinHeight 0
69854>>>>>>>>>        
69854>>>>>>>>>        // stores initial date before control is activated
69854>>>>>>>>>        Property Date pdPrivateDate
69855>>>>>>>>>        // if multi-select, this is the end range
69855>>>>>>>>>        Property Date pdPrivateDate2
69856>>>>>>>>>        
69856>>>>>>>>>    End_Procedure
69857>>>>>>>>>    
69857>>>>>>>>>    // returns control's value when single select
69857>>>>>>>>>    Function SelectedDate Returns Date
69859>>>>>>>>>        tWinSystemTime CurrentSystemTime
69859>>>>>>>>>        tWinSystemTime CurrentSystemTime
69859>>>>>>>>>        Integer iRetval
69859>>>>>>>>>        DateTime dtSel
69859>>>>>>>>>        Handle hWnd
69859>>>>>>>>>        Get Window_Handle to hWnd
69860>>>>>>>>>        If (hWnd) Begin
69862>>>>>>>>>            Move (WindowsMessage (MCM_GETCURSEL, 0, AddressOf (CurrentSystemTime))) to iRetval
69863>>>>>>>>>            Move (DateSetDay(dtSel,CurrentSystemTime.wDay)) to dtSel
69864>>>>>>>>>            Move (DateSetMonth(dtSel,CurrentSystemTime.wMonth)) to dtSel
69865>>>>>>>>>            Move (DateSetYear(dtSel,CurrentSystemTime.wYear)) to dtSel
69866>>>>>>>>>        End
69866>>>>>>>>>>
69866>>>>>>>>>        Else Begin
69867>>>>>>>>>            Get pdPrivateDate to dtSel
69868>>>>>>>>>        End
69868>>>>>>>>>>
69868>>>>>>>>>        Function_Return (Date(dtSel))
69869>>>>>>>>>    End_Function
69870>>>>>>>>>    
69870>>>>>>>>>    // returns control's values when multi select
69870>>>>>>>>>    Function SelectedDateRange Returns Date[]
69872>>>>>>>>>        tWinSystemTime[2] CurrentSystemTime
69872>>>>>>>>>        tWinSystemTime[2] CurrentSystemTime
69873>>>>>>>>>        Integer iRetval
69873>>>>>>>>>        DateTime dtSel1 dtsel2
69873>>>>>>>>>        Date[] dtSel
69874>>>>>>>>>        Handle hWnd
69874>>>>>>>>>        Get Window_Handle to hWnd
69875>>>>>>>>>        If (hWnd) Begin
69877>>>>>>>>>            Move (WindowsMessage (MCM_GETSELRANGE, 0, AddressOf (CurrentSystemTime))) to iRetval
69878>>>>>>>>>            
69878>>>>>>>>>            Move (DateSetDay(dtSel1,CurrentSystemTime[0].wDay)) to dtSel1
69879>>>>>>>>>            Move (DateSetMonth(dtSel1,CurrentSystemTime[0].wMonth)) to dtSel1
69880>>>>>>>>>            Move (DateSetYear(dtSel1,CurrentSystemTime[0].wYear)) to dtSel1
69881>>>>>>>>>            
69881>>>>>>>>>            Move (DateSetDay(dtSel2,CurrentSystemTime[1].wDay)) to dtSel2
69882>>>>>>>>>            Move (DateSetMonth(dtSel2,CurrentSystemTime[1].wMonth)) to dtSel2
69883>>>>>>>>>            Move (DateSetYear(dtSel2,CurrentSystemTime[1].wYear)) to dtSel2
69884>>>>>>>>>            
69884>>>>>>>>>            Move dtSel1 to dtSel[0]
69885>>>>>>>>>            Move dtsel2 to dtSel[1]
69886>>>>>>>>>        End
69886>>>>>>>>>>
69886>>>>>>>>>        Else Begin
69887>>>>>>>>>            Get pdPrivateDate to dtSel[0]
69888>>>>>>>>>            Get pdPrivateDate2 to dtSel[1]
69889>>>>>>>>>        End
69889>>>>>>>>>>
69889>>>>>>>>>        Function_Return dtSel
69890>>>>>>>>>    End_Function
69891>>>>>>>>>    
69891>>>>>>>>>    // Set control's value when single select
69891>>>>>>>>>    Procedure SetSelectedDate Date dDate
69893>>>>>>>>>        tWinSystemTime CurrentSystemTime
69893>>>>>>>>>        tWinSystemTime CurrentSystemTime
69893>>>>>>>>>        Integer iRetval
69893>>>>>>>>>        Handle hWnd
69893>>>>>>>>>        
69893>>>>>>>>>        Get Window_Handle to hWnd
69894>>>>>>>>>        Set pdPrivateDate to dDate
69895>>>>>>>>>        If (hWnd) Begin
69897>>>>>>>>>            Move (DateGetDay(dDate)) to CurrentSystemTime.wDay
69898>>>>>>>>>            Move (DateGetMonth(dDate)) to CurrentSystemTime.wMonth
69899>>>>>>>>>            Move (DateGetYear(dDate)) to CurrentSystemTime.wYear
69900>>>>>>>>>            
69900>>>>>>>>>            Move (WindowsMessage (MCM_SETCURSEL, 0, AddressOf (CurrentSystemTime))) to iRetval
69901>>>>>>>>>        End
69901>>>>>>>>>>
69901>>>>>>>>>    End_Procedure
69902>>>>>>>>>    
69902>>>>>>>>>    // Set control's values when multi select
69902>>>>>>>>>    Procedure SetSelectedDateRange Date dDate Date dDate2
69904>>>>>>>>>        tWinSystemTime[] CurrentSystemTime
69904>>>>>>>>>        tWinSystemTime[] CurrentSystemTime
69905>>>>>>>>>        Integer iRetval
69905>>>>>>>>>        Handle hWnd
69905>>>>>>>>>        
69905>>>>>>>>>        Get Window_Handle to hWnd
69906>>>>>>>>>        Set pdPrivateDate to dDate
69907>>>>>>>>>        Set pdPrivateDate2 to dDate2
69908>>>>>>>>>        If (hWnd) Begin
69910>>>>>>>>>            Move (DateGetDay(dDate)) to CurrentSystemTime[0].wDay
69911>>>>>>>>>            Move (DateGetMonth(dDate)) to CurrentSystemTime[0].wMonth
69912>>>>>>>>>            Move (DateGetYear(dDate)) to CurrentSystemTime[0].wYear
69913>>>>>>>>>            
69913>>>>>>>>>            Move (DateGetDay(dDate2)) to CurrentSystemTime[1].wDay
69914>>>>>>>>>            Move (DateGetMonth(dDate2)) to CurrentSystemTime[1].wMonth
69915>>>>>>>>>            Move (DateGetYear(dDate2)) to CurrentSystemTime[1].wYear
69916>>>>>>>>>            
69916>>>>>>>>>            Move (WindowsMessage (MCM_SETSELRANGE, 0, AddressOf (CurrentSystemTime))) to iRetval
69917>>>>>>>>>        End
69917>>>>>>>>>>
69917>>>>>>>>>    End_Procedure
69918>>>>>>>>>    
69918>>>>>>>>>    // augment to set dates from control, so they can be accessed after the control is closed
69918>>>>>>>>>    Procedure Remove_Object
69920>>>>>>>>>        Date[] SelDate
69921>>>>>>>>>        If (pbMultiSelect(Self)) Begin
69923>>>>>>>>>            Get SelectedDateRange to SelDate
69924>>>>>>>>>            Set pdPrivateDate2 to SelDate[1]
69925>>>>>>>>>        End
69925>>>>>>>>>>
69925>>>>>>>>>        Else Begin
69926>>>>>>>>>            Get SelectedDate to SelDate[0]
69927>>>>>>>>>        End
69927>>>>>>>>>>
69927>>>>>>>>>        Set pdPrivateDate to SelDate[0]
69928>>>>>>>>>        Forward Send Remove_Object
69930>>>>>>>>>    End_Procedure
69931>>>>>>>>>    
69931>>>>>>>>>    Procedure Page Integer iState
69933>>>>>>>>>        Integer iRetval iSize iHeight iWidth
69933>>>>>>>>>        tWinRect WindowRect
69933>>>>>>>>>        tWinRect WindowRect
69933>>>>>>>>>        Date dDate dDate2
69933>>>>>>>>>        Handle hWnd
69933>>>>>>>>>        Integer  iMaxSelectedCount
69933>>>>>>>>>        Boolean bNoToday bWeekNumbers bMultiSelect bNoTodayCircle
69933>>>>>>>>>        
69933>>>>>>>>>        If (iState<>1) Begin
69935>>>>>>>>>            Forward Send Page iState
69937>>>>>>>>>            Procedure_Return
69938>>>>>>>>>        End
69938>>>>>>>>>>
69938>>>>>>>>>        
69938>>>>>>>>>        Set Icon to 'ActionCalendar.ico'
69939>>>>>>>>>        
69939>>>>>>>>>        Get pbNoToday to bNoToday
69940>>>>>>>>>        Get pbNoTodayCircle to bNoTodayCircle
69941>>>>>>>>>        Get pbMultiSelect to bMultiSelect
69942>>>>>>>>>        Get pbWeekNumbers to bWeekNumbers
69943>>>>>>>>>        Get piMaxSelectedCount to iMaxSelectedCount
69944>>>>>>>>>        
69944>>>>>>>>>        Set Window_Style MCS_MULTISELECT to bMultiSelect
69945>>>>>>>>>        Set Window_Style MCS_NOTODAY to bNoToday
69946>>>>>>>>>        Set Window_Style MCS_NOTODAYCIRCLE to bNoTodayCircle
69947>>>>>>>>>        Set Window_Style MCS_WEEKNUMBERS to bWeekNumbers
69948>>>>>>>>>        Forward Send Page iState
69950>>>>>>>>>        
69950>>>>>>>>>        Get Window_Handle to hWnd
69951>>>>>>>>>        // support double click
69951>>>>>>>>>        Move (SetClassLongPtr(hWnd,GCL_STYLE,CS_DBLCLKS ior CS_GLOBALCLASS)) to iRetval
69952>>>>>>>>>        // set range when multi select
69952>>>>>>>>>        Move (WindowsMessage(MCM_SETMAXSELCOUNT,iMaxSelectedCount,0)) to iRetval
69953>>>>>>>>>        
69953>>>>>>>>>        // store minimum size for calendar control and set the size to this by default
69953>>>>>>>>>        Move (WindowsMessage (MCM_GETMINREQRECT, 0, AddressOf(WindowRect))) to iRetval
69954>>>>>>>>>        Get GuiToDialog WindowRect.bottom WindowRect.right to iSize
69955>>>>>>>>>        Move (Hi(iSize)) to iHeight
69956>>>>>>>>>        Move (Low(iSize)) to iWidth
69957>>>>>>>>>        Set piMinWidth to iWidth
69958>>>>>>>>>        Set piMinHeight to iHeight
69959>>>>>>>>>        Set Size to iHeight iWidth
69960>>>>>>>>>        
69960>>>>>>>>>        // now that we are activated set starting date or date range
69960>>>>>>>>>        Get pdPrivateDate to dDate
69961>>>>>>>>>        If (pbMultiSelect(Self)) Begin
69963>>>>>>>>>            Get pdPrivateDate2 to dDate2
69964>>>>>>>>>            Send SetSelectedDateRange dDate dDate2
69965>>>>>>>>>        End
69965>>>>>>>>>>
69965>>>>>>>>>        Else Begin
69966>>>>>>>>>            Send SetSelectedDate dDate
69967>>>>>>>>>        End
69967>>>>>>>>>>
69967>>>>>>>>>    End_Procedure
69968>>>>>>>>>    
69968>>>>>>>>>    Procedure Notify Longptr wParam Longptr lParam
69970>>>>>>>>>        Integer iRetval
69970>>>>>>>>>        DateTime dtSel dtSel2
69970>>>>>>>>>        tWintagNMSelChange CalenderInfo
69970>>>>>>>>>        tWintagNMSelChange CalenderInfo
69970>>>>>>>>>        Boolean bMulti
69970>>>>>>>>>        
69970>>>>>>>>>        Move (MemCopy (AddressOf (CalenderInfo), lParam, SizeOfType (tWintagNMSelChange))) to iRetval
69971>>>>>>>>>        If (CalenderInfo.nmHdr.code = MCN_SELCHANGE) Begin
69973>>>>>>>>>            Get pbMultiSelect to bMulti
69974>>>>>>>>>            Move (DateSetDay(dtSel,CalenderInfo.stSelStart.wDay)) to dtSel
69975>>>>>>>>>            Move (DateSetMonth(dtSel,CalenderInfo.stSelStart.wMonth)) to dtSel
69976>>>>>>>>>            Move (DateSetYear(dtSel,CalenderInfo.stSelStart.wYear)) to dtSel
69977>>>>>>>>>            If bMulti Begin
69979>>>>>>>>>                Move (DateSetDay(dtSel,CalenderInfo.stSelEnd.wDay)) to dtSel2
69980>>>>>>>>>                Move (DateSetMonth(dtSel,CalenderInfo.stSelEnd.wMonth)) to dtSel2
69981>>>>>>>>>                Move (DateSetYear(dtSel,CalenderInfo.stSelEnd.wYear)) to dtSel2
69982>>>>>>>>>            End
69982>>>>>>>>>>
69982>>>>>>>>>            Send OnChange (Date(dtSel)) (Date(dtSel2))
69983>>>>>>>>>        End
69983>>>>>>>>>>
69983>>>>>>>>>    End_Procedure
69984>>>>>>>>>    
69984>>>>>>>>>    // sent whenever there is a selection change within the calendar
69984>>>>>>>>>    Procedure OnChange Date dDate Date dDate2
69986>>>>>>>>>    End_Procedure
69987>>>>>>>>>    
69987>>>>>>>>>    // sent when a click occurs in the calendar
69987>>>>>>>>>    Procedure OnClick
69989>>>>>>>>>    End_Procedure
69990>>>>>>>>>    
69990>>>>>>>>>    // sent when a double click occurs in the calendar
69990>>>>>>>>>    Procedure OnDoubleClick
69992>>>>>>>>>    End_Procedure
69993>>>>>>>>>    
69993>>>>>>>>>    // sends OnClick if the double click is on a calendar day
69993>>>>>>>>>    Procedure OnLButtonDblClick Integer wParam Integer lParam
69995>>>>>>>>>        Boolean bDayHit
69995>>>>>>>>>        Get MonthDayHit to bDayHit
69996>>>>>>>>>        If bDayHit Begin
69998>>>>>>>>>            Send OnDoubleClick
69999>>>>>>>>>        End
69999>>>>>>>>>>
69999>>>>>>>>>    End_Procedure
70000>>>>>>>>>    
70000>>>>>>>>>    // sends OnClick if the click is on a calendar day
70000>>>>>>>>>    Procedure OnWmLButtonUp Integer wParam Integer lParam
70002>>>>>>>>>        Boolean bDayHit
70002>>>>>>>>>        Get MonthDayHit to bDayHit
70003>>>>>>>>>        If bDayHit Begin
70005>>>>>>>>>            Send OnClick
70006>>>>>>>>>        End
70006>>>>>>>>>>
70006>>>>>>>>>    End_Procedure
70007>>>>>>>>>    
70007>>>>>>>>>    // returns true if the month calander is up and the mouse is over a day
70007>>>>>>>>>    Function MonthDayHit Returns Boolean
70009>>>>>>>>>        UInteger iRet
70009>>>>>>>>>        Move (WindowsMessage( MCM_GETCURRENTVIEW, 0, 0)) to iRet
70010>>>>>>>>>        If (iRet=MCMV_MONTH) Begin
70012>>>>>>>>>            Get HitTest to iRet
70013>>>>>>>>>            Function_Return (iRet=MCHT_CALENDARDATE)
70014>>>>>>>>>        End
70014>>>>>>>>>>
70014>>>>>>>>>        Function_Return False
70015>>>>>>>>>    End_Function
70016>>>>>>>>>    
70016>>>>>>>>>    // return what was hit in the control
70016>>>>>>>>>    Function HitTest Returns UInteger
70018>>>>>>>>>        tWinMCHitTestInfo HitInfo
70018>>>>>>>>>        tWinMCHitTestInfo HitInfo
70018>>>>>>>>>        Handle hWnd iRet
70018>>>>>>>>>        Integer iVoid
70018>>>>>>>>>        Pointer lpPt
70018>>>>>>>>>        tWinPoint Pt
70018>>>>>>>>>        tWinPoint Pt
70018>>>>>>>>>        Get Window_Handle to hWnd
70019>>>>>>>>>        Move (AddressOf(Pt)) to lpPt
70020>>>>>>>>>        Move (GetCursorPos(lpPt)) to iVoid
70021>>>>>>>>>        Move (ScreenToClient(hWnd, lpPt)) to iVoid
70022>>>>>>>>>        Move Pt to HitInfo.Pt
70023>>>>>>>>>        Move (SizeOfType(tWinMCHitTestInfo)) to HitInfo.cbSize
70024>>>>>>>>>        Move (WindowsMessage(MCM_HITTEST, 0, AddressOf(HitInfo))) to iRet
70025>>>>>>>>>        Function_Return HitInfo.uHit
70026>>>>>>>>>    End_Function
70027>>>>>>>>>    
70027>>>>>>>>>End_Class
70028>>>>>>>
70028>>>>>>>// peMouseSelectOk choices
70028>>>>>>>Enum_List
70028>>>>>>>    Define msoClick
70028>>>>>>>    Define msoDblClick
70028>>>>>>>    Define msoNone
70028>>>>>>>End_Enum_List
70028>>>>>>>
70028>>>>>>>// It is expected that this class will only be used inside of ModalPanel and
70028>>>>>>>// will be used as a prompt object component in a framework style application.
70028>>>>>>>// If you wish to Use a month calendar in some other non prompt situation,
70028>>>>>>>// use cMonthCalendar
70028>>>>>>>
70028>>>>>>>Class cMonthCalendarPrompt is a cMonthCalendar
70029>>>>>>>    
70029>>>>>>>    Procedure Construct_Object
70031>>>>>>>        
70031>>>>>>>        Forward Send Construct_Object
70033>>>>>>>        
70033>>>>>>>        Property Integer peUpdateMode umPromptValue
70034>>>>>>>        
70034>>>>>>>        Property Integer peMouseSelectOk msoClick
70035>>>>>>>        
70035>>>>>>>        Property Date pdSeedValue
70036>>>>>>>        
70036>>>>>>>        // if multi-select, this is the end range
70036>>>>>>>        Property Date pdSeedValue2
70037>>>>>>>        
70037>>>>>>>        Property Handle phmPromptUpdateCallback 0
70038>>>>>>>        
70038>>>>>>>        Property Integer phoInvokingObject
70039>>>>>>>        
70039>>>>>>>        Property Integer peStoredUpdateMode
70040>>>>>>>        Property Handle  phmStoredPromptUpdateCallback
70041>>>>>>>        Property Boolean pbStoredWeekNumbers
70042>>>>>>>        Property Boolean pbStoredNoToday
70043>>>>>>>        Property Boolean pbStoredNoTodayCircle
70044>>>>>>>        Property Boolean pbStoredMultiSelect
70045>>>>>>>        Property Integer piStoredMaxSelectedCount
70046>>>>>>>        Property Integer peStoredpeMouseSelectOk
70047>>>>>>>        
70047>>>>>>>        // internally set by list
70047>>>>>>>        // these must be set upon closing the list and can be used for manual list updates
70047>>>>>>>        Property Boolean pbCanceled
70048>>>>>>>        
70048>>>>>>>    End_Procedure
70049>>>>>>>    
70049>>>>>>>    Procedure OnStoreDefaults
70051>>>>>>>        Integer iVal
70051>>>>>>>        Boolean bVal
70051>>>>>>>        
70051>>>>>>>        Get peUpdateMode to iVal
70052>>>>>>>        Set peStoredUpdateMode to iVal
70053>>>>>>>        
70053>>>>>>>        Get phmPromptUpdateCallback to iVal
70054>>>>>>>        Set phmStoredPromptUpdateCallback to iVal
70055>>>>>>>        
70055>>>>>>>        Get pbMultiSelect to bVal
70056>>>>>>>        Set pbStoredMultiSelect to bVal
70057>>>>>>>        
70057>>>>>>>        Get pbNoToday to bVal
70058>>>>>>>        Set pbStoredNoToday to bVal
70059>>>>>>>        
70059>>>>>>>        Get pbNoTodayCircle to bVal
70060>>>>>>>        Set pbStoredNoTodayCircle to bVal
70061>>>>>>>        
70061>>>>>>>        Get pbWeekNumbers to bVal
70062>>>>>>>        Set pbStoredWeekNumbers to bVal
70063>>>>>>>        
70063>>>>>>>        Get piMaxSelectedCount to iVal
70064>>>>>>>        Set piStoredMaxSelectedCount to iVal
70065>>>>>>>        
70065>>>>>>>        Get peMouseSelectOk to iVal
70066>>>>>>>        Set peStoredpeMouseSelectOk to iVal
70067>>>>>>>        
70067>>>>>>>    End_Procedure
70068>>>>>>>    
70068>>>>>>>    Procedure OnRestoreDefaults
70070>>>>>>>        Integer iVal
70070>>>>>>>        Boolean bVal
70070>>>>>>>        
70070>>>>>>>        Get peStoredUpdateMode to iVal
70071>>>>>>>        Set peUpdateMode to iVal
70072>>>>>>>        
70072>>>>>>>        Get phmStoredPromptUpdateCallback to iVal
70073>>>>>>>        Set phmPromptUpdateCallback to iVal
70074>>>>>>>        
70074>>>>>>>        Get pbStoredMultiSelect to bVal
70075>>>>>>>        Set pbMultiSelect to bVal
70076>>>>>>>        
70076>>>>>>>        Get pbStoredNoToday to bVal
70077>>>>>>>        Set pbNoToday to bVal
70078>>>>>>>        
70078>>>>>>>        Get pbStoredNoTodayCircle to bVal
70079>>>>>>>        Set pbNoTodayCircle to bVal
70080>>>>>>>        
70080>>>>>>>        Get pbStoredWeekNumbers to bVal
70081>>>>>>>        Set pbWeekNumbers to bVal
70082>>>>>>>        
70082>>>>>>>        Get piStoredMaxSelectedCount to iVal
70083>>>>>>>        Set piMaxSelectedCount to iVal
70084>>>>>>>        
70084>>>>>>>        Get peStoredpeMouseSelectOk to iVal
70085>>>>>>>        Set peMouseSelectOk to iVal
70086>>>>>>>        
70086>>>>>>>    End_Procedure
70087>>>>>>>    
70087>>>>>>>    Procedure Add_Focus Handle hoParent Returns Integer
70089>>>>>>>        Integer eMode
70089>>>>>>>        Set pbCanceled to True // assume cancel unless changed
70090>>>>>>>        Get peUpdateMode to eMode
70091>>>>>>>        If (eMode<>umPromptNonInvoking) Begin
70093>>>>>>>            Send OnStoreDefaults
70094>>>>>>>        End
70094>>>>>>>>
70094>>>>>>>        Send InitializePrompt
70095>>>>>>>        Forward Send Add_Focus hoParent
70097>>>>>>>    End_Procedure
70098>>>>>>>    
70098>>>>>>>    // augment to send OnRestoreDefaults.
70098>>>>>>>    Procedure Release_Focus
70100>>>>>>>        Integer eUpdateMode
70100>>>>>>>        Get peUpdateMode to eUpdateMode
70101>>>>>>>        Forward Send Release_Focus
70103>>>>>>>        If (eUpdateMode<>umPromptNonInvoking) Begin
70105>>>>>>>            Send OnRestoreDefaults
70106>>>>>>>        End
70106>>>>>>>>
70106>>>>>>>    End_Procedure
70107>>>>>>>    
70107>>>>>>>    // This is only called in a successful close
70107>>>>>>>    Procedure ClosePrompt
70109>>>>>>>        Handle hoInvokingObject
70109>>>>>>>        Handle hmCallBack
70109>>>>>>>        Integer eUpdateMode
70109>>>>>>>        Date[] dDates
70110>>>>>>>        
70110>>>>>>>        Set pbCanceled to False
70111>>>>>>>        
70111>>>>>>>        Get peUpdateMode to eUpdateMode
70112>>>>>>>        // if non-invoking there is by definition, no move value out
70112>>>>>>>        If (eUpdateMode<>umPromptNonInvoking) Begin
70114>>>>>>>            
70114>>>>>>>            If (eUpdateMode=umPromptValue) Begin
70116>>>>>>>                Send OnMoveValueOutByValue
70117>>>>>>>            End
70117>>>>>>>>
70117>>>>>>>            Else If (eUpdateMode=umPromptCustom) Begin
70120>>>>>>>                Send OnMoveValueOutByCustom
70121>>>>>>>            End
70121>>>>>>>>
70121>>>>>>>            Get phmPromptUpdateCallback to hmCallBack
70122>>>>>>>            If hmCallBack Begin
70124>>>>>>>                Get phoInvokingObject to hoInvokingObject
70125>>>>>>>                If (pbMultiSelect(Self)) Begin
70127>>>>>>>                    Get SelectedDateRange to dDates
70128>>>>>>>                    Send hmCallBack of hoInvokingObject Self dDates[0] dDates[1]
70129>>>>>>>                    
70129>>>>>>>                End
70129>>>>>>>>
70129>>>>>>>                Else Begin
70130>>>>>>>                    Get SelectedDate to dDates[0]
70131>>>>>>>                    Send hmCallBack of hoInvokingObject Self dDates[0]
70132>>>>>>>                End
70132>>>>>>>>
70132>>>>>>>            End
70132>>>>>>>>
70132>>>>>>>        End
70132>>>>>>>>
70132>>>>>>>        
70132>>>>>>>        Send Close_Panel
70133>>>>>>>    End_Procedure
70134>>>>>>>    
70134>>>>>>>    Procedure OnMoveValueOutByValue
70136>>>>>>>        Handle hoInvokingObject
70136>>>>>>>        Date dSelDate
70136>>>>>>>        Boolean bMulti
70136>>>>>>>        // we can only do an automatic move value out with
70136>>>>>>>        // single select. If multi-select you will probably want to
70136>>>>>>>        // use a callback method (hmCallBack) to update the values.
70136>>>>>>>        Get pbMultiSelect to bMulti
70137>>>>>>>        If (not(bMulti)) Begin
70139>>>>>>>            Get SelectedDate to dSelDate
70140>>>>>>>            Get phoInvokingObject to hoInvokingObject
70141>>>>>>>            Set Value of hoInvokingObject to dSelDate
70142>>>>>>>            Set Item_Changed_State of hoInvokingObject to True
70143>>>>>>>        End
70143>>>>>>>>
70143>>>>>>>    End_Procedure
70144>>>>>>>    
70144>>>>>>>    Procedure OnMoveValueOutByCustom
70146>>>>>>>    End_Procedure
70147>>>>>>>    
70147>>>>>>>    // called before the list is activated.
70147>>>>>>>    Procedure InitializePrompt
70149>>>>>>>        Handle hoInvokingObject
70149>>>>>>>        Integer eUpdateMode
70149>>>>>>>        Boolean bMulti
70149>>>>>>>        Date dValue
70149>>>>>>>        
70149>>>>>>>        Get peUpdateMode to eUpdateMode
70150>>>>>>>        If (eUpdateMode<>umPromptNonInvoking) Begin
70152>>>>>>>            
70152>>>>>>>            Get Focus of Desktop to hoInvokingObject
70153>>>>>>>            If (hoInvokingObject<=Desktop) Begin
70155>>>>>>>                Error DFERR_PROGRAM "Calendar Prompt has no invoking object"
70156>>>>>>>>
70156>>>>>>>                Procedure_Return
70157>>>>>>>            End
70157>>>>>>>>
70157>>>>>>>            
70157>>>>>>>            Set phoInvokingObject to hoInvokingObject
70158>>>>>>>            Send Prompt_Callback to hoInvokingObject Self
70159>>>>>>>            Get peUpdateMode to eUpdateMode
70160>>>>>>>        End
70160>>>>>>>>
70160>>>>>>>        
70160>>>>>>>        Get pdSeedValue to dValue
70161>>>>>>>        Get pbMultiSelect to bMulti
70162>>>>>>>        If (not(bMulti) and eUpdateMode=umPromptValue and dValue=0) Begin
70164>>>>>>>            Get Value of hoInvokingObject to dValue
70165>>>>>>>            Set pdSeedValue to dValue
70166>>>>>>>        End
70166>>>>>>>>
70166>>>>>>>        Send OnSeedData
70167>>>>>>>        Set pdSeedValue to 0
70168>>>>>>>        Set pdSeedValue2 to 0
70169>>>>>>>    End_Procedure
70170>>>>>>>    
70170>>>>>>>    Procedure OnSeedData
70172>>>>>>>        Boolean bMulti
70172>>>>>>>        Date dValue dValue2
70172>>>>>>>        Integer iMax iRange
70172>>>>>>>        DateTime dt1 dt2
70172>>>>>>>        Get pbMultiSelect to bMulti
70173>>>>>>>        Get pdSeedValue to dValue
70174>>>>>>>        If (not(bMulti)) Begin
70176>>>>>>>            // if no date, use current date
70176>>>>>>>            If (dValue=0) Begin
70178>>>>>>>                Move (CurrentDateTime()) to dValue
70179>>>>>>>            End
70179>>>>>>>>
70179>>>>>>>            Send SetSelectedDate dValue
70180>>>>>>>        End
70180>>>>>>>>
70180>>>>>>>        Else Begin
70181>>>>>>>            Get pdSeedValue2 to dValue2
70182>>>>>>>            // if no dates, use current date
70182>>>>>>>            If (dValue=0 and dValue2=0) Begin
70184>>>>>>>                Move (CurrentDateTime()) to dValue
70185>>>>>>>            End
70185>>>>>>>>
70185>>>>>>>            // if only one date, make that the range
70185>>>>>>>            If (dValue=0) Begin
70187>>>>>>>                Move dValue2 to dValue
70188>>>>>>>            End
70188>>>>>>>>
70188>>>>>>>            Else If (dValue2=0) Begin
70191>>>>>>>                Move dValue to dValue2
70192>>>>>>>            End
70192>>>>>>>>
70192>>>>>>>            
70192>>>>>>>            // test for valid range
70192>>>>>>>            Get piMaxSelectedCount to iMax
70193>>>>>>>            Move dValue to dt1
70194>>>>>>>            Move dValue2 to dt2
70195>>>>>>>            Move (SpanTotalDays(dt1 - dt2)) to iRange
70196>>>>>>>            If (iRange>iMax) Begin
70198>>>>>>>                Error DFERR_OPERATOR (SFormat(C_$DateRangeExceeded,iMax))
70199>>>>>>>>
70199>>>>>>>                Move dValue to dValue2
70200>>>>>>>            End
70200>>>>>>>>
70200>>>>>>>            
70200>>>>>>>            Send SetSelectedDateRange dValue dValue2
70201>>>>>>>        End
70201>>>>>>>>
70201>>>>>>>    End_Procedure
70202>>>>>>>    
70202>>>>>>>    Procedure OnDoubleClick
70204>>>>>>>        Integer eSelectOn
70204>>>>>>>        Get peMouseSelectOk to eSelectOn
70205>>>>>>>        If (eSelectOn=msoDblClick) Begin
70207>>>>>>>            Send Ok
70208>>>>>>>        End
70208>>>>>>>>
70208>>>>>>>    End_Procedure
70209>>>>>>>    
70209>>>>>>>    Procedure OnClick
70211>>>>>>>        Integer eSelectOn
70211>>>>>>>        Get peMouseSelectOk to eSelectOn
70212>>>>>>>        If (eSelectOn=msoClick) Begin
70214>>>>>>>            Send Ok
70215>>>>>>>        End
70215>>>>>>>>
70215>>>>>>>    End_Procedure
70216>>>>>>>    
70216>>>>>>>    Procedure Ok Returns Integer
70218>>>>>>>        Send ClosePrompt
70219>>>>>>>    End_Procedure
70220>>>>>>>    
70220>>>>>>>    Procedure Cancel Returns Integer
70222>>>>>>>        Send Close_Panel
70223>>>>>>>    End_Procedure
70224>>>>>>>    
70224>>>>>>>End_Class
70225>>>>>Use Dfclient.pkg
70225>>>>>
70225>>>>>Cd_Popup_Object oMonthCalendarPrompt is a ModalPanel
70243>>>>>>
70243>>>>>    Set Location to 10 10
70244>>>>>    Set Size to 145 145
70245>>>>>    // resizable
70245>>>>>    Set Border_Style to Border_Thick
70246>>>>>    
70246>>>>>    Set Label to C_$DateSelector
70247>>>>>    
70247>>>>>    Set piMinSize to 0 0 // set this dynamically // 145 145
70248>>>>>    Set piMaxSize to 310 460
70249>>>>>    
70249>>>>>    // tells us if this been activated and sized yet
70249>>>>>    Property Boolean pbSizeInited False
70251>>>>>    
70251>>>>>    Object oCalendar is a cMonthCalendarPrompt
70253>>>>>        Set Size to 120 135 // not real size, will be assigned
70254>>>>>        Set Location to 5 5
70255>>>>>        Set Border_Style to Border_None
70256>>>>>    End_Object
70257>>>>>    
70257>>>>>    Object oOKButton is a Button
70259>>>>>        Set Label to C_$OK
70260>>>>>        Set Default_State to True
70261>>>>>        Set Location to 129 34
70262>>>>>        Set peAnchors to anBottomRight
70263>>>>>        
70263>>>>>        Procedure OnClick
70266>>>>>            Send Ok of oCalendar
70267>>>>>        End_Procedure
70268>>>>>    End_Object
70269>>>>>    
70269>>>>>    Object oCancelButton is a Button
70271>>>>>        Set Label to C_$Cancel
70272>>>>>        Set Location to 129 89
70273>>>>>        Set peAnchors to anBottomRight
70274>>>>>        
70274>>>>>        Procedure OnClick
70277>>>>>            Send Cancel of oCalendar
70278>>>>>        End_Procedure
70279>>>>>    End_Object
70280>>>>>    
70280>>>>>    Procedure OnResize
70283>>>>>        Integer iSize iHeight iWidth iMinSize
70283>>>>>        Boolean bInited
70283>>>>>        
70283>>>>>        Get piMinHeight of oCalendar to iHeight
70284>>>>>        // when 0, the control has not yet been created. Nothing to do.
70284>>>>>        If (iHeight=0) Begin
70286>>>>>            Procedure_Return
70287>>>>>        End
70287>>>>>>
70287>>>>>        
70287>>>>>        Get pbSizeInited to bInited
70288>>>>>        
70288>>>>>        Get piMinWidth of oCalendar to iWidth
70289>>>>>        Get piMinSize to iMinSize
70290>>>>>        // Minumum size of panel - add 1 to each to each for wiggle room
70290>>>>>        Move (iHeight+25+1) to iHeight
70291>>>>>        Move (iWidth+10+1) to iWidth
70292>>>>>        
70292>>>>>        Set piMinSize to iHeight iWidth
70293>>>>>        
70293>>>>>        If (not(bInited))  Begin
70295>>>>>            Set Size to iHeight iWidth
70296>>>>>            Set pbSizeInited to True
70297>>>>>        End
70297>>>>>>
70297>>>>>        Else Begin
70298>>>>>            Send Adjust_Logicals
70299>>>>>            Get Size to iSize
70300>>>>>            If (Hi(iSize)<iHeight or Low(iSize)<iWidth) Begin
70302>>>>>                Set Size to (iHeight max Hi(iSize)) (iWidth max Low(iSize))
70303>>>>>                Get Size to iSize
70304>>>>>            End
70304>>>>>>
70304>>>>>            Set Size of oCalendar to (Hi(iSize) - 25) (Low(iSize) - 10)
70305>>>>>        End
70305>>>>>>
70305>>>>>        
70305>>>>>    End_Procedure
70306>>>>>    
70306>>>>>    Procedure Add_Focus Handle hoParent Returns Integer
70309>>>>>        Forward Send Add_Focus hoParent
70311>>>>>        Send OnResize
70312>>>>>    End_Procedure
70313>>>>>    
70313>>>>>    On_Key kCancel Send KeyAction to oCancelButton
70314>>>>>    
70314>>>>>Cd_End_Object
70316>>>>>>
70316>>>>>
70316>>>Use dfcentry.pkg
70316>>>Use dfLine.pkg
70316>>>
70316>>>Deferred_View Activate_oPERSONAS for ;Object oPERSONAS is a dbView
70341>>>    Object oPERSONAS_DD is a cPERSONAS_DD
70343>>>        
70343>>>        Procedure Relate_main_file
70346>>>            String sNCompleto
70346>>>            
70346>>>            Forward Send Relate_main_file            
70348>>>            
70348>>>            Move '' to sNCompleto
70349>>>            If PERSONAS.Recnum Ne 0 Move  (fNombreCompleto(PERSONAS.CLAVE)) to sNCompleto  
70352>>>            Set Value of oDbNombre Item 0 to sNCompleto
70353>>>
70353>>>        End_Procedure  //  Relate_main_file
70354>>>              
70354>>>    End_Object
70355>>>
70355>>>    Procedure Request_Clear
70358>>>        Set Value of oDbNombre Item 0 to ''
70359>>>        Forward Send Request_Clear
70361>>>    End_Procedure
70362>>>    
70362>>>    Procedure Request_Clear_All
70365>>>        Set Value of oDbNombre Item 0 to ''
70366>>>        Forward Send Request_Clear_All
70368>>>    End_Procedure
70369>>>    
70369>>>    Procedure Creating
70372>>>        Set Value of oDbNombre Item 0 to ''
70373>>>        Forward Send Creating
70375>>>    End_Procedure
70376>>>
70376>>>
70376>>>    Set Main_DD to oPERSONAS_DD
70377>>>    Set Server to oPERSONAS_DD
70378>>>    Set Size to 101 342
70379>>>    Set Location to 13 5
70380>>>    Set Label to "PERSONAS"
70381>>>
70381>>>    Object oDbContainer3d1 is a dbContainer3d
70383>>>        Set Size to 80 340
70384>>>        Set Location to 3 2
70385>>>
70385>>>        Object oPERSONAS_CLAVE is a dbForm
70387>>>            Entry_Item PERSONAS.CLAVE
70388>>>            Set Location to 6 59
70389>>>            Set Size to 12 80
70390>>>            Set Label to "Clave:"
70391>>>            Set Label_Col_Offset to 2
70392>>>            Set Label_Justification_Mode to JMode_Right
70393>>>            Set peAnchors to anNone
70394>>>        End_Object
70395>>>
70395>>>        Object oPERSONAS_PRIMER_NOMBRE is a dbForm
70397>>>            Entry_Item PERSONAS.PRIMER_NOMBRE
70398>>>            Set Location to 20 59
70399>>>            Set Size to 12 80
70400>>>            Set Label to "Primer Nombre:"
70401>>>            Set Label_Col_Offset to 2
70402>>>            Set Label_Justification_Mode to JMode_Right
70403>>>            Set peAnchors to anNone
70404>>>        End_Object
70405>>>
70405>>>        Object oPERSONAS_SEGUNDO_NOMBRE is a dbForm
70407>>>            Entry_Item PERSONAS.SEGUNDO_NOMBRE
70408>>>            Set Location to 21 252
70409>>>            Set Size to 12 80
70410>>>            Set Label to "Segundo Nombre:"
70411>>>            Set Label_Col_Offset to 2
70412>>>            Set Label_Justification_Mode to JMode_Right
70413>>>            Set peAnchors to anNone
70414>>>        End_Object
70415>>>
70415>>>        Object oPERSONAS_PRIMER_APELLIDO is a dbForm
70417>>>            Entry_Item PERSONAS.PRIMER_APELLIDO
70418>>>            Set Location to 34 59
70419>>>            Set Size to 12 80
70420>>>            Set Label to "Primer Apellido:"
70421>>>            Set Label_Col_Offset to 2
70422>>>            Set Label_Justification_Mode to JMode_Right
70423>>>            Set peAnchors to anNone
70424>>>        End_Object
70425>>>
70425>>>        Object oPERSONAS_SEGUNDO_APELLIDO is a dbForm
70427>>>            Entry_Item PERSONAS.SEGUNDO_APELLIDO
70428>>>            Set Location to 35 252
70429>>>            Set Size to 12 80
70430>>>            Set Label to "Segundo Apellido:"
70431>>>            Set Label_Col_Offset to 2
70432>>>            Set Label_Justification_Mode to JMode_Right
70433>>>            Set peAnchors to anNone
70434>>>        End_Object
70435>>>
70435>>>        Object oPERSONAS_APELLIDO_CASADA is a dbForm
70437>>>            Entry_Item PERSONAS.APELLIDO_CASADA
70438>>>            Set Location to 48 59
70439>>>            Set Size to 12 80
70440>>>            Set Label to "Apellido Casada:"
70441>>>            Set Label_Col_Offset to 2
70442>>>            Set Label_Justification_Mode to JMode_Right
70443>>>            Set peAnchors to anNone
70444>>>        End_Object
70445>>>        
70445>>>        Object oDbNombre is a dbForm
70447>>>            Set Size to 12 182
70448>>>            Set Location to 6 150
70449>>>            Set Enabled_State to False
70450>>>            Set peAnchors to anNone
70451>>>            Set Label_FontWeight to fw_Bold
70452>>>            Set Label_Color to clDefault
70453>>>            Set Form_Justification_Mode to Form_DisplayCenter
70454>>>            
70454>>>            //Mostrar Nombre Completo
70454>>>            
70454>>>            String sClave sNCompleto
70454>>>            
70454>>>            Move PERSONAS.CLAVE to sClave
70455>>>            
70455>>>            Move (fNombreCompleto(sClave)) to sNCompleto
70456>>>            Set Value of oDbNombre Item 0 to sNCompleto
70457>>>            
70457>>>        End_Object
70458>>>
70458>>>        Object oPERSONAS_FECHA_NACIMIENTO is a dbForm
70460>>>            Entry_Item PERSONAS.FECHA_NACIMIENTO
70461>>>            Set Location to 49 252
70462>>>            Set Size to 12 66
70463>>>            Set Label to "Fecha de Nacimiento:"
70464>>>            Set Label_Col_Offset to 2
70465>>>            Set Label_Justification_Mode to JMode_Right
70466>>>            //Mostrar un calendario grfico
70466>>>            Set Prompt_Object to oMonthCalendarPrompt
70467>>>        End_Object
70468>>>
70468>>>        Object oPERSONAS_SEXO is a dbComboForm
70470>>>            Entry_Item PERSONAS.SEXO
70471>>>            Set Location to 62 59
70472>>>            Set Size to 12 57
70473>>>            Set Label to "Sexo:"
70474>>>            Set Label_Col_Offset to 2
70475>>>            Set Label_Justification_Mode to JMode_Right
70476>>>        End_Object
70477>>>
70477>>>        Object oLineControl1 is a LineControl
70479>>>            Set Size to 53 8
70480>>>            Set Location to 21 158
70481>>>            Set Horizontal_State to False
70482>>>        End_Object
70483>>>    End_Object
70484>>>
70484>>>    Object oBoton_Grabar is a Button
70486>>>        Set Location to 85 233
70487>>>        Set Label to "Grabar"
70488>>>        Set psImage to "ActionSave.ico"
70489>>>    
70489>>>        // fires when the button is clicked
70489>>>        Procedure OnClick
70492>>>            //String sClave
70492>>>            
70492>>>            Clear PERSONAS
70493>>>            Move oPERSONAS_CLAVE to sClave
70494>>>            
70494>>>            Find ge PERSONAS by Index.1
70495>>>>
70495>>>            If (Found) Begin
70497>>>                Reread PERSONAS
70501>>>                Move sClave to PERSONAS.CLAVE
70502>>>                SaveRecord PERSONAS
70503>>>                Unlock
70504>>>>
70504>>>            End         
70504>>>>
70504>>>        End_Procedure
70505>>>    
70505>>>    End_Object
70506>>>    Object oBoton_Borrar is a Button
70508>>>        Set Location to 85 288
70509>>>        Set Label to "Borrar"
70510>>>        Set psImage to "ActionDelete.ico"
70511>>>        
70511>>>        // fires when the button is clicked
70511>>>        Procedure OnClick
70514>>>            
70514>>>            
70514>>>        End_Procedure
70515>>>    
70515>>>    End_Object
70516>>>
70516>>>Cd_End_Object
70518>>>>
70518>
70518>        Procedure Activate_About
70521>            Send DoAbout "" "" "" "" ""
70522>        End_Procedure
70523>
70523>    End_Object
70524>
70524>End_Object
70525>
70525>Start_UI
70526>
Summary
Memory Available: 2147483646
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 41206
Total Resources: 0
Total Commands : 70525
Total Windows  : 0
Total Pages    : 0
Static Data    : 401218
Message area   : 501882
Total Blocks   : 25472
